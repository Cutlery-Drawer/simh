
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>1. HP 3000 simulator user’s guide &#8212; Python  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="hp-3000-simulator-user-s-guide">
<h1><span class="sectnum">1. </span>HP 3000 simulator user’s guide<a class="headerlink" href="#hp-3000-simulator-user-s-guide" title="Permalink to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2018-01-06</p>
</dd>
<dt class="field-even">Revision<span class="colon">:</span></dt>
<dd class="field-even"><p>$Format:%H$</p>
</dd>
<dt class="field-odd">Copyright<span class="colon">:</span></dt>
<dd class="field-odd"><p>See <a class="reference external" href="../LICENSE.txt">LICENSE.txt</a> for terms of use.</p>
</dd>
</dl>
<aside class="topic">
<p class="topic-title"><strong>Copyright notice</strong></p>
<p>The following copyright notice applies to the SIMH source, binary, and documentation:</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the “Software”),
to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
<p>Except as contained in this notice, the names of The Authors shall not be
used in advertising or otherwise to promote the sale, use or other dealings
in this Software without prior written authorization from the Authors.</p>
</aside>
<nav class="contents local" id="contents">
<ul class="auto-toc simple">
<li><p><a class="reference internal" href="#introduction" id="id12"><span class="sectnum">1.1. </span>Introduction</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#the-hp-3000-computer-system" id="id13"><span class="sectnum">1.1.1. </span>The HP 3000 computer system</a></p></li>
<li><p><a class="reference internal" href="#simulator-files" id="id14"><span class="sectnum">1.1.2. </span>Simulator files</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#simulator-features" id="id15"><span class="sectnum">1.2. </span>Simulator features</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#hardware-equivalent-actions" id="id16"><span class="sectnum">1.2.1. </span>Hardware-equivalent actions</a></p></li>
<li><p><a class="reference internal" href="#simulator-specific-commands" id="id17"><span class="sectnum">1.2.2. </span>Simulator-specific commands</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#numeric-display-and-entry" id="id18"><span class="sectnum">1.2.2.1. </span>Numeric display and entry</a></p></li>
<li><p><a class="reference internal" href="#symbolic-display-and-entry" id="id19"><span class="sectnum">1.2.2.2. </span>Symbolic display and entry</a></p></li>
<li><p><a class="reference internal" href="#memory-addressing" id="id20"><span class="sectnum">1.2.2.3. </span>Memory addressing</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#examine-deposit-iexamine-and-ideposit" id="id21"><span class="sectnum">1.2.2.3.1. </span><span class="html"><samp><b>EXAMINE</b></samp></span>, <span class="html"><samp><b>DEPOSIT</b></samp></span>, <span class="html"><samp><b>IEXAMINE</b></samp></span>, and <span class="html"><samp><b>IDEPOSIT</b></samp></span></a></p></li>
<li><p><a class="reference internal" href="#break-and-nobreak" id="id22"><span class="sectnum">1.2.2.3.2. </span><span class="html"><samp><b>BREAK</b></samp></span> and <span class="html"><samp><b>NOBREAK</b></samp></span></a></p></li>
<li><p><a class="reference internal" href="#run-and-go" id="id23"><span class="sectnum">1.2.2.3.3. </span><span class="html"><samp><b>RUN</b></samp></span> and <span class="html"><samp><b>GO</b></samp></span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#load-dump-and-boot" id="id24"><span class="sectnum">1.2.2.4. </span><span class="html"><samp><b>LOAD</b></samp></span>, <span class="html"><samp><b>DUMP</b></samp></span>, and <span class="html"><samp><b>BOOT</b></samp></span></a></p></li>
<li><p><a class="reference internal" href="#power-fail-and-power-restore" id="id25"><span class="sectnum">1.2.2.5. </span><span class="html"><samp><b>POWER FAIL</b></samp></span> and <span class="html"><samp><b>POWER RESTORE</b></samp></span></a></p></li>
<li><p><a class="reference internal" href="#device-configuration" id="id26"><span class="sectnum">1.2.2.6. </span>Device configuration</a></p></li>
<li><p><a class="reference internal" href="#enabling-and-disabling-devices" id="id27"><span class="sectnum">1.2.2.7. </span>Enabling and disabling devices</a></p></li>
<li><p><a class="reference internal" href="#i-o-interface-assignments" id="id28"><span class="sectnum">1.2.2.8. </span>I/O interface assignments</a></p></li>
<li><p><a class="reference internal" href="#save-and-restore" id="id29"><span class="sectnum">1.2.2.9. </span><span class="html"><samp><b>SAVE</b></samp></span> and <span class="html"><samp><b>RESTORE</b></samp></span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#realistic-calibrated-and-optimized-timing" id="id30"><span class="sectnum">1.2.3. </span>Realistic, calibrated, and optimized timing</a></p></li>
<li><p><a class="reference internal" href="#the-simulation-console-and-the-system-console" id="id31"><span class="sectnum">1.2.4. </span>The simulation console and the system console</a></p></li>
<li><p><a class="reference internal" href="#tracing-simulator-operations" id="id32"><span class="sectnum">1.2.5. </span>Tracing simulator operations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#processor-device-simulations" id="id33"><span class="sectnum">1.3. </span>Processor device simulations</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#central-processing-unit" id="id34"><span class="sectnum">1.3.1. </span>Central Processing Unit</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#system-halt" id="id35"><span class="sectnum">1.3.1.1. </span>System halt</a></p></li>
<li><p><a class="reference internal" href="#idling" id="id36"><span class="sectnum">1.3.1.2. </span>Idling</a></p></li>
<li><p><a class="reference internal" href="#simulation-stops" id="id37"><span class="sectnum">1.3.1.3. </span>Simulation stops</a></p></li>
<li><p><a class="reference internal" href="#tracing" id="id38"><span class="sectnum">1.3.1.4. </span>Tracing</a></p></li>
<li><p><a class="reference internal" href="#registers" id="id39"><span class="sectnum">1.3.1.5. </span>Registers</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#i-o-processor" id="id40"><span class="sectnum">1.3.2. </span>I/O processor</a></p></li>
<li><p><a class="reference internal" href="#selector-channel" id="id41"><span class="sectnum">1.3.3. </span>Selector channel</a></p></li>
<li><p><a class="reference internal" href="#multiplexer-channel" id="id42"><span class="sectnum">1.3.4. </span>Multiplexer channel</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#programmed-i-o-device-simulations" id="id43"><span class="sectnum">1.4. </span>Programmed I/O device simulations</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#b-asynchronous-terminal-controller" id="id44"><span class="sectnum">1.4.1. </span>30032B asynchronous terminal controller</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#terminal-data-interface" id="id45"><span class="sectnum">1.4.1.1. </span>Terminal data interface</a></p></li>
<li><p><a class="reference internal" href="#terminal-control-interface" id="id46"><span class="sectnum">1.4.1.2. </span>Terminal control interface</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#a-selector-channel-maintenance-board" id="id47"><span class="sectnum">1.4.2. </span>30033A selector channel maintenance board</a></p></li>
<li><p><a class="reference internal" href="#a-system-clock" id="id48"><span class="sectnum">1.4.3. </span>30135A system clock</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#selector-channel-i-o-device-simulations" id="id49"><span class="sectnum">1.5. </span>Selector channel I/O device simulations</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#b-disc-interface-with-eight-7905-7906-7920-7925-drives" id="id50"><span class="sectnum">1.5.1. </span>30229B disc interface with eight 7905/7906/7920/7925 drives</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#device-options" id="id51"><span class="sectnum">1.5.1.1. </span>Device options</a></p></li>
<li><p><a class="reference internal" href="#unit-options" id="id52"><span class="sectnum">1.5.1.2. </span>Unit options</a></p></li>
<li><p><a class="reference internal" href="#diagnostic-support" id="id53"><span class="sectnum">1.5.1.3. </span>Diagnostic support</a></p></li>
<li><p><a class="reference internal" href="#boot-command" id="id54"><span class="sectnum">1.5.1.4. </span><span class="html"><samp><b>BOOT</b></samp></span> command</a></p></li>
<li><p><a class="reference internal" href="#tracing-and-registers" id="id55"><span class="sectnum">1.5.1.5. </span>Tracing and registers</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#multiplexer-channel-i-o-device-simulations" id="id56"><span class="sectnum">1.6. </span>Multiplexer channel I/O device simulations</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#a-line-printer-controller-with-one-2607-13-17-18-line-printer" id="id57"><span class="sectnum">1.6.1. </span>30209A line printer controller with one 2607/13/17/18 line printer</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#id1" id="id58"><span class="sectnum">1.6.1.1. </span>Device options</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id59"><span class="sectnum">1.6.1.2. </span>Unit options</a></p></li>
<li><p><a class="reference internal" href="#vertical-format-unit" id="id60"><span class="sectnum">1.6.1.3. </span>Vertical format unit</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id61"><span class="sectnum">1.6.1.4. </span>Tracing and registers</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#a-tape-controller-with-four-7970b-e-drives" id="id62"><span class="sectnum">1.6.2. </span>30215A tape controller with four 7970B/E drives</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#id8" id="id63"><span class="sectnum">1.6.2.1. </span>Device options</a></p></li>
<li><p><a class="reference internal" href="#id9" id="id64"><span class="sectnum">1.6.2.2. </span>Unit options</a></p></li>
<li><p><a class="reference internal" href="#id10" id="id65"><span class="sectnum">1.6.2.3. </span><span class="html"><samp><b>BOOT</b></samp></span> command</a></p></li>
<li><p><a class="reference internal" href="#id11" id="id66"><span class="sectnum">1.6.2.4. </span>Tracing and registers</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><span class="sectnum">1.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>This manual documents the features and operation of the HP 3000 simulator.
It is intended for use in conjunction with the <a class="reference external" href="simh_doc.rst">SIMH Users’ Guide</a> manual,
which describes how to compile and run the simulator,
as well as the general commands that may be entered at the Simulation Control Program (SCP) prompt.</p>
<section id="the-hp-3000-computer-system">
<h3><span class="sectnum">1.1.1. </span>The HP 3000 computer system<a class="headerlink" href="#the-hp-3000-computer-system" title="Permalink to this heading">¶</a></h3>
<p>Hewlett-Packard sold the HP 3000 family of general-purpose business computers from 1972 through 2001.
There are two major divisions within this family:
the <em>classic</em> 16-bit,
stack-oriented CISC machines,
and the <em>Precision Architecture</em> 32-bit,
register-oriented RISC machines that succeeded them.
All machines run versions of MPE,
the <em>Multiprogramming Executive</em> operating system.</p>
<p>Within the classic division,
there are two additional subdivisions,
based on the method used for peripheral connections:
the original SIO machines,
and the later <em>HP-IB</em> machines.
The I/O interfacing hardware differs between the two types of machines,
as do the privileged I/O machine instructions.
The user instruction sets are identical,
as are the register sets visible to the programmer.
The I/O drivers are different to account for the hardware differences,
and therefore they run slightly different versions of MPE.</p>
<p>This implementation is a simulator for the classic SIO machines.
This group consists of the 3000 CX,
the Series I,
Series II,
and the HP 3000 Series III that is simulated here.
The CX and the Series I,
which is a repackaged CX,
are essentially subsets of the Series II/III —
a smaller instruction set,
limited memory size,
and lower-precision floating-point instructions.
Simulation of these machines may be added in the future.
Future simulation of the HP-IB machines
(the Series 30 through 70)
is desirable,
as the latest MPE versions run only on these machines,
but documentation on the internals of the HP-IB hardware controllers is nonexistent.</p>
<p>The CX and Series I support 64K 16-bit words of memory.
The Series II supports up to 256K,
divided into four banks of 64K words each,
and the Series III extends this to 1024K words using 16 banks.
Memory is divided into variable-length code and data segments,
with the latter containing a program’s global data area and stack.</p>
<p>Memory protection is accomplished by checking program,
data,
and stack accesses against segment base and limit registers,
which can be set only by MPE.
Bounds violations cause automatic hardware traps to handler routines within MPE.
Some violations may be permitted;
for example,
a stack overflow trap may cause MPE to allocate a larger stack and then restart the interrupted instruction.
Memory references are position-independent,
so moving segments to accommodate expansion requires only resetting of the segment registers to point at the new locations.
Code segments are fully reentrant and shareable,
and both code and data are virtual,
as the hardware supports absent code and data segment traps.</p>
<p>The classic 3000s are stack machines.
Most of the instructions operate on the value on the top of the stack (TOS) or on the TOS and the next-to-the-top of the stack (NOS).
To improve execution speed,
the 3000 has a set of hardware registers that are accessed as the first four locations at the top of the stack,
while the remainder of the stack locations reside in main memory.
A hardware register renamer provides fast stack pushes and pops without physically copying values between registers.</p>
</section>
<section id="simulator-files">
<h3><span class="sectnum">1.1.2. </span>Simulator files<a class="headerlink" href="#simulator-files" title="Permalink to this heading">¶</a></h3>
<p>The simulator sources are divided into a set of files for the Simulator Control Program and its support libraries,
and a set of files for the HP 3000 device simulations;
the latter reside in a subdirectory of the directory that contains the SCP files.
The former set is common to all SIMH simulators,
whereas the latter set is specific to the virtual machine being simulated.
The files that make up this simulator are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Subdirectory</p></th>
<th class="head"><p>File</p></th>
<th class="head"><p>Contains</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="26"><p><code class="docutils literal notranslate"><span class="pre">HP3000/</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hp3000_cpu.h</span></code></p></td>
<td><p>CPU architectural declarations</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_cpu_fp.h</span></code></p></td>
<td><p>Floating-point interface declarations</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_cpu_ims.h</span></code></p></td>
<td><p>CPU-to-IOP/channel interface declarations</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_defs.h</span></code></p></td>
<td><p>System architectural declarations</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_io.h</span></code></p></td>
<td><p>Device-to-IOP/channel interface declarations</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp_disclib.h</span></code></p></td>
<td><p>MAC/ICD disc controller simulator library declarations</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp_tapelib.h</span></code></p></td>
<td><p>797x tape controller simulator library declarations</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_atc.c</span></code></p></td>
<td><p>Asynchronous terminal controller simulator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_clk.c</span></code></p></td>
<td><p>System clock simulator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_cpu.c</span></code></p></td>
<td><p>CPU simulator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_cpu_base.c</span></code></p></td>
<td><p>CPU base instruction set simulator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_cpu_cis.c</span></code></p></td>
<td><p>CPU COBOL II extended instruction set simulator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_cpu_fp.c</span></code></p></td>
<td><p>CPU floating point instruction set simulator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_ds.c</span></code></p></td>
<td><p>Cartridge disc interface simulator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_iop.c</span></code></p></td>
<td><p>I/O processor simulator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_lp.c</span></code></p></td>
<td><p>Line printer interface simulator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_mem.c</span></code></p></td>
<td><p>Main memory subsystem simulator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_mpx.c</span></code></p></td>
<td><p>Multiplexer channel simulator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_ms.c</span></code></p></td>
<td><p>Magnetic tape controller interface simulator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_scmb.c</span></code></p></td>
<td><p>Selector channel maintenance board simulator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_sel.c</span></code></p></td>
<td><p>Selector channel simulator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_sys.c</span></code></p></td>
<td><p>SCP interface</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp_disclib.c</span></code></p></td>
<td><p>MAC/ICD disc controller simulator library</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp_tapelib.c</span></code></p></td>
<td><p>797x tape controller simulator library</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_diag.txt</span></code></p></td>
<td><p>SIMH/HP 3000 diagnostics performance report</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hp3000_release.txt</span></code></p></td>
<td><p>HP 3000 simulator release notes</p></td>
</tr>
</tbody>
</table>
<p>PDF files of the original HP 3000 hardware and software manuals are available from these repositories:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.bitsavers.org/">BitSavers</a></p></li>
<li><p><a class="reference external" href="http://www.hpmuseum.net/">The HP computer museum</a></p></li>
</ul>
<p>A software kit containing an HP 7920 disc image with MPE V/R preinstalled is available from
<a class="reference external" href="http://www.bitsavers.org/bits/HP/HP_3000/">BitSavers</a>.</p>
</section>
</section>
<section id="simulator-features">
<h2><span class="sectnum">1.2. </span>Simulator features<a class="headerlink" href="#simulator-features" title="Permalink to this heading">¶</a></h2>
<p>The HP 3000 simulator contains the following device simulations:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Device name</p></th>
<th class="head"><p>Simulates</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CPU</b></samp></span></p></td>
<td><p>30003B Series III computer with up to 1024 KW of memory</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>IOP</b></samp></span></p></td>
<td><p>30003B I/O processor</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SEL</b></samp></span></p></td>
<td><p>30030C selector channel</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ATCD</b></samp></span></p></td>
<td><p>30032B asynchronous terminal controller data interface</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ATCC</b></samp></span></p></td>
<td><p>30032B asynchronous terminal controller control interface</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SCMB1</b></samp></span>, <span class="html"><samp><b>SCMB2</b></samp></span></p></td>
<td><p>30033A selector channel maintenance boards</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>MPX</b></samp></span></p></td>
<td><p>30036B multiplexer channel</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>CLK</b></samp></span></p></td>
<td><p>30135A system clock</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>LP</b></samp></span></p></td>
<td><p>30209A line printer controller with one 2607/13/17/18 line printer</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>MS</b></samp></span></p></td>
<td><p>30215A magnetic tape controller with four 7970B/E drives</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DS</b></samp></span></p></td>
<td><p>30229B disc interface with eight 7905/7906/7920/7925 drives</p></td>
</tr>
</tbody>
</table>
<p>One instance of each listed device may be installed in the simulated computer chassis.
Some devices support multiple connected units.
As an example,
the <span class="html"><samp><b>DS</b></samp></span> device simulates a single 30229B disc interface that connects up to eight drives.
However, a second 30229B connecting an additional eight drives is not supported.</p>
<p>The simulator has been tested with and supports the following operating systems:</p>
<ul class="simple">
<li><p>MPE V/R version E.01.00</p></li>
</ul>
<p>In addition,
the simulator generally passes the HP 32230 Stand-Alone Diagnostics suite;
see <code class="docutils literal notranslate"><span class="pre">hp3000_diag.txt</span></code> for details.</p>
<p>The simulator may be configured to stop for any of these conditions:</p>
<ul class="simple">
<li><p>Attempted execution of an instruction that enters an infinite loop (e.g., BR P+0).</p></li>
<li><p>Attempted execution of a <span class="html"><samp>PAUS</samp></span> instruction.</p></li>
<li><p>Attempted execution of an undefined instruction.</p></li>
<li><p>Attempted execution of an unimplemented instruction.</p></li>
</ul>
<p>MPE normally handles these conditions internally.
However, when running diagnostics,
it may be helpful to set one or more of these stop conditions.
In particular,
some diagnostics execute a <span class="html"><samp>PAUS</samp></span> instruction to wait for operator action,
rather than external interrupts,
or branch in an infinite loop to indicate an error condition.
Unless the corresponding simulator stops are active,
no indications of these conditions will be observed.</p>
<p>The simulator also provides extensive facilities for tracing CPU and I/O device operations.</p>
<section id="hardware-equivalent-actions">
<h3><span class="sectnum">1.2.1. </span>Hardware-equivalent actions<a class="headerlink" href="#hardware-equivalent-actions" title="Permalink to this heading">¶</a></h3>
<p>The current implementation does not provide simulations of the CPU or peripheral device front panels.
Instead, commands entered through the simulation console are used to perform hardware actions.
The simulation commands that substitute for CPU front-panel actions are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Hardware front-panel action</p></th>
<th class="head"><p>Equivalent simulation command</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pressing the <span class="html"><samp class="guilabel">RUN</samp></span>/<span class="html"><samp class="guilabel">HALT</samp></span> button while halted</p></td>
<td><p><span class="html"><samp><b>RUN</b></samp></span></p></td>
</tr>
<tr class="row-odd"><td><p>Pressing the <span class="html"><samp class="guilabel">RUN</samp></span>/<span class="html"><samp class="guilabel">HALT</samp></span> button while running</p></td>
<td><p><span class="html"><samp><kbd>CTRL+E</kbd></samp></span></p></td>
</tr>
<tr class="row-even"><td><p>Pressing the <span class="html"><samp class="guilabel">LOAD</samp></span> and <span class="html"><samp class="guilabel">ENABLE</samp></span> buttons</p></td>
<td><p><span class="html"><samp><b>LOAD</b></samp></span></p></td>
</tr>
<tr class="row-odd"><td><p>Pressing the <span class="html"><samp class="guilabel">DUMP</samp></span> and <span class="html"><samp class="guilabel">ENABLE</samp></span> buttons</p></td>
<td><p><span class="html"><samp><b>DUMP</b></samp></span></p></td>
</tr>
<tr class="row-even"><td><p>Toggling the <span class="html"><samp class="guilabel">CPU RESET</samp></span> switch</p></td>
<td><p><span class="html"><samp><b>RESET</b></samp></span></p></td>
</tr>
<tr class="row-odd"><td><p>Setting the <span class="html"><samp class="guilabel">PF/ARS</samp></span> switch to <code class="docutils literal notranslate"><span class="pre">ENABLE</span></code></p></td>
<td><p><span class="html"><samp><b>SET CPU ARS</b></samp></span></p></td>
</tr>
<tr class="row-even"><td><p>Setting the <span class="html"><samp class="guilabel">PF/ARS</samp></span> switch to <code class="docutils literal notranslate"><span class="pre">DISABLE</span></code></p></td>
<td><p><span class="html"><samp><b>SET CPU NOARS</b></samp></span></p></td>
</tr>
<tr class="row-odd"><td><p>Displaying the Current Instruction Register</p></td>
<td><p><span class="html"><samp><b>EXAMINE CIR</b></samp></span></p></td>
</tr>
<tr class="row-even"><td><p>Displaying the System Switch Register</p></td>
<td><p><span class="html"><samp><b>EXAMINE SWCH</b></samp></span></p></td>
</tr>
<tr class="row-odd"><td><p>Setting the System Switch Register</p></td>
<td><p><span class="html"><samp><b>DEPOSIT SWCH</b> <var>value</var></samp></span></p></td>
</tr>
</tbody>
</table>
<p>Mounting media on a peripheral device is simulated by the <span class="html"><samp><b>ATTACH</b></samp></span> command.
For example,
entering the <span class="html"><samp>ATTACH LP <var>printer-image-filename</var></samp></span> command is equivalent to loading paper into an HP 2617A Line Printer.
Inserting a disc pack into an HP 7905A disc drive set for unit 2 is simulated by the <span class="html"><samp><b>ATTACH DS2</b> <var>disc-image-filename</var></samp></span> command.</p>
<p>Each of these commands is explained in more detail below.</p>
<p>In hardware,
loading programs into memory from a device is accomplished by setting the System Switch Register to the desired control and device number and pressing the <span class="html"><samp class="guilabel">LOAD</samp></span> and <span class="html"><samp class="guilabel">ENABLE</samp></span> buttons together to initiate the cold load sequence.
In simulation, a cold load may be performed either explicitly or implicitly.
Explicit operation is described in the <a class="reference internal" href="#load-dump-and-boot"><span class="html"><samp><b>LOAD</b></samp></span>, <span class="html"><samp><b>DUMP</b></samp></span>, and <span class="html"><samp><b>BOOT</b></samp></span></a> section below.
As a convenience,
<span class="html"><samp><b>BOOT</b> <var>device</var></samp></span> commands may be used to implicitly cold load their respective devices and are described in the individual device descriptions below.</p>
</section>
<section id="simulator-specific-commands">
<h3><span class="sectnum">1.2.2. </span>Simulator-specific commands<a class="headerlink" href="#simulator-specific-commands" title="Permalink to this heading">¶</a></h3>
<p>In general,
all of the commands documented in the <a class="reference external" href="simh_doc.rst">SIMH Users’ Guide</a> manual are available for use with the HP 3000 simulator.
Commands whose execution or parameters are implementation-defined are specified below.</p>
<section id="numeric-display-and-entry">
<h4><span class="sectnum">1.2.2.1. </span>Numeric display and entry<a class="headerlink" href="#numeric-display-and-entry" title="Permalink to this heading">¶</a></h4>
<p>When examining or depositing into memory,
the radix for addresses is octal,
and the default radix for numeric data is octal.
The data default may be changed with the <span class="html"><samp><b>SET CPU</b> { <b>BIN</b> | <b>OCT</b> | <b>DEC</b> | <b>HEX</b> }</samp></span> command,
or the radix may be overridden temporarily with a command-line switch,
as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Switch</p></th>
<th class="head"><p>Interpretation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-2</span></code></p></td>
<td><p>A binary value</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-8</span></code> or <code class="docutils literal notranslate"><span class="pre">-O</span></code></p></td>
<td><p>An octal value</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-10</span></code> or <code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
<td><p>A decimal value</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-16</span></code> or <code class="docutils literal notranslate"><span class="pre">-H</span></code></p></td>
<td><p>A hexadecimal value</p></td>
</tr>
</tbody>
</table>
<p>When examining or depositing into device registers,
the default radix for the specified register is used unless overridden with one of the above command-line switches.
Defaults are listed in the register table associated with each device.</p>
</section>
<section id="symbolic-display-and-entry">
<h4><span class="sectnum">1.2.2.2. </span>Symbolic display and entry<a class="headerlink" href="#symbolic-display-and-entry" title="Permalink to this heading">¶</a></h4>
<p>When examining or depositing into memory or certain registers,
command-line switches specifying the symbolic mode and format may be used to override the default numeric mode,
as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Switch</p></th>
<th class="head"><p>Mode interpretation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-A</span></code></p></td>
<td><p>A single character in the right-hand byte</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-C</span></code></p></td>
<td><p>A two-character packed string</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-E</span></code></p></td>
<td><p>An <span class="html"><samp>EDIT</samp></span> subprogram operation mnemonic</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-ER</span></code></p></td>
<td><p>An <span class="html"><samp>EDIT</samp></span> subprogram operation mnemonic starting with the right-hand byte</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-I</span></code></p></td>
<td><p>An I/O program instruction mnemonic</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-M</span></code></p></td>
<td><p>A CPU instruction mnemonic</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-T</span></code></p></td>
<td><p>A CPU status mnemonic</p></td>
</tr>
</tbody>
</table>
<p>In the absence of a mode switch or a specified symbolic default,
entering values with a leading <code class="docutils literal notranslate"><span class="pre">'</span></code> (apostrophe) implies <code class="docutils literal notranslate"><span class="pre">-A</span></code>,
and a leading <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> (quotation mark) implies <code class="docutils literal notranslate"><span class="pre">-C</span></code>.
The specific registers supporting symbolic mode are indicated in their respective device sections below.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">-C</span></code> switch is specified,
the value is displayed as two characters separated by a comma.
Alphanumeric,
punctuation,
and symbol characters are displayed within apostrophes,
control characters are displayed as ASCII name abbreviations,
and characters above 128 decimal are displayed in escaped numeric form with a leading backslash followed by an octal number.
Depositing with <code class="docutils literal notranslate"><span class="pre">-C</span></code> accepts two displayable characters.
If a single character is supplied,
the low byte of the resulting value will be zero;
follow the character with a space to pad the low byte with a blank.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">-M</span></code> switch is specified,
the value is displayed as a CPU machine instruction mnemonic if it is defined.
If it is not,
it is displayed as a numeric value in the CPU’s data radix.
Any numeric operands present are displayed in a default radix unless overridden by the addition of one of these mutually exclusive format switches:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Switch</p></th>
<th class="head"><p>Format interpretation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-A</span></code></p></td>
<td><p>A single character in the right-hand byte</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-B</span></code></p></td>
<td><p>A binary value</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-O</span></code></p></td>
<td><p>An octal value</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
<td><p>A decimal value</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-H</span></code></p></td>
<td><p>A hexadecimal value</p></td>
</tr>
</tbody>
</table>
<p>Numeric operands are displayed in a radix suitable to the type of the value.
For CPU instruction operands:</p>
<ul class="simple">
<li><p>Register-relative displacements,
S-register decrements,
and K fields are displayed in the CPU’s address radix,
which is octal.</p></li>
<li><p>Shift counts,
bit positions,
and starting bits and counts are displayed in decimal unless overridden by a switch on the command-line.</p></li>
<li><p>CIR values for the <span class="html"><samp>PAUS</samp></span> and <span class="html"><samp>HALT</samp></span> instructions are displayed in octal,
unless overridden by a switch on the command-line.</p></li>
<li><p>Immediate values are displayed in the CPU’s data radix,
which defaults to octal but may be set to a different radix or overridden by a switch on the command-line.</p></li>
</ul>
<p>For I/O program instruction operands:</p>
<ul class="simple">
<li><p>Address values are displayed in the CPU’s address radix,
which is octal.</p></li>
<li><p>Counts are displayed in decimal unless overridden by a switch on the command-line.</p></li>
<li><p>Control and status values are displayed in the CPU’s data radix,
which defaults to octal but may be set to a different radix or overridden by a switch on the command-line.</p></li>
</ul>
<p>For CPU status values:</p>
<ul class="simple">
<li><p>The current code segment number is displayed in the CPU’s data radix,
which defaults to octal but may be set to a different radix or overridden by a switch on the command-line.</p></li>
</ul>
<p>For <span class="html"><samp>EDIT</samp></span> subprogram operands:</p>
<ul class="simple">
<li><p>Branch displacement fields are displayed in the CPU’s address radix,
which is octal.</p></li>
<li><p>Character counts,
loop counts,
and source and target adjustments are displayed in decimal unless overridden by a switch on the command-line.</p></li>
<li><p>Invalid operation codes are displayed in the CPU’s data radix,
which defaults to octal but may be set to a different radix or overridden by a switch on the command-line.</p></li>
</ul>
<p>Each <span class="html"><samp>EDIT</samp></span> subprogram operation occupies from 1 to 257 bytes in memory.
If a multi-byte operation begins within the examined memory range,
the additional bytes required to complete the operation are displayed.
Including the <code class="docutils literal notranslate"><span class="pre">-R</span></code> switch will begin decoding with the right-hand (low-order) byte of the first memory word in the range rather than with the left-hand byte.
Invalid extended operation codes are displayed as a comma-separated pair of half-byte values (e.g., <code class="docutils literal notranslate"><span class="pre">17,12</span></code>).</p>
<p>If the indicated display radix is not the same as the current CPU data radix,
a leading character <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, <code class="docutils literal notranslate"><span class="pre">%</span></code>, <code class="docutils literal notranslate"><span class="pre">#</span></code>, or <code class="docutils literal notranslate"><span class="pre">!</span></code>,
is printed for binary, octal, decimal, or hexadecimal numbers,
respectively.</p>
<p>When the simulator examines the bit patterns of instructions in memory or registers to display in mnemonic form,
each will fall into one of four categories:</p>
<ol class="arabic simple">
<li><p>Defined (canonical) instruction encodings,
where all bits are defined or all reserved bits are zero
(e.g., <span class="html"><samp>LOAD</samp></span>).</p></li>
<li><p>Undefined (non-canonical) instruction encodings,
where reserved fields are “don’t care” bits
(e.g., <span class="html"><samp>MOVE</samp></span>).</p></li>
<li><p>Undefined (non-canonical) instruction encodings,
where reserved fields are decoded
(e.g., <span class="html"><samp>IXIT</samp></span>).</p></li>
<li><p>Unimplemented instruction encodings
(e.g., stack opcode 072,
or <span class="html"><samp>EADD</samp></span> without the EIS firmware option installed).</p></li>
</ol>
<p>The names of the canonical instructions in category 1 are displayed in uppercase,
as are the names of the non-canonical instructions in category 2.
The non-canonical instruction names in category 3 are displayed in lowercase.
This is to indicate to the user that the instructions that will be executed may not be the ones expected from the decoding.
Instruction names in category 4 that correspond to supported firmware options are displayed in uppercase,
regardless of whether or not the option is enabled.
Category 4 encodings that do not correspond to instructions are displayed in octal.</p>
</section>
<section id="memory-addressing">
<h4><span class="sectnum">1.2.2.3. </span>Memory addressing<a class="headerlink" href="#memory-addressing" title="Permalink to this heading">¶</a></h4>
<p>The CPU simulator supports two forms of memory addresses:</p>
<ul class="simple">
<li><p>An absolute address consisting of a 4-bit bank number and a 16-bit offset within the bank,
separated by a period
(e.g., <code class="docutils literal notranslate"><span class="pre">17.177777</span></code>).</p></li>
<li><p>A relative address consisting of a 16-bit offset within a bank specified by a bank register
(e.g., <code class="docutils literal notranslate"><span class="pre">177777</span></code>).</p></li>
</ul>
<p>Command-line switches modify the interpretation of relative addresses as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Switch</p></th>
<th class="head"><p>Interpretation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-P</span></code></p></td>
<td><p>The implied bank number is obtained from <span class="html"><samp class="register">PBANK</samp></span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-S</span></code></p></td>
<td><p>The implied bank number is obtained from <span class="html"><samp class="register">SBANK</samp></span></p></td>
</tr>
</tbody>
</table>
<p>If no switch is specified,
the implied bank number is obtained from <span class="html"><samp class="register">DBANK</samp></span>.</p>
<section id="examine-deposit-iexamine-and-ideposit">
<span id="ideposit"></span><span id="iexamine"></span><span id="deposit"></span><span id="examine"></span><h5><span class="sectnum">1.2.2.3.1. </span><span class="html"><samp><b>EXAMINE</b></samp></span>, <span class="html"><samp><b>DEPOSIT</b></samp></span>, <span class="html"><samp><b>IEXAMINE</b></samp></span>, and <span class="html"><samp><b>IDEPOSIT</b></samp></span><a class="headerlink" href="#examine-deposit-iexamine-and-ideposit" title="Permalink to this heading">¶</a></h5>
<p>The following address forms are valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EXAMINE</span> <span class="o">&lt;</span><span class="n">bank</span><span class="o">&gt;.&lt;</span><span class="n">offset</span><span class="o">&gt;</span>
<span class="n">EXAMINE</span> <span class="o">&lt;</span><span class="n">dbank</span><span class="o">-</span><span class="n">offset</span><span class="o">&gt;</span>
<span class="n">EXAMINE</span> <span class="o">-</span><span class="n">P</span> <span class="o">&lt;</span><span class="n">pbank</span><span class="o">-</span><span class="n">offset</span><span class="o">&gt;</span>
<span class="n">EXAMINE</span> <span class="o">-</span><span class="n">S</span> <span class="o">&lt;</span><span class="n">sbank</span><span class="o">-</span><span class="n">offset</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Addresses are always displayed in <code class="docutils literal notranslate"><span class="pre">&lt;bank&gt;.&lt;offset&gt;</span></code> form.</p>
</section>
<section id="break-and-nobreak">
<span id="nobreak"></span><span id="break"></span><h5><span class="sectnum">1.2.2.3.2. </span><span class="html"><samp><b>BREAK</b></samp></span> and <span class="html"><samp><b>NOBREAK</b></samp></span><a class="headerlink" href="#break-and-nobreak" title="Permalink to this heading">¶</a></h5>
<p>The following address forms are valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BREAK</span>
<span class="n">BREAK</span> <span class="o">&lt;</span><span class="n">bank</span><span class="o">&gt;.&lt;</span><span class="n">offset</span><span class="o">&gt;</span>
<span class="n">BREAK</span> <span class="o">&lt;</span><span class="n">pbank</span><span class="o">-</span><span class="n">offset</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The address defaults to the current values of <span class="html"><samp class="register">PBANK</samp></span> and/or <span class="html"><samp class="register">P</samp></span>.
All breakpoint addresses are stored and displayed in <code class="docutils literal notranslate"><span class="pre">&lt;bank&gt;.&lt;offset&gt;</span></code> form.</p>
</section>
<section id="run-and-go">
<span id="go"></span><span id="run"></span><h5><span class="sectnum">1.2.2.3.3. </span><span class="html"><samp><b>RUN</b></samp></span> and <span class="html"><samp><b>GO</b></samp></span><a class="headerlink" href="#run-and-go" title="Permalink to this heading">¶</a></h5>
<p>The following address form is valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RUN</span> <span class="o">&lt;</span><span class="n">pbank</span><span class="o">-</span><span class="n">offset</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The offset is stored in <span class="html"><samp class="register">P</samp></span>.
If <span class="html"><samp class="register">P</samp></span> does not lie within the PB-to-PL range,
the command will be rejected.</p>
<p>The SIMH <span class="html"><samp><b>RUN</b></samp></span> command typically resets all devices before beginning execution.
For the HP 3000,
CPU and I/O resets are performed at the start of the cold load sequence;
a reset after the cold load sequence completes will destroy the Interrupt Control Stack register setup performed by the microcode.
Therefore, in this simulator,
the <span class="html"><samp><b>RUN</b></samp></span> and <span class="html"><samp><b>GO</b></samp></span> commands are equivalent;
neither resets the devices.
If an explicit CPU reset is desired,
the <span class="html"><samp><b>RESET CPU</b></samp></span> command may be used.</p>
</section>
</section>
<section id="load-dump-and-boot">
<span id="load"></span><h4><span class="sectnum">1.2.2.4. </span><span class="html"><samp><b>LOAD</b></samp></span>, <span class="html"><samp><b>DUMP</b></samp></span>, and <span class="html"><samp><b>BOOT</b></samp></span><a class="headerlink" href="#load-dump-and-boot" title="Permalink to this heading">¶</a></h4>
<p>The <span class="html"><samp><b>LOAD</b></samp></span> command implements the 3000 cold load facility.
It is equivalent to pressing the <span class="html"><samp class="guilabel">LOAD</samp></span> and <span class="html"><samp class="guilabel">ENABLE</samp></span> buttons on the hardware front panel.
The syntax is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LOAD</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">control</span><span class="o">/</span><span class="n">devno</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p id="swch">The <span class="html"><samp class="register">SWCH</samp></span> register controls the cold load sequence;
the upper byte contains a device-specific control value,
and the lower byte contains the device number.
If the optional control/device number value is supplied,
it is deposited into the <span class="html"><samp class="register">SWCH</samp></span> register before initiating the cold load sequence.
Otherwise,
the <span class="html"><samp class="register">SWCH</samp></span> register value must be set before entering the command.
In either case,
the device number must be between 3 and 63,
or the command will not complete.</p>
<p id="dump">The <span class="html"><samp><b>DUMP</b></samp></span> command implements the 3000 cold dump facility.
It is equivalent to pressing the <span class="html"><samp class="guilabel">DUMP</samp></span> and <span class="html"><samp class="guilabel">ENABLE</samp></span> buttons on the hardware front panel.
The syntax is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DUMP</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">control</span><span class="o">/</span><span class="n">devno</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p id="dumpdev"><span id="dumpctl"></span>The CPU <span class="html"><samp><b>DUMPCTL</b></samp></span> and <span class="html"><samp><b>DUMPDEV</b></samp></span> settings control the cold dump sequence and correspond to the settings of the jumper blocks on the rear of the CPU front panel.
If the optional control/device number value is supplied,
it is deposited into the <span class="html"><samp class="register">SWCH</samp></span> register before initiating the cold dump sequence.
Otherwise, the <span class="html"><samp><b>DUMPCTL</b></samp></span> and <span class="html"><samp><b>DUMPDEV</b></samp></span> values are deposited into the <span class="html"><samp class="register">SWCH</samp></span> register.
A successful cold dump sets the CIR register to the number of 64K memory banks dumped.
For example,
dumping a 512K-word system will display <code class="docutils literal notranslate"><span class="pre">Cold</span> <span class="pre">dump</span> <span class="pre">complete,</span> <span class="pre">CIR:</span> <span class="pre">000010</span></code> if the operation succeeds.</p>
<p>The control/device number values are entered in the current CPU data radix.
Before entering either command,
unit 0 of the associated device must be attached.
A failed cold load will cause a system halt.
A failed cold dump will set the CIR register to the memory bank number at which the operation failed;
if the dump device is not ready or not write-enabled,
the CIR register will be set to zero.</p>
<p>Bootable peripherals,
such as the tape and disc drives,
also implement the <span class="html"><samp><b>BOOT</b></samp></span> command.
Entering a <span class="html"><samp><b>BOOT</b></samp></span> command for one of these devices will preset the <span class="html"><samp class="register">SWCH</samp></span> register to the appropriate value before executing a cold load.
Cold load supports booting only from unit 0 of the target device.</p>
</section>
<section id="power-fail-and-power-restore">
<h4><span class="sectnum">1.2.2.5. </span><span class="html"><samp><b>POWER FAIL</b></samp></span> and <span class="html"><samp><b>POWER RESTORE</b></samp></span><a class="headerlink" href="#power-fail-and-power-restore" title="Permalink to this heading">¶</a></h4>
<p id="power-down"><span id="power-off"></span><span id="power-fail"></span>The <span class="html"><samp><b>POWER FAIL</b></samp></span> command
(and its alternate forms <span class="html"><samp><b>POWER OFF</b></samp></span> and <span class="html"><samp><b>POWER DOWN</b></samp></span>)
simulates removing AC power from the system.
If the CPU was executing when the command is entered,
a power-fail interrupt is generated,
and MPE initiates its power-fail processing that ends with a programmed <span class="html"><samp class="register">HALT</samp></span>.
Otherwise, power is removed,
and the CPU remains halted.
<span class="html"><samp><b>POWER FAIL</b></samp></span> is accepted only when power is on.</p>
<p id="power-restore"><span id="power-up"></span><span id="power-on"></span>The <span class="html"><samp><b>POWER RESTORE</b></samp></span> command
(and its alternate forms <span class="html"><samp><b>POWER ON</b></samp></span> and <span class="html"><samp><b>POWER UP</b></samp></span>) simulates restoring AC power to the system;
it is accepted only when power is off.
If the CPU was executing when power failed,
a power-on trap is generated,
and, if auto-restart is enabled,
MPE initiates its power-recovery processing.
If auto-restart is disabled,
the trap is set up but the simulator must be resumed with a <span class="html"><samp><b>CONTINUE</b></samp></span> command to execute the trap.
If the CPU was halted when power failed,
power is restored,
and the CPU remains halted.
Once power is off,
the <span class="html"><samp><b>CONTINUE</b></samp></span>, <span class="html"><samp><b>STEP</b></samp></span>, <span class="html"><samp><b>GO</b></samp></span>, and <span class="html"><samp><b>RUN</b></samp></span> commands will not be accepted until power is restored.</p>
</section>
<section id="device-configuration">
<h4><span class="sectnum">1.2.2.6. </span>Device configuration<a class="headerlink" href="#device-configuration" title="Permalink to this heading">¶</a></h4>
<p>Most devices support user configuration.
The general forms of the configuration commands are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SET</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">switch</span><span class="o">&gt;</span> <span class="o">...</span><span class="p">}</span> <span class="o">&lt;</span><span class="n">device</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">option</span><span class="o">&gt;</span> <span class="p">{,</span><span class="o">&lt;</span><span class="n">option</span><span class="o">&gt;</span> <span class="o">...</span><span class="p">}</span>
<span class="n">SET</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">switch</span><span class="o">&gt;</span> <span class="o">...</span><span class="p">}</span> <span class="o">&lt;</span><span class="n">unit</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">option</span><span class="o">&gt;</span> <span class="p">{,</span><span class="o">&lt;</span><span class="n">option</span><span class="o">&gt;</span> <span class="o">...</span><span class="p">}</span>
</pre></div>
</div>
<p>The options available and applicable switches are described in the individual device descriptions below.</p>
</section>
<section id="enabling-and-disabling-devices">
<h4><span class="sectnum">1.2.2.7. </span>Enabling and disabling devices<a class="headerlink" href="#enabling-and-disabling-devices" title="Permalink to this heading">¶</a></h4>
<p>All devices other than the processor devices may be disabled or enabled.
Disabling a device simulates removing the associated interface from the system cabinet.
To disable or enable a device, use:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SET</b> <var>device</var> <b>DISABLED</b></samp></span></p></td>
<td><p>Disable the device</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SET</b> <var>device</var> <b>ENABLED</b></samp></span></p></td>
<td><p>Enable the device</p></td>
</tr>
</tbody>
</table>
<p>Devices that consist of multiple addressable units connected to a controller allow the units to be individually disabled or enabled.
Disabling simulates disconnecting the associated unit from the controller.
The commands to disable or enable a unit are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SET</b> <var>unit</var> <b>DISABLED</b></samp></span></p></td>
<td><p>Disable the unit</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SET</b> <var>unit</var> <b>ENABLED</b></samp></span></p></td>
<td><p>Enable the unit</p></td>
</tr>
</tbody>
</table>
<p>Each of the above command options is replicated in the option tables of the devices to which they apply.</p>
</section>
<section id="i-o-interface-assignments">
<h4><span class="sectnum">1.2.2.8. </span>I/O interface assignments<a class="headerlink" href="#i-o-interface-assignments" title="Permalink to this heading">¶</a></h4>
<p>HP 3000 hardware I/O interfaces have configuration jumpers that set device numbers,
interrupt masks,
and multiplexer channel service request priority numbers.
In addition,
the interrupt poll order,
and therefore the interrupt priority,
is established by the position of each interface along the daisy-chained interrupt cable.</p>
<p>Device options that may be specified to change or display interface configurations are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Valid values</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVNO</b></samp></span></p></td>
<td><p>0–127</p></td>
<td><p>Set the device number</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INTMASK</b></samp></span></p></td>
<td><p>0–15, D, E</p></td>
<td><p>Set the interrupt mask</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INTPRI</b></samp></span></p></td>
<td><p>0–31</p></td>
<td><p>Set the interrupt priority</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SRNO</b></samp></span></p></td>
<td><p>0–15</p></td>
<td><p>Set the service request number</p></td>
</tr>
</tbody>
</table>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SET</span> <span class="n">MS</span> <span class="n">DEVNO</span><span class="o">=</span><span class="mi">6</span>
<span class="n">SET</span> <span class="n">MS</span> <span class="n">INTMASK</span><span class="o">=</span><span class="n">E</span>
<span class="n">SHOW</span> <span class="n">MS</span> <span class="n">DEVNO</span><span class="p">,</span><span class="n">INTMASK</span>
</pre></div>
</div>
<p>The interrupt mask may be set to a numeric value,
to <span class="html"><samp><b>D</b></samp></span> to disable the mask always,
or to <span class="html"><samp><b>E</b></samp></span> to enable the mask always.
Numeric mask values may be shared among devices.
However, if two device,
interrupt priority,
or service request priority numbers conflict,
the simulator will report the error when execution is attempted.</p>
<p>The default settings are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Device name</p></th>
<th class="head"><p>Device number</p></th>
<th class="head"><p>Interrupt priority</p></th>
<th class="head"><p>Interrupt mask</p></th>
<th class="head"><p>Service request number</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CPU</b></samp></span></p></td>
<td><p>—</p></td>
<td><p>—</p></td>
<td><p>—</p></td>
<td><p>—</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>IOP</b></samp></span></p></td>
<td><p>—</p></td>
<td><p>—</p></td>
<td><p>—</p></td>
<td><p>—</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SEL</b></samp></span></p></td>
<td><p>—</p></td>
<td><p>—</p></td>
<td><p>—</p></td>
<td><p>—</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>MPX</b></samp></span></p></td>
<td><p>127</p></td>
<td><p>—</p></td>
<td><p>—</p></td>
<td><p>—</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ATCD</b></samp></span></p></td>
<td><p>7</p></td>
<td><p>0</p></td>
<td><p>E</p></td>
<td><p>—</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ATCC</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>E</p></td>
<td><p>—</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CLK</b></samp></span></p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>—</p></td>
<td><p>—</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DS</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>E</p></td>
<td><p>—</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>LP</b></samp></span></p></td>
<td><p>14</p></td>
<td><p>18</p></td>
<td><p>E</p></td>
<td><p>11</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>MS</b></samp></span></p></td>
<td><p>6</p></td>
<td><p>14</p></td>
<td><p>E</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SCMB1</b></samp></span></p></td>
<td><p>65</p></td>
<td><p>10</p></td>
<td><p>—</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SCMB2</b></samp></span></p></td>
<td><p>66</p></td>
<td><p>11</p></td>
<td><p>—</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>The SCMB device numbers and interrupt priorities may be set to any unused values.</p>
</section>
<section id="save-and-restore">
<span id="restore"></span><span id="save"></span><h4><span class="sectnum">1.2.2.9. </span><span class="html"><samp><b>SAVE</b></samp></span> and <span class="html"><samp><b>RESTORE</b></samp></span><a class="headerlink" href="#save-and-restore" title="Permalink to this heading">¶</a></h4>
<p><span class="html"><samp><b>SAVE</b></samp></span> and <span class="html"><samp><b>RESTORE</b></samp></span> are supported only when the simulator executable used to restore the simulator state file is the same simulator executable used to save the file.
Correctly restoring the state of the simulator depends on the layout of internal structure variables being identical to the layout of the structure variables that were saved.
This is guaranteed only when using the same executable,
as the layout used is implementation-defined.</p>
</section>
</section>
<section id="realistic-calibrated-and-optimized-timing">
<h3><span class="sectnum">1.2.3. </span>Realistic, calibrated, and optimized timing<a class="headerlink" href="#realistic-calibrated-and-optimized-timing" title="Permalink to this heading">¶</a></h3>
<p>Devices simulate their I/O operation delays (disc seeks,
magnetic tape reads,
printer paper movements, etc.)
by counting specified numbers of “event ticks”.
For example,
a disc seek completion might be scheduled to occur 500 event ticks after command initiation.
Generally,
one event tick is counted for each machine instruction executed,
although some complex instructions may count an event tick for each internal step of the instruction
(e.g., for each word moved within a block-move instruction).
Device simulations provide commands that determine how the appropriate tick counts are selected for I/O operations timing:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SET</b> <var>device</var> <b>REALTIME</b></samp></span></p></td>
<td><p>Configure the device to use realistic timing</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SET</b> <var>device</var> <b>CALTIME</b></samp></span></p></td>
<td><p>Configure the device to use calibrated timing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SET</b> <var>device</var> <b>FASTTIME</b></samp></span></p></td>
<td><p>Configure the device to use optimized timing</p></td>
</tr>
</tbody>
</table>
<p id="realtime">A device configured to use <em>realistic timing</em> selects its tick counts to encompass the same number of machine instructions as would be executed in hardware.
In real-time mode,
an operation taking ten milliseconds in hardware will complete after 4000 machine instructions are executed,
based on an average instruction execution time of 2.5 microseconds.
In this mode,
a software program will execute approximately the same number of instructions during a device operation that it would do on a real machine.
Host machine speed and execution of concurrent host programs will not affect the number of simulated instructions executed for a given operation.</p>
<p id="caltime">A device configured to use <em>calibrated timing</em> selects its tick counts to align the simulated operation periods with the corresponding time periods on the host system.
In calibrated-time mode,
an operation taking ten milliseconds in hardware will complete after ten milliseconds has elapsed on the host system.
Because the simulator is generally one or two orders of magnitude faster than the hardware,
a software program will execute far more code during a device operation than it would do on a real machine.
In this mode,
the amount of code that executes will vary with the speed of the host machine and the load placed on that machine by other concurrent processes,
as the simulator continually adjusts the tick counts up and down to maintain synchronization with the host time.</p>
<p id="fasttime">A device configured to use <em>optimized timing</em> selects its tick counts to minimize the operation delays.
In fast-time mode,
an operation taking ten milliseconds in hardware will complete after the minimum amount of time acceptable to the executing software has elapsed.
In this mode,
device operations complete far more quickly than they do in hardware.
There are limits,
however,
to how fast I/O operations may occur without causing software malfunctions.
In practice,
system software often contains assumptions regarding the time certain operations take, so event timing may not be arbitrarily reduced.
For instance,
an I/O driver may “know” that a line printer takes 50 milliseconds to print a line,
and therefore it can ignore interrupts safely for several milliseconds after initiating the print cycle.
If the printing time is reduced below that threshold,
the driver may fail to operate correctly.
The default optimized-timing settings have been empirically determined to work with the supported operating systems listed above,
and each device simulator allows the user to modify those settings via registers if needed.</p>
<p>To illustrate how the modes affect timing,
consider a simulation of a Teletype terminal that operates at 10 characters per second.
If the simulator runs 15 times faster than a real machine,
then a user would observe that printing 100 characters takes:</p>
<ul class="simple">
<li><p>10 seconds in <span class="html"><samp>CALTIME</samp></span> mode
(100 characters × <span class="html"><samp><var>n</var></samp></span> event ticks per character adjusted to take exactly 100 mS each on the host system)</p></li>
<li><p>667 milliseconds in <span class="html"><samp>REALTIME</samp></span> mode
(100 characters × 40,000 event ticks per character × 2.5 µS per tick ÷ 15 times hardware speed)</p></li>
<li><p>8.33 milliseconds in <span class="html"><samp>FASTTIME</samp></span> mode
(100 characters × 500 event ticks per character × 2.5 µS per tick ÷ 15 times hardware speed)</p></li>
</ul>
<p>If the SCP <span class="html"><samp><b>SET THROTTLE</b></samp></span> command is used to reduce the speed of the simulator,
<span class="html"><samp>CALTIME</samp></span> operations will not be affected,
but <span class="html"><samp>REALTIME</samp></span> and <span class="html"><samp>FASTTIME</samp></span> operations will slow proportionally.
Reducing simulator speed to that of the original hardware will cause <span class="html"><samp>REALTIME</samp></span> operation times to equal <span class="html"><samp>CALTIME</samp></span> times.</p>
<p>Devices offer only those modes that are generally useful.
For example,
the CPU process clock and system clock may be configured to use <span class="html"><samp>REALTIME</samp></span> or <span class="html"><samp>CALTIME</samp></span> modes.
The real-time mode will satisfy the expectations of hardware diagnostics that check the timing of operations via delay loops,
whereas the calibrated mode will update the MPE time-of-day clock as expected by users of the simulated system.
<span class="html"><samp>FASTTIME</samp></span> mode is not offered,
as it makes no sense to ignore the programmed time period settings and use a fixed arbitrary period instead.</p>
<p>Devices performing input or output typically offer a <span class="html"><samp>REALTIME</samp></span> mode for use when running the diagnostics and a <span class="html"><samp>FASTTIME</samp></span> mode for use when running operating systems.
In general,
software running under simulation will run faster when devices are configured for optimized-time mode,
and this is the default for all peripheral devices.</p>
</section>
<section id="the-simulation-console-and-the-system-console">
<h3><span class="sectnum">1.2.4. </span>The simulation console and the system console<a class="headerlink" href="#the-simulation-console-and-the-system-console" title="Permalink to this heading">¶</a></h3>
<p>When the simulator is started,
the SCP command prompt appears at the <em>simulation console</em>.
For windowed host operating systems,
this is typically the same window from which the simulator was started.
Once a <span class="html"><samp><b>RUN</b></samp></span> command is entered at the simulation console,
the standalone diagnostics and MPE operating system begin their user interactions at the <em>system console</em>.
The HP 3000 reserves channel 0 of the ATC terminal multiplexer for the system console.</p>
<p>For convenience and by default,
the system console is connected to the simulation console,
so that SCP and MPE operator commands may be entered from the same window.
Additional “user” terminals may be connected via Telnet or serial ports to ATC channels 1–15 as described later.</p>
<p>The system console may be separated from the simulation console by using the <span class="html"><samp><b>SET CONSOLE TELNET=</b><var>port</var></samp></span> or <span class="html"><samp><b>SET CONSOLE SERIAL=</b><var>port</var></samp></span> command.
This leaves the simulation console at the initiating window and moves the system console to a Telnet or serial port,
allowing the use of an HP terminal or terminal emulator.
Entering the <span class="html"><samp><b>SET CONSOLE NOTELNET</b></samp></span> or <span class="html"><samp><b>SET CONSOLE NOSERIAL</b></samp></span> command will rejoin the consoles.</p>
</section>
<section id="tracing-simulator-operations">
<h3><span class="sectnum">1.2.5. </span>Tracing simulator operations<a class="headerlink" href="#tracing-simulator-operations" title="Permalink to this heading">¶</a></h3>
<p>The simulator provides options for extensive tracing of the internal operations of all devices.
This is useful as an aid to hardware and software debugging as well as to gain an understanding of the internal operations of the simulated devices.
Each device offers multiple trace reporting levels,
from command overviews to detailed backplane signal assertions.
Tracing for each device and its separate reporting levels may be enabled independently.</p>
<p>To obtain a trace,
two SCP commands must be given.
First, a <em>debug log</em> must be established with the <span class="html"><samp><b>SET DEBUG</b> <var>target</var></samp></span> command.
This command is described in detail in the <em>“Controlling debugging”</em> section of the <a class="reference external" href="simh_doc.rst">SIMH Users’ Guide</a> manual.
Typically,
the target is a text file,
so that the trace may be reviewed after capture.
Second,
tracing must be enabled for the desired devices with <span class="html"><samp><b>SET</b> <var>device</var> <b>DEBUG=</b><var>option</var></samp></span> commands.
These are documented below in the sections that refer to the simulated devices.</p>
<p>The reporting level options table given for each device is arranged in order of increasing detail.
The first option listed provides the broadest overview with the least specific detail and generates the smallest number of trace lines,
thereby slowing program execution the least.
Subsequent options provide increasing detail at the expense of larger debug log files.
Enabling all trace options with a <span class="html"><samp><b>SET</b> <var>device</var> <b>DEBUG</b></samp></span> command provides the fullest picture of device operation but may generate very large log files.</p>
<p>Some options enable tracing of periodic events,
e.g., a clock tick or a device poll.
Use caution when specifying these options,
as the trace log may fill rapidly.
Options that trace periodic behavior are noted in the option descriptions.</p>
<p>The formats of the trace output are specific to the devices being traced.
Examples are provided in each device description section below.</p>
</section>
</section>
<section id="processor-device-simulations">
<h2><span class="sectnum">1.3. </span>Processor device simulations<a class="headerlink" href="#processor-device-simulations" title="Permalink to this heading">¶</a></h2>
<p>The HP 3000 computer consists of the following subsystems:</p>
<ul class="simple">
<li><p>30003B Central Processing Unit</p></li>
<li><p>30003B I/O Processor</p></li>
<li><p>30030C Selector Channel</p></li>
<li><p>30036B Multiplexer Channel</p></li>
</ul>
<section id="central-processing-unit">
<span id="cpu"></span><h3><span class="sectnum">1.3.1. </span>Central Processing Unit<a class="headerlink" href="#central-processing-unit" title="Permalink to this heading">¶</a></h3>
<p>The HP 3000 Central Processing Unit contains the microprogrammed machine instruction execution unit,
main memory,
and process clock.
CPU options specify the memory size,
installed firmware,
and simulation configuration.
The CPU is configured with commands of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SET</span> <span class="p">{</span><span class="o">-</span><span class="n">F</span><span class="p">}</span> <span class="n">CPU</span> <span class="o">&lt;</span><span class="n">option</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Device options that may be specified are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>128K</b></samp></span></p></td>
<td><p>Set the memory size to 128K words</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>256K</b></samp></span></p></td>
<td><p>Set the memory size to 256K words</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>384K</b></samp></span></p></td>
<td><p>Set the memory size to 384K words</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>512K</b></samp></span></p></td>
<td><p>Set the memory size to 512K words</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>768K</b></samp></span></p></td>
<td><p>Set the memory size to 768K words</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>1024K</b></samp></span></p></td>
<td><p>Set the memory size to 1024K words; default for Series III</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CIS</b></samp></span></p></td>
<td><p>Enable the COBOL II Extended Instruction Set firmware</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NOCIS</b></samp></span></p></td>
<td><p>Disable the COBOL II Extended Instruction Set firmware; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ARS</b></samp></span></p></td>
<td><p>Enable auto-restart after a power failure; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NOARS</b></samp></span></p></td>
<td><p>Disable auto-restart after a power failure</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CALTIME</b></samp></span></p></td>
<td><p>Use calibrated process clock timing; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>REALTIME</b></samp></span></p></td>
<td><p>Use realistic process clock timing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>IDLE</b></samp></span></p></td>
<td><p>Enable idle detection</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NOIDLE</b></samp></span></p></td>
<td><p>Disable idle detection; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DUMPDEV=</b><var>n</var></samp></span></p></td>
<td><p>Set the dump device number; default is 6</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DUMPCTL=</b><var>n</var></samp></span></p></td>
<td><p>Set the dump device control value; default is 004</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>STOP=</b><var>option</var></samp></span></p></td>
<td><p>Enable simulation stops</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NOSTOP</b></samp></span></p></td>
<td><p>Disable simulation stops; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>EXEC=</b><var>match</var>[<b>;</b><var>mask</var>]</samp></span></p></td>
<td><p>Enable execution tracing of matching instructions</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NOEXEC</b></samp></span></p></td>
<td><p>Disable execution tracing; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEBUG=</b><var>option</var></samp></span></p></td>
<td><p>Enable tracing</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NODEBUG</b></samp></span></p></td>
<td><p>Disable tracing; default</p></td>
</tr>
</tbody>
</table>
<p>The initial configuration is a Series III system with 1024K words of memory.
If the memory size is being reduced,
and the memory being truncated contains non-zero data,
the simulator asks for confirmation before proceeding.
The confirmation request may be suppressed by using the <code class="docutils literal notranslate"><span class="pre">-F</span></code> (force) switch.
Data in the truncated portion of memory is lost.</p>
<p>The <span class="html"><samp><b>SET CPU CIS</b></samp></span> command simulates the installation of the HP 32234A COBOL II Extended Instruction Set firmware on the ROM PCA and removal of the W4 jumper from the CIR PCA to enable decoding of the instructions.
The HP 32233A COBOLII/3000 compiler and programs produced by this compiler require the firmware to execute.
If it is not installed,
these programs will abort at run time with <em>ILLEGAL INSTRUCTION</em> errors.</p>
<p>The position of the <span class="html"><samp class="guilabel">PF/ARS</samp></span> switch on the back of the system control panel determines how the CPU responds to AC power returning after a power failure.
In the <em>enable</em> position,
simulated by the <span class="html"><samp><b>SET CPU ARS</b></samp></span> command,
power restoration will initiate an automatic restart of the operating system.
In the <em>disable</em> position,
simulated by the <span class="html"><samp><b>SET CPU NOARS</b></samp></span> command,
power restoration will set up the system for a restart,
which must be performed manually by entering a <span class="html"><samp><b>CONTINUE</b></samp></span>, <span class="html"><samp><b>STEP</b></samp></span>, <span class="html"><samp><b>GO</b></samp></span>, or <span class="html"><samp><b>RUN</b></samp></span> command.</p>
<p>Calibrated timing adjusts the process clock to match actual elapsed time.
Realistic timing bases the process-clock interval on machine instructions executed.</p>
<p>When enabled by a <span class="html"><samp><b>SET CPU IDLE</b></samp></span> command,
execution of a <span class="html"><samp>PAUS</samp></span> instruction will idle the simulator.
While idle,
the simulator does not use any host system processor time.
Idle detection requires that the process clock and system clock be set to calibrated timing.
Idling is disabled by default.</p>
<p>The <span class="html"><samp><b>DUMPDEV</b></samp></span> and <span class="html"><samp><b>DUMPCTL</b></samp></span> options configure the set of jumpers on the rear of the CPU front panel that preset the device number and control value for the cold dump process.
These values are used when the <span class="html"><samp><b>DUMP</b></samp></span> command is entered without the optional control/device number.
The device number range is 0–127 decimal,
and the control value range is 0–377 octal.
The default control value corresponds to the Write Record tape command.</p>
<p id="set-cpu-stop">The <span class="html"><samp><b>SET CPU STOP</b></samp></span> command enables one or more simulation stop conditions.
These are described in the <a class="reference internal" href="#simulation-stops">Simulation stops</a> section below.</p>
<p>The <span class="html"><samp><b>SET CPU EXEC</b></samp></span> command configures instruction execution tracing.
This command is described in the <a class="reference internal" href="#tracing">Tracing</a> section below.</p>
<p>The CPU configuration may be displayed with the following commands:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW CPU</b></samp></span></p></td>
<td><p>Display the device configuration</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW CPU STOPS</b></samp></span></p></td>
<td><p>Display the enabled simulation stops</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW CPU EXEC</b></samp></span></p></td>
<td><p>Display the matching criteria for execution tracing</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW CPU DUMP</b></samp></span></p></td>
<td><p>Display the cold dump device number and control value</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW CPU SPEED</b></samp></span></p></td>
<td><p>Display the current simulation speed</p></td>
</tr>
</tbody>
</table>
<p>When the process clock is calibrated,
the current simulation speed,
expressed as a multiple of the speed of a real HP 3000 Series III,
may be obtained with the <span class="html"><samp><b>SHOW CPU SPEED</b></samp></span> command.
The speed reported will not be representative if the simulator was executing a <span class="html"><samp>PAUS</samp></span> instruction when it was stopped.</p>
<section id="system-halt">
<h4><span class="sectnum">1.3.1.1. </span>System halt<a class="headerlink" href="#system-halt" title="Permalink to this heading">¶</a></h4>
<p>The MPE operating system is supported by special microcode features that perform code and data segment mapping,
segment access bounds checking,
privilege checking, etc.
The layout of certain in-memory tables is known to both the OS and the microcode and is used to validate execution of instructions.
For instance,
every stack instruction is checked for a valid access within the stack segment boundaries,
which are set up by the OS before program dispatch.
For this reason,
the 3000 cannot be operated as a “bare” machine,
because these tables will not have been initialized.
Similarly,
the cold load process by which the OS is loaded from storage media into memory is entirely in microcode,
as machine instructions cannot be executed until the required tables are loaded into memory.</p>
<p>This OS/microcode integration means that the microcode may detect conditions that make continued execution impossible.
An example would be an absent segment fault for the segment containing the disc I/O driver.
If such a condition is detected,
the CPU does a <em>system halt</em>.
This fatal microcode error,
distinct from a regular programmed halt,
causes operation to cease until the CPU is reset.</p>
<p>A system halt stops the simulator and reports the system halt code to the simulation console.
The code indicates the reason for the system halt,
as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Reason for system halt</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>1</strong></p></td>
<td><p>STT violation while executing in segment 1</p></td>
</tr>
<tr class="row-odd"><td><p><strong>2</strong></p></td>
<td><p>Absent code segment while executing on the ICS</p></td>
</tr>
<tr class="row-even"><td><p><strong>3</strong></p></td>
<td><p>Code segment 1 is absent</p></td>
</tr>
<tr class="row-odd"><td><p><strong>4</strong></p></td>
<td><p>Stack overflow while executing on the ICS</p></td>
</tr>
<tr class="row-even"><td><p><strong>6</strong></p></td>
<td><p>I/O device timeout while executing <span class="html"><samp>IXIT</samp></span> or cold load</p></td>
</tr>
<tr class="row-odd"><td><p><strong>9</strong></p></td>
<td><p>Dispatcher already enabled while executing PSEB</p></td>
</tr>
<tr class="row-even"><td><p><strong>13</strong></p></td>
<td><p>CST violation while executing in segment 1</p></td>
</tr>
<tr class="row-odd"><td><p><strong>23</strong></p></td>
<td><p>External interrupts disabled while executing LOCK</p></td>
</tr>
<tr class="row-even"><td><p><strong>33</strong></p></td>
<td><p>Attempt to trace segment 1</p></td>
</tr>
</tbody>
</table>
<p>If a system halt has occurred,
simulator execution may not be resumed until a <span class="html"><samp><b>RESET</b></samp></span>, <span class="html"><samp><b>RESET CPU</b></samp></span>, or <span class="html"><samp><b>LOAD</b></samp></span> command has been entered.</p>
</section>
<section id="idling">
<h4><span class="sectnum">1.3.1.2. </span>Idling<a class="headerlink" href="#idling" title="Permalink to this heading">¶</a></h4>
<p>The <span class="html"><samp>PAUS</samp></span> instruction suspends instruction execution until an interrupt occurs.
It is intended to defer instruction fetches from memory to allow full-bandwidth access by the Selector and Multiplexer Channels.
If enabled,
the simulator will idle only during execution of <span class="html"><samp>PAUS</samp></span>.</p>
</section>
<section id="simulation-stops">
<h4><span class="sectnum">1.3.1.3. </span>Simulation stops<a class="headerlink" href="#simulation-stops" title="Permalink to this heading">¶</a></h4>
<p>The simulator can be configured to detect certain machine instruction conditions and stop execution when one or more of them occur.
Four stop options control the simulation stop conditions:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Stop condition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>LOOP</b></samp></span></p></td>
<td><p>Stop when an infinite loop is executed</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PAUSE</b></samp></span></p></td>
<td><p>Stop when a <span class="html"><samp>PAUS</samp></span> instruction is executed</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UNDEF</b></samp></span></p></td>
<td><p>Stop when an undefined instruction is executed</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>UNIMPL</b></samp></span></p></td>
<td><p>Stop when an unimplemented instruction is executed</p></td>
</tr>
</tbody>
</table>
<p>Setting the <span class="html"><samp><b>LOOP</b></samp></span> option stops the simulator if it attempts to execute an instruction that enters an infinite loop
(e.g., <code class="docutils literal notranslate"><span class="pre">BR P+0</span></code>).
The branch instructions TBA, TBX, BCC, BR, BCY, BNCY, BOV, and BNOV result in an infinite loop if the branch displacement is zero and the branch condition is true.
The remaining branch instructions cannot result in an infinite loop,
as they all modify the CPU state and so eventually will reach a point where they drop out of their loops.</p>
<p>Setting the <span class="html"><samp><b>PAUSE</b></samp></span> option stops the simulator if execution of a <span class="html"><samp>PAUS</samp></span> instruction is attempted.
Setting the <span class="html"><samp><b>UNDEF</b></samp></span> option stops the simulator if execution of a non-canonical instruction
(i.e., an instruction containing a decoded reserved bit pattern other than that defined in the <cite>Machine Instruction Set</cite> manual)
is attempted.
Setting the <span class="html"><samp><b>UNIMPL</b></samp></span> option stops the simulator if execution of an unimplemented instruction is attempted.</p>
<p>After a simulation stop,
execution may be resumed in one of two ways.
If the cause of the stop has not been remedied and the stop option has not been disabled,
resuming execution with <span class="html"><samp><b>CONTINUE</b></samp></span>, <span class="html"><samp><b>STEP</b></samp></span>, <span class="html"><samp><b>GO</b></samp></span>, or <span class="html"><samp><b>RUN</b></samp></span> will cause the stop to occur again.
Alternately,
specifying the <code class="docutils literal notranslate"><span class="pre">-B</span></code> switch with any of the preceding commands will resume execution while bypassing the stop for the current instruction.</p>
<p>When the simulator examines the bit patterns of instructions to execute,
each will fall into one of four categories:</p>
<ol class="arabic simple">
<li><p>Defined (canonical) instruction encodings,
where all bits are defined or all reserved bits are zero (e.g., <span class="html"><samp>LOAD</samp></span>).</p></li>
<li><p>Undefined (non-canonical) instruction encodings,
where reserved fields are “don’t care” bits
(e.g., <span class="html"><samp>MOVE</samp></span>).</p></li>
<li><p>Undefined (non-canonical) instruction encodings,
where reserved fields are decoded
(e.g., <span class="html"><samp>IXIT</samp></span>).</p></li>
<li><p>Unimplemented instruction encodings
(e.g., stack opcode 072,
or <span class="html"><samp>EADD</samp></span> without the EIS firmware option installed).</p></li>
</ol>
<p>Instructions in categories 1 and 2 are always executed.
The <span class="html"><samp><b>UNDEF</b></samp></span> option stops the simulator for instructions in category 3.
The intent is to catch instructions containing reserved fields with values that change the meaning of those instructions.
The <span class="html"><samp><b>UNIMPL</b></samp></span> option stops the simulator for instructions in category 4.</p>
<p>Bypassing a stop has the following effect:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Bypass action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>LOOP</b></samp></span></p></td>
<td><p>Resume execution of the infinite loop</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PAUSE</b></samp></span></p></td>
<td><p>Resume execution with the instruction following <span class="html"><samp>PAUS</samp></span></p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UNDEF</b></samp></span></p></td>
<td><p>Resume execution with decoding as in the hardware</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>UNIMPL</b></samp></span></p></td>
<td><p>Resume execution with an Unimplemented Instruction trap</p></td>
</tr>
</tbody>
</table>
<p>Note that the <span class="html"><samp><b>PAUSE</b></samp></span> action corresponds in hardware to pressing the <span class="html"><samp class="guilabel">HALT</samp></span> button and then the <span class="html"><samp class="guilabel">RUN</samp></span> button.
If the stop conditions are disabled,
the simulator performs the actions above,
except that <span class="html"><samp>PAUS</samp></span> suspends instruction execution until a device interrupt occurs.</p>
</section>
<section id="tracing">
<h4><span class="sectnum">1.3.1.4. </span>Tracing<a class="headerlink" href="#tracing" title="Permalink to this heading">¶</a></h4>
<p>When debug output logging is enabled,
tracing may be configured by specifying one or more of the reporting level options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Reporting level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>INSTR</b></samp></span></p></td>
<td><p>Machine instructions executed</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DATA</b></samp></span></p></td>
<td><p>Memory data accesses</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>FETCH</b></samp></span></p></td>
<td><p>Memory instruction fetches</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>REG</b></samp></span></p></td>
<td><p>Register values</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>OPND</b></samp></span></p></td>
<td><p>Memory operand values</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>EXEC</b></samp></span></p></td>
<td><p>Matching instruction execution states</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>PSERV</b></samp></span></p></td>
<td><p>Process clock service events (periodic)</p></td>
</tr>
</tbody>
</table>
<p>A section of an example trace is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="n">CPU</span> <span class="n">fetch</span><span class="p">:</span> <span class="mf">00.010342</span>  <span class="mi">020320</span>    <span class="n">instruction</span> <span class="n">fetch</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span> <span class="n">instr</span><span class="p">:</span> <span class="mf">00.010341</span>  <span class="mi">000300</span>  <span class="n">ZROX</span><span class="p">,</span><span class="n">NOP</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span>   <span class="n">reg</span><span class="p">:</span> <span class="mf">00.006500</span>  <span class="mi">000000</span>    <span class="n">X</span> <span class="mi">000000</span><span class="p">,</span> <span class="n">M</span> <span class="n">i</span> <span class="n">t</span> <span class="n">r</span> <span class="n">o</span> <span class="n">c</span> <span class="n">CCG</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span> <span class="n">fetch</span><span class="p">:</span> <span class="mf">00.010343</span>  <span class="mi">041100</span>    <span class="n">instruction</span> <span class="n">fetch</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span> <span class="n">instr</span><span class="p">:</span> <span class="mf">00.010342</span>  <span class="mi">020320</span>  <span class="n">PLDA</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span>  <span class="n">data</span><span class="p">:</span> <span class="mf">00.000000</span>  <span class="mi">001340</span>    <span class="n">absolute</span> <span class="n">read</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span>   <span class="n">reg</span><span class="p">:</span> <span class="mf">00.006500</span>  <span class="mi">000001</span>    <span class="n">A</span> <span class="mi">001340</span><span class="p">,</span> <span class="n">X</span> <span class="mi">000000</span><span class="p">,</span> <span class="n">M</span> <span class="n">i</span> <span class="n">t</span> <span class="n">r</span> <span class="n">o</span> <span class="n">c</span> <span class="n">CCG</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span> <span class="n">fetch</span><span class="p">:</span> <span class="mf">00.010344</span>  <span class="mi">037777</span>    <span class="n">instruction</span> <span class="n">fetch</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span> <span class="n">instr</span><span class="p">:</span> <span class="mf">00.010343</span>  <span class="mi">041100</span>  <span class="n">LOAD</span> <span class="n">DB</span><span class="o">+</span><span class="mi">100</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span>  <span class="n">data</span><span class="p">:</span> <span class="mf">00.002100</span>  <span class="mi">123003</span>    <span class="n">data</span> <span class="n">read</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span>   <span class="n">reg</span><span class="p">:</span> <span class="mf">00.006500</span>  <span class="mi">000002</span>    <span class="n">A</span> <span class="mi">123003</span><span class="p">,</span> <span class="n">B</span> <span class="mi">001340</span><span class="p">,</span> <span class="n">X</span> <span class="mi">000000</span><span class="p">,</span> <span class="n">M</span> <span class="n">i</span> <span class="n">t</span> <span class="n">r</span> <span class="n">o</span> <span class="n">c</span> <span class="n">CCL</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span> <span class="n">fetch</span><span class="p">:</span> <span class="mf">00.010345</span>  <span class="mi">023404</span>    <span class="n">instruction</span> <span class="n">fetch</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span> <span class="n">instr</span><span class="p">:</span> <span class="mf">00.010344</span>  <span class="mi">037777</span>  <span class="n">ANDI</span> <span class="mi">377</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span>   <span class="n">reg</span><span class="p">:</span> <span class="mf">00.006500</span>  <span class="mi">000002</span>    <span class="n">A</span> <span class="mi">000003</span><span class="p">,</span> <span class="n">B</span> <span class="mi">001340</span><span class="p">,</span> <span class="n">X</span> <span class="mi">000000</span><span class="p">,</span> <span class="n">M</span> <span class="n">i</span> <span class="n">t</span> <span class="n">r</span> <span class="n">o</span> <span class="n">c</span> <span class="n">CCG</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span> <span class="n">fetch</span><span class="p">:</span> <span class="mf">00.010346</span>  <span class="mi">002043</span>    <span class="n">instruction</span> <span class="n">fetch</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span> <span class="n">instr</span><span class="p">:</span> <span class="mf">00.010345</span>  <span class="mi">023404</span>  <span class="n">MPYI</span> <span class="mi">4</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span>   <span class="n">reg</span><span class="p">:</span> <span class="mf">00.006500</span>  <span class="mi">000002</span>    <span class="n">A</span> <span class="mi">000014</span><span class="p">,</span> <span class="n">B</span> <span class="mi">001340</span><span class="p">,</span> <span class="n">X</span> <span class="mi">000000</span><span class="p">,</span> <span class="n">M</span> <span class="n">i</span> <span class="n">t</span> <span class="n">r</span> <span class="n">o</span> <span class="n">c</span> <span class="n">CCG</span>
<span class="o">&gt;&gt;</span><span class="n">CPU</span> <span class="n">fetch</span><span class="p">:</span> <span class="mf">00.010347</span>  <span class="mi">020320</span>    <span class="n">instruction</span> <span class="n">fetch</span>
</pre></div>
</div>
<p id="instr">The <span class="html"><samp><b>INSTR</b></samp></span> option traces instruction executions.
Each instruction is printed before it is executed.
The two opcodes of a stack instruction are printed together before the left-hand opcode is executed.
If the right-hand opcode is not <code class="docutils literal notranslate"><span class="pre">NOP</span></code>,
it is reprinted before execution,
with dashes replacing the just-executed left-hand opcode.</p>
<p id="data">The <span class="html"><samp><b>DATA</b></samp></span> option traces reads from and writes to memory.
Each access is classified by the memory bank register that is paired with the specified offset —
DMA, absolute, program, data, or stack.
DMA (channel) accesses derive their bank addresses from the banks specified by Set Bank I/O program orders.
Absolute accesses always use bank 0.
Program, data, and stack accesses use the bank addresses in the <span class="html"><samp class="register">PBANK</samp></span>, <span class="html"><samp class="register">DBANK</samp></span>, and <span class="html"><samp class="register">SBANK</samp></span> registers,
respectively.</p>
<p id="fetch">The <span class="html"><samp><b>FETCH</b></samp></span> option traces instruction fetches from memory.
These accesses are separated from those traced by the <span class="html"><samp><b>DATA</b></samp></span> option because fetches usually are of little interest except when debugging the fetch/execute sequence.
Because the HP 3000 has a two-stage pipeline,
fetches load the NIR (Next Instruction Register) with the instruction after the instruction about to be executed from the CIR (Current Instruction Register).</p>
<p id="reg">The <span class="html"><samp><b>REG</b></samp></span> option traces register values.
Two sets of registers may be printed.
After executing each instruction,
the currently active TOS registers,
the index register,
and the status register are printed.
After executing an instruction that may alter the base registers,
the program,
data,
and stack segment base registers are printed.</p>
<p id="opnd">The <span class="html"><samp><b>OPND</b></samp></span> option traces memory byte operand values.
Some instructions take memory and register operands that are difficult to decode from <span class="html"><samp><b>DATA</b></samp></span> or <span class="html"><samp><b>REG</b></samp></span> traces.
This option presents these operands in a higher-level format.
The memory bank and address values are always those of the operands.
The operand data and values printed are specific to the instruction.
For example, the <span class="html"><samp>ALGN</samp></span> instruction prints its source and target operands,
digit counts,
and fraction counts,
and the <span class="html"><samp>EDIT</samp></span> instruction displays its subprogram operations.</p>
<p id="exec">The <span class="html"><samp><b>EXEC</b></samp></span> option traces the execution of instructions that match user-specified criteria.
When a match occurs,
all CPU trace options are turned on for the duration of the execution of the matched instruction.
The prior trace settings are restored when a match fails.
This option allows detailed tracing of specified instructions while minimizing the log file size compared to a full instruction trace.</p>
<p id="set-cpu-exec">The <span class="html"><samp><b>SET CPU EXEC</b></samp></span> command configures the match and mask values used to qualify instructions for execution tracing.
Qualification is performed by ANDing the current instruction with the specified mask value and then comparing the result with the specified match value.
If the mask value is omitted,
the match value must match the instruction exactly.
The values are entered in the CPU’s data radix,
which defaults to octal but may be set to a different radix or overridden by a switch on the command-line.</p>
<p>Setting the <em>mask</em> value allows matching a range of instructions or an instruction with a range of operand values.
For example,
<span class="html"><samp><b>SET CPU EXEC=020460;177760</b></samp></span> will trace execution of all COBOL-II firmware instructions,
<span class="html"><samp><b>SET CPU EXEC=054000;077000</b></samp></span> will trace execution of FDIV instructions,
and <span class="html"><samp><b>SET CPU EXEC=031000</b></samp></span> will trace execution of PCAL 0 instructions.
To trace a stack instruction,
configure the match for the opcode in the left-hand position only;
this will match the opcode in either position.</p>
<p>The <span class="html"><samp><b>PSERV</b></samp></span> option traces process clock event service entries.
Each trace reports whether the CPU was executing on the Interrupt Control Stack or the user stack when the process clock ticked.
Execution on the ICS implies that the operating system is executing.
As the process clock ticks every millisecond,
enabling <span class="html"><samp><b>PSERV</b></samp></span> tracing can quickly produce a large number of trace lines.</p>
<p>The trace formats are interpreted as follows:</p>
<pre class="literal-block">&gt;&gt;CPU instr: <span class="html"><ins>00</ins>.<ins>010341</ins></span>  <span class="html"><ins>000300</ins></span>  <span class="html"><ins>ZROX,NOP</ins></span>
             │  │       │       │
             │  │       │       └── Instruction mnemonic(s)
             │  │       └────────── Octal data (instruction opcode)
             │  └────────────────── Octal address (<span class="html"><samp class="register">P</samp></span>)
             └───────────────────── Octal bank (<span class="html"><samp class="register">PBANK</samp></span>)

&gt;&gt;CPU instr: 00.001240  000006  external interrupt
&gt;&gt;CPU instr: <span class="html"><ins>00</ins>.<ins>023736</ins></span>  <span class="html"><ins>000000</ins></span>  <span class="html"><ins>unimplemented instruction trap</ins></span>
             │  │       │       │
             │  │       │       └── Interrupt classification
             │  │       └────────── Parameter
             │  └────────────────── Octal address (<span class="html"><samp class="register">P</samp></span>) at interrupt
             └───────────────────── Octal bank (<span class="html"><samp class="register">PBANK</samp></span>) at interrupt

&gt;&gt;CPU  data: 00.002100  123003    data read
&gt;&gt;CPU  data: <span class="html"><ins>00</ins>.<ins>000000</ins></span>  <span class="html"><ins>001340</ins></span>    <span class="html"><ins>absolute read</ins></span>
             │  │       │         │
             │  │       │         └── Memory access classification
             │  │       └──────────── Octal data (memory contents)
             │  └──────────────────── Octal address (effective address)
             └─────────────────────── Octal bank (<span class="html"><samp class="register">PBANK</samp></span>, <span class="html"><samp class="register">DBANK</samp></span>, or <span class="html"><samp class="register">SBANK</samp></span>)

&gt;&gt;CPU fetch: <span class="html"><ins>00</ins>.<ins>010342</ins></span>  <span class="html"><ins>020320</ins></span>    <span class="html"><ins>instruction fetch</ins></span>
             │  │       │         │
             │  │       │         └── Memory access classification
             │  │       └──────────── Octal data (instruction opcode)
             │  └──────────────────── Octal address (<span class="html"><samp class="register">P</samp></span> + 1)
             └─────────────────────── Octal bank (<span class="html"><samp class="register">PBANK</samp></span>)

&gt;&gt;CPU   reg: <span class="html"><ins>00</ins>.<ins>006500</ins></span>  <span class="html"><ins>000002</ins></span>    <span class="html"><ins>A 123003, B 001340, X 000000, M i t r o c CCL</ins></span>
&gt;&gt;CPU   reg: 00.006500  000002    A 123003, B 001340, X 000000, M i t r o c CCL
             │  │       │         │
             │  │       │         └── Register values (0-4 TOS registers, <span class="html"><samp class="register">X</samp></span>, <span class="html"><samp class="register">STA</samp></span>)
             │  │       └──────────── Octal stack register count (<span class="html"><samp class="register">SR</samp></span>)
             │  └──────────────────── Octal stack memory address (<span class="html"><samp class="register">SM</samp></span>)
             └─────────────────────── Octal bank (<span class="html"><samp class="register">SBANK</samp></span>)

&gt;&gt;CPU   reg: <span class="html"><ins>00</ins>.<ins>000000</ins></span>  <span class="html"><ins>000001</ins></span>    PB 010000, PL 025227, DL 001770,
             │  │       │         <span class="html"><ins>DB 002000, Q  006510, Z  007000</ins></span>
             │  │       │         │
             │  │       │         └── Base register values
             │  │       └──────────── Current code segment number (from <span class="html"><samp class="register">STA</samp></span>)
             │  └──────────────────── Zero
             └─────────────────────── Octal bank (<span class="html"><samp class="register">DBANK</samp></span>)

&gt;&gt;CPU  opnd: 00.135771  000000    DFLC '+','!'
&gt;&gt;CPU  opnd: <span class="html"><ins>00</ins>.<ins>045071</ins></span>  <span class="html"><ins>000252</ins></span>    <span class="html"><ins>target fraction 3 length 6,"002222"</ins></span>
             │  │       │         │
             │  │       │         └── Instruction-specific operand value
             │  │       └──────────── Instruction-specific data value
             │  └──────────────────── Octal address (effective address)
             └─────────────────────── Octal bank (<span class="html"><samp class="register">PBANK</samp></span>, <span class="html"><samp class="register">DBANK</samp></span>, or <span class="html"><samp class="register">SBANK</samp></span>)

&gt;&gt;CPU pserv: <span class="html"><ins>Process clock service entered on the ICS</ins></span>
             │
             └── Service entry and stack status</pre>
<p>For <span class="html"><samp><b>OPND</b></samp></span> traces of byte-array operands,
the data values printed are the relative byte addresses.
For <span class="html"><samp>EDIT</samp></span> subprogram operations,
the value of the loop counter is printed.</p>
<p>Enabling CPU tracing can produce a very large number of lines very quickly,
so care should be used to enable tracing only around the area of interest.
Breakpoint actions may be used to implement this;
for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BREAK</span> <span class="mi">100</span><span class="p">;</span> <span class="n">SET</span> <span class="n">CPU</span> <span class="n">DEBUG</span><span class="p">;</span> <span class="n">GO</span>
<span class="n">BREAK</span> <span class="mi">200</span><span class="p">;</span> <span class="n">SET</span> <span class="n">CPU</span> <span class="n">NODEBUG</span><span class="p">;</span> <span class="n">GO</span>
</pre></div>
</div>
<p>These commands will enable tracing when the program counter reaches location 100 and disable tracing when it reaches location 200,
thereby producing a trace of instructions executed between locations 100 and 200.
Alternately,
if the execution of specific instructions is of interest,
the <span class="html"><samp><b>EXEC</b></samp></span> trace option may be used to reduce the debug log file size.</p>
</section>
<section id="registers">
<h4><span class="sectnum">1.3.1.5. </span>Registers<a class="headerlink" href="#registers" title="Permalink to this heading">¶</a></h4>
<p>The CPU state contains the registers visible to the programmer and the interrupt system control registers:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Radix</p></th>
<th class="head"><p>Symbolic</p></th>
<th class="head"><p>Read-only</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp class="register">CIR</samp></span></p></td>
<td><p>16</p></td>
<td><p>–</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>Current instruction register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">NIR</samp></span></p></td>
<td><p>16</p></td>
<td><p>–</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>Next instruction register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp class="register">PB</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Program base register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">P</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Program counter</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp class="register">PL</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Program limit register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">PBANK</samp></span></p></td>
<td><p>4</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Program segment bank register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp class="register">DL</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Data limit register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">DB</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Data base register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp class="register">DBANK</samp></span></p></td>
<td><p>4</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Data segment bank register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">Q</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Stack marker register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp class="register">SM</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Stack memory register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">SR</samp></span></p></td>
<td><p>3</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Stack register counter</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp class="register">Z</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Stack limit register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">SBANK</samp></span></p></td>
<td><p>4</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Stack segment bank register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp class="register">RA</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Top of stack register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">RB</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Top of stack – 1 register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp class="register">RC</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Top of stack – 2 register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">RD</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Top of stack – 3 register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp class="register">X</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Index register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">STA</samp></span></p></td>
<td><p>16</p></td>
<td><p>–</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Status register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp class="register">SWCH</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Switch register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">CPX1</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Run-mode interrupts register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp class="register">CPX2</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Halt-mode interrupts register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp class="register">PCLK</samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Process clock register</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp class="register">CIR</samp></span> and <span class="html"><samp class="register">NIR</samp></span> registers default to CPU instruction mnemonic format,
and the <span class="html"><samp class="register">STA</samp></span> register defaults to CPU status mnemonic format for display and entry but may be overridden with a numeric-format switch,
if desired.
The <span class="html"><samp class="register">RA</samp></span>, <span class="html"><samp class="register">RB</samp></span>, <span class="html"><samp class="register">RC</samp></span>, <span class="html"><samp class="register">RD</samp></span>, <span class="html"><samp class="register">X</samp></span>, and <span class="html"><samp class="register">SWCH</samp></span> registers may be examined or deposited using any of the modes described in the <a class="reference internal" href="#symbolic-display-and-entry">Symbolic display and entry</a> section above.</p>
<p id="mod"><span id="cntr"></span>Two additional,
hidden,
read-only registers may be displayed if mentioned explicitly.
<span class="html"><samp class="register">CNTR</samp></span> represents the hardware counter used by the microcode.
When a <span class="html"><samp>PAUS</samp></span> or <span class="html"><samp>HALT</samp></span> instruction is executed,
the microcode stores the value of the <span class="html"><samp class="register">SR</samp></span> register in the <span class="html"><samp class="register">CNTR</samp></span> register before flushing the TOS registers to memory
(so <span class="html"><samp class="register">SR</samp></span> is always zero after executing either instruction).
The <span class="html"><samp class="register">MOD</samp></span> register holds the module number during an unsolicited module interrupt.
<span class="html"><samp class="register">CNTR</samp></span> and <span class="html"><samp class="register">MOD</samp></span> are provided for the CPU diagnostic and have no other use under simulation.</p>
</section>
</section>
<section id="i-o-processor">
<span id="iop"></span><h3><span class="sectnum">1.3.2. </span>I/O processor<a class="headerlink" href="#i-o-processor" title="Permalink to this heading">¶</a></h3>
<p>The HP 30003B I/O processor works in conjunction with the CPU and multiplexer channel to service the device interfaces.
All I/O interfaces are connected to the IOP bus,
which transfers direct I/O orders to the interfaces and handles memory reads and writes between the interfaces and the CPU stack.
In addition,
it provides the memory interface for multiplexer channel transfers,
as well as fetching I/O program orders from main memory for the channel.</p>
<p>The IOP device has no configuration options.
It does provide tracing,
though,
with selectable filtering by device number,
using these device options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>FILTER=</b><var>list</var></samp></span></p></td>
<td><p>Suppress tracing for device numbers in the list</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NOFILTER</b></samp></span></p></td>
<td><p>Enable tracing for all device numbers; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEBUG=</b><var>option</var></samp></span></p></td>
<td><p>Enable tracing</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NODEBUG</b></samp></span></p></td>
<td><p>Disable tracing; default</p></td>
</tr>
</tbody>
</table>
<p>Enabling IOP tracing can produce a very large number of trace lines very quickly,
so care should be used to enable tracing only around the area of interest.
If only certain devices are of interest,
others may be filtered out of the results by specifying their device numbers in a <span class="html"><samp><b>SET IOP FILTER</b></samp></span> command.
This command takes a list of individual device numbers separated by semicolons and ranges of the form <span class="html"><samp><var>low</var>-<var>high</var></samp></span>.
For example,
<span class="html"><samp><b>SET IOP FILTER=3;7-9</b></samp></span> would exclude lines pertaining to device numbers 3, 7, 8, and 9 from the trace report.</p>
<p>When debug output logging is enabled,
tracing may be configured by specifying one or more of the reporting level options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Reporting level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>DIO</b></samp></span></p></td>
<td><p>Direct I/O orders issued</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>IRQ</b></samp></span></p></td>
<td><p>Interrupt requests received</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DATA</b></samp></span></p></td>
<td><p>Multiplexer channel memory data accesses</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>DIO</b></samp></span> option traces direct I/O orders that are sent to devices.
The <span class="html"><samp><b>IRQ</b></samp></span> option traces interrupt requests received and granted.
The <span class="html"><samp><b>DATA</b></samp></span> option traces memory accesses performed on behalf of the multiplexer channel.
Each access is classified as either an absolute access in memory bank 0 or a DMA access in the memory bank specified by a Set Bank I/O program order.</p>
<p>The trace formats are interpreted as follows:</p>
<pre class="literal-block">&gt;&gt;IOP   dio: <span class="html"><ins>Test I/O order sent to device number 3</ins></span>
             │
             └── I/O order and device number

&gt;&gt;IOP   irq: <span class="html"><ins>Device number 6 acknowledged interrupt request at priority 14</ins></span>
             │
             └── Device number and interrupt priority number

&gt;&gt;IOP  data: 00.001400  040000    dma write
&gt;&gt;IOP  data: <span class="html"><ins>00</ins>.<ins>000030</ins></span>  <span class="html"><ins>001434</ins></span>    <span class="html"><ins>absolute read</ins></span>
             │  │       │         │
             │  │       │         └── Memory access classification
             │  │       └──────────── Octal data (memory contents)
             │  └──────────────────── Octal address
             └─────────────────────── Octal bank number</pre>
<p>The I/O Processor state contains these registers:</p>
<table class="docutils align-default" id="ioa">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Radix</p></th>
<th class="head"><p>Read-only</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>IOA</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td><p>I/O address register</p></td>
</tr>
</tbody>
</table>
</section>
<section id="selector-channel">
<span id="sel"></span><h3><span class="sectnum">1.3.3. </span>Selector channel<a class="headerlink" href="#selector-channel" title="Permalink to this heading">¶</a></h3>
<p>The HP 30030C selector channel provides high-speed data transfer between a device and main memory.
While several interfaces may be connected to the selector channel bus,
only one transfer is active at a time,
and the channel remains dedicated to that interface until the transfer is complete.
The channel contains its own memory port controller,
so transfers to and from memory bypass the I/O processor.</p>
<p>Once started by an SIO instruction,
the channel executes I/O programs independently of the CPU.
Program words are read, and device status is written back,
directly via the port controller.</p>
<p>The <span class="html"><samp><b>SEL</b></samp></span> device has no configuration options.
It does provide tracing,
though,
using these device options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>DEBUG=</b><var>option</var></samp></span></p></td>
<td><p>Enable tracing</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NODEBUG</b></samp></span></p></td>
<td><p>Disable tracing; default</p></td>
</tr>
</tbody>
</table>
<p>When debug output logging is enabled,
tracing may be configured by specifying one or more of the reporting level options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Reporting level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CSRW</b></samp></span></p></td>
<td><p>Channel command initiations and completions</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PIO</b></samp></span></p></td>
<td><p>Programmed I/O orders executed</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>STATE</b></samp></span></p></td>
<td><p>Channel state changes executed</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SR</b></samp></span></p></td>
<td><p>Service requests received</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DATA</b></samp></span></p></td>
<td><p>Channel memory data accesses</p></td>
</tr>
</tbody>
</table>
<p id="state"><span id="pio"></span><span id="csrw"></span>The <span class="html"><samp><b>CSRW</b></samp></span> option traces the beginning and ending of channel programs.
The <span class="html"><samp><b>PIO</b></samp></span> option traces programmed I/O orders that are sent to devices.
The <span class="html"><samp><b>STATE</b></samp></span> option traces the entries into each of the internal channel execution states.
The <span class="html"><samp><b>SR</b></samp></span> option traces service requests received from the device.
The <span class="html"><samp><b>DATA</b></samp></span> option traces memory accesses performed by the port controller.
Each access is classified as either an absolute access in memory bank 0 or a DMA access in the memory bank specified by a Set Bank I/O program order.</p>
<p>The trace formats are interpreted as follows:</p>
<pre class="literal-block">&gt;&gt;SEL  csrw: Device number 4 asserted REQ for channel initialization
&gt;&gt;SEL   pio: Channel loaded IOCW 040000 (Control) from address 102757
&gt;&gt;SEL state: Channel entered the Fetch sequence with 14 clock cycles remaining
&gt;&gt;SEL    sr: <span class="html"><ins>Device number 4 asserted CHANSR</ins></span>
             │
             └── Operational message

&gt;&gt;SEL  data: 00.041746  000000    dma write
&gt;&gt;SEL  data: <span class="html"><ins>00</ins>.<ins>000020</ins></span>  <span class="html"><ins>102757</ins></span>    <span class="html"><ins>absolute read</ins></span>
             │  │       │         │
             │  │       │         └── Memory access classification
             │  │       └──────────── Octal data (memory contents)
             │  └──────────────────── Octal address
             └─────────────────────── Octal bank number</pre>
<p>The selector channel state contains these registers:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Radix</p></th>
<th class="head"><p>Symbolic</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>IDLE</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Channel is inactive</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SREQ</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Channel is requesting service</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVNO</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Device number of the active interface</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>EXCESS</b></samp></span></p></td>
<td><p>32</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Channel cycles used in excess of allocation</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SEQ</b></samp></span></p></td>
<td><p>3</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Current sequencer state</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ORDER</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Current SIO order</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ROLOVR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Word count has rolled over</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PFCNTL</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Control word should be prefetched</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>PFADDR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Address word should be prefetched</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>BANK</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Memory bank</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>WCOUNT</b></samp></span></p></td>
<td><p>12</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Word count</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PCNTR</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>I/O program counter</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CNTL</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>I/O control word</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>CNBUF</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>I/O control word buffer</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ADDR</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>I/O address word</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ADBUF</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>I/O address word buffer</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INBUF</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td><p>Input buffer</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>OUTBUF</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td><p>Output buffer</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>INBUF</b></samp></span> and <span class="html"><samp><b>OUTBUF</b></samp></span> registers may be examined or deposited using any of the modes described in the <a class="reference internal" href="#symbolic-display-and-entry">Symbolic display and entry</a> section above.</p>
</section>
<section id="multiplexer-channel">
<span id="mpx"></span><h3><span class="sectnum">1.3.4. </span>Multiplexer channel<a class="headerlink" href="#multiplexer-channel" title="Permalink to this heading">¶</a></h3>
<p>The HP 30036B multiplexer channel provides high-speed data transfer between from one to sixteen devices and main memory.
Concurrent transfers for multiple devices are multiplexed on a per-word basis,
dependent on the service request priorities assigned to the participating interfaces.
Interfaces must have additional hardware to be channel-capable,
as the channel uses separate control and data signals from those used for direct I/O.
In addition,
the multiplexer and selector channels differ somewhat in their use of the signals,
so interfaces are generally designed for use with one or the other
(the selector channel maintenance board is a notable exception that uses jumpers to indicate which channel to use).</p>
<p>Once started by an SIO instruction,
the channel executes I/O programs independently of the CPU.
Program words are read,
and device status is written back,
by calls to the I/O Processor.</p>
<p>The <span class="html"><samp><b>MPX</b></samp></span> device supports configuration of the device number used for the diagnostic interface and of tracing using these device options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVNO=</b><var>n</var></samp></span></p></td>
<td><p>Set the device number; default is 127</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DEBUG=</b><var>option</var></samp></span></p></td>
<td><p>Enable tracing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>NODEBUG</b></samp></span></p></td>
<td><p>Disable tracing; default</p></td>
</tr>
</tbody>
</table>
<p>When debug output logging is enabled,
tracing may be configured by specifying one or more of the reporting level options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Reporting level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CSRW</b></samp></span></p></td>
<td><p>Channel control, status, read, and write actions</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PIO</b></samp></span></p></td>
<td><p>Programmed I/O commands issued</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>STATE</b></samp></span></p></td>
<td><p>Channel state changes executed</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SR</b></samp></span></p></td>
<td><p>Service requests received</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>IOBUS</b></samp></span></p></td>
<td><p>I/O bus signals and data words received and returned</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>CSRW</b></samp></span> option traces the beginning and ending of channel programs,
as well as control, status, read, and write commands sent to the diagnostic interface.
The <span class="html"><samp><b>PIO</b></samp></span> option traces programmed I/O orders that are sent to devices.
The <span class="html"><samp><b>STATE</b></samp></span> option traces the entries into each of the internal channel execution states.
The <span class="html"><samp class="register">SR</samp></span> option traces service requests received from the devices.
The <span class="html"><samp><b>IOBUS</b></samp></span> option traces the I/O backplane signals and data received and returned via the diagnostic interface.
As the multiplexer channel uses the I/O processor as its interface to main memory,
channel memory access tracing is enabled by the IOP <span class="html"><samp><b>DATA</b></samp></span> trace option.</p>
<p>Examples of the trace formats follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="n">MPX</span>  <span class="n">csrw</span><span class="p">:</span> <span class="n">Device</span> <span class="n">number</span> <span class="mi">65</span> <span class="n">asserted</span> <span class="n">REQ</span> <span class="k">for</span> <span class="n">channel</span> <span class="n">initialization</span>
<span class="o">&gt;&gt;</span><span class="n">MPX</span>  <span class="n">csrw</span><span class="p">:</span> <span class="n">Control</span> <span class="ow">is</span> <span class="n">address</span> <span class="n">RAM</span> <span class="o">|</span> <span class="n">load</span> <span class="n">registers</span> <span class="o">|</span> <span class="n">RAM</span> <span class="n">address</span> <span class="mi">15</span>
<span class="o">&gt;&gt;</span><span class="n">MPX</span>   <span class="n">pio</span><span class="p">:</span> <span class="n">Channel</span> <span class="n">SR</span> <span class="mi">0</span> <span class="n">loaded</span> <span class="n">IOCW</span> <span class="mi">050000</span> <span class="p">(</span><span class="n">Sense</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">address</span> <span class="mi">021207</span>
<span class="o">&gt;&gt;</span><span class="n">MPX</span> <span class="n">state</span><span class="p">:</span> <span class="n">Channel</span> <span class="n">SR</span> <span class="mi">3</span> <span class="n">entered</span> <span class="n">State</span> <span class="n">C</span>
<span class="o">&gt;&gt;</span><span class="n">MPX</span>    <span class="n">sr</span><span class="p">:</span> <span class="n">Device</span> <span class="n">number</span> <span class="mi">65</span> <span class="n">asserted</span> <span class="n">SR0</span>
<span class="o">&gt;&gt;</span><span class="n">MPX</span> <span class="n">iobus</span><span class="p">:</span> <span class="n">Received</span> <span class="n">data</span> <span class="mi">000200</span> <span class="k">with</span> <span class="n">signals</span> <span class="n">DCONTSTB</span>
</pre></div>
</div>
<p>The control, status, read, and write values,
and the I/O bus signals are decoded and presented in symbolic format for easier interpretation.</p>
<p>The multiplexer channel state contains these registers:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Radix</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>IDLE</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Channel is inactive</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>COUNT</b></samp></span></p></td>
<td><p>32</p></td>
<td><p>10</p></td>
<td><p>Count of active transfers</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>EXCESS</b></samp></span></p></td>
<td><p>32</p></td>
<td><p>10</p></td>
<td><p>Channel cycles used in excess of allocation</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>CNTL</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Control word</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>STAT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Status word</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ROLOVR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Word count rollover flip-flop</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVEND</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Device end flip-flop</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>STATR [0:15]</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>2</p></td>
<td><p>State RAM, SR 0-15</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>AUX [0:15]</b></samp></span></p></td>
<td><p>6</p></td>
<td><p>8</p></td>
<td><p>Auxiliary RAM, SR 0-15</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ORDER [0:15]</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>8</p></td>
<td><p>I/O Order RAM, SR 0-15</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CNTR [0:15]</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Counter RAM, SR 0-15</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ADDR [0:15]</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Address RAM, SR 0-15</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="programmed-i-o-device-simulations">
<h2><span class="sectnum">1.4. </span>Programmed I/O device simulations<a class="headerlink" href="#programmed-i-o-device-simulations" title="Permalink to this heading">¶</a></h2>
<p>The CPU controls these I/O device interfaces with direct I/O instructions:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#b-asynchronous-terminal-controller">30032B asynchronous terminal controller</a></p></li>
<li><p><a class="reference internal" href="#a-selector-channel-maintenance-board">30033A selector channel maintenance board</a></p></li>
<li><p><a class="reference internal" href="#a-system-clock">30135A system clock</a></p></li>
</ul>
<section id="b-asynchronous-terminal-controller">
<span id="atc"></span><h3><span class="sectnum">1.4.1. </span>30032B asynchronous terminal controller<a class="headerlink" href="#b-asynchronous-terminal-controller" title="Permalink to this heading">¶</a></h3>
<p>The HP 30032B asynchronous terminal controller is a 16-channel terminal multiplexer used with the HP 3000 CX through Series III systems.
The <span class="html"><samp><b>ATC</b></samp></span> connects from 1 to 16 serial terminals or modems to the HP 3000 at programmable baud rates from 75 to 2400 bits per second.
Character sizes are also programmable from 5 to 12 bits in length,
including the start and stop bits.
Each channel can be independently configured,
including for separate send and receive rates.
The ATC is not buffered,
so the CPU has to retrieve each character from a given channel before the next character arrives.
To avoid saturating the CPU with interrupt requests,
the ATC maintains an internal “mini-interrupt” system that queues requests and holds additional interrupts off until the CPU acknowledges the current request.</p>
<p>The HP 3000CX and Series I use a dedicated serial interface for the system console,
while user terminals are connected to the ATC.
For the Series II and III,
the separate card is eliminated,
and channel 0 of the ATC is reserved for the console.</p>
<p>The ATC consists of two devices:</p>
<ul class="simple">
<li><p><span class="html"><samp><b>ATCD</b></samp></span> — the terminal data interface (<span class="html"><samp>TDI</samp></span>)</p></li>
<li><p><span class="html"><samp><b>ATCC</b></samp></span> — the terminal control interface (<span class="html"><samp>TCI</samp></span>)</p></li>
</ul>
<p>The terminal data interface provides the serial data line connections for terminals and data sets.
Five additional receive-only auxiliary channels may be connected as a group under software control to one of the sixteen main lines to detect the incoming baud rate.
The terminal control interface provides serial control and status lines for Bell 103 data sets.</p>
<section id="terminal-data-interface">
<span id="tdi"></span><span id="atcd"></span><h4><span class="sectnum">1.4.1.1. </span>Terminal data interface<a class="headerlink" href="#terminal-data-interface" title="Permalink to this heading">¶</a></h4>
<p>The <span class="html"><samp>TDI</samp></span> provides the Transmitted Data (BA) and Received Data (BB) lines for up to sixteen terminals.
It performs input and output through Telnet sessions connected to a user-specified port or through individually specified host serial ports.
The <span class="html"><samp>TDI</samp></span> supports concurrent Telnet and serial connections.
The <span class="html"><samp><b>ATTACH</b></samp></span> command specifies the local port to be used for Telnet connections:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ATTACH</span> <span class="n">ATCD</span> <span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>… where <code class="docutils literal notranslate"><span class="pre">port</span></code> is a decimal number between 1 and 65535 that is not being used for other TCP/IP activities.
When the <span class="html"><samp>TDI</samp></span> is attached and the simulator is running,
the multiplexer listens for connections on the specified port and assigns them to channels in ascending numeric order.</p>
<p id="attach">The <span class="html"><samp><b>ATTACH</b></samp></span> command is also used to specify the host serial port for individual <span class="html"><samp>TDI</samp></span> channels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ATTACH {–V} ATCD LINE=&lt;chan&gt;,CONNECT=&lt;name&gt;{;&lt;rate&gt;-&lt;size&gt;&lt;parity&gt;&lt;stopbits&gt;}
</pre></div>
</div>
<p>… where <code class="docutils literal notranslate"><span class="pre">chan</span></code> is the <span class="html"><samp>TDI</samp></span> channel number from 1-15,
and <code class="docutils literal notranslate"><span class="pre">name</span></code> is the host name of the serial port to use
(e.g., <span class="html"><samp>ser0</samp></span> or <span class="html"><samp>COM1</samp></span>).
If the <code class="docutils literal notranslate"><span class="pre">-V</span></code> (verbose) option is included,
a connection confirmation message will be output to the port.</p>
<p>An optional serial port configuration string may be supplied after the host name.
The required values are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rate</span></code> is the baud rate in bits per second.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code> is the character size in bits including the parity bit,
if designated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parity</span></code> designates the parity to use:
<em>N</em> (no), <em>E</em> (even), <em>O</em> (odd), <em>M</em> (mark), or <em>S</em> (space).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stopbits</span></code> is the number of stop bits
(<em>1</em>, <em>1.5</em>, or <em>2</em>).</p></li>
</ul>
<p>Serial connections default to 9600 baud,
8-bit characters,
no parity,
and one stop bit.</p>
<p><span class="html"><samp>TDI</samp></span> configuration options are available for the device and for the individual units.
The command forms are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SET</span> <span class="n">ATCD</span> <span class="o">&lt;</span><span class="n">device</span><span class="o">-</span><span class="n">option</span><span class="o">&gt;</span>
<span class="n">SET</span> <span class="n">ATCDn</span> <span class="o">&lt;</span><span class="n">unit</span><span class="o">-</span><span class="n">option</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Device options that may be specified are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>FASTTIME</b></samp></span></p></td>
<td><p>Use optimized timing; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>REALTIME</b></samp></span></p></td>
<td><p>Use realistic timing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>TERMINAL</b></samp></span></p></td>
<td><p>Connect using Telnet or serial ports; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DIAGNOSTIC</b></samp></span></p></td>
<td><p>Connect using diagnostic test cables</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVNO=</b><var>n</var></samp></span></p></td>
<td><p>Set the device number; default is 7</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INTMASK=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt mask; default is E</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INTPRI=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt priority; default is 0</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DEBUG=</b><var>option</var></samp></span></p></td>
<td><p>Enable tracing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>NODEBUG</b></samp></span></p></td>
<td><p>Disable tracing; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ENABLED</b></samp></span></p></td>
<td><p>Enable the device; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DISABLED</b></samp></span></p></td>
<td><p>Disable the device</p></td>
</tr>
</tbody>
</table>
<p>The TDI supports programmable data transfer rates from 75 to 2400 baud.
When realistic timing is enabled,
the simulation accurately models the transmission and reception baud rates
(in machine instructions).
For example,
a port set for 1200 baud will take twice as long to output a given listing as a port set for 2400 baud.
Optimized timing reduces the timing to the minimum necessary to operate correctly;
this is much faster than the real terminal multiplexer would operate.</p>
<p>The delay time used by the simulation in <a class="reference internal" href="#fasttime"><span class="html"><samp>FASTTIME</samp></span></a> mode may be set via the register interface.
This value may be adjusted as necessary to work around any HP 3000 software problems that are triggered by the abnormally rapid <span class="html"><samp>TDI</samp></span> operation.
Resetting the device with the <span class="html"><samp><b>RESET -P</b></samp></span> (power-on reset) command restores the original optimized time.</p>
<p>Enabling the diagnostic mode simulates the installation of eight HP 30062-60003 diagnostic test (loopback) cables between channels 0-1, 2-3, etc.,
as required by the multiplexer diagnostic.
Each cable connects the Send Data line of one channel to the Receive Data line of the other channel,
and vice versa.
In addition,
all sessions are disconnected,
and the multiplexer is detached from the Telnet listening port.
While in diagnostic mode,
the <span class="html"><samp><b>ATTACH ATCD</b></samp></span> command is not allowed.
Enabling terminal mode allows the multiplexer to be attached to accept incoming connections again.</p>
<p>Unit options that may be specified for individual TDI channels are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>LOCALACK</b></samp></span></p></td>
<td><p>Discard <code class="docutils literal notranslate"><span class="pre">ENQ</span></code> and reply with <code class="docutils literal notranslate"><span class="pre">ACK</span></code> internally; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>REMOTEACK</b></samp></span></p></td>
<td><p>Transmit <code class="docutils literal notranslate"><span class="pre">ENQ</span></code> and receive <code class="docutils literal notranslate"><span class="pre">ACK</span></code> from the remote device</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CAPSLOCK</b></samp></span></p></td>
<td><p>Upshift lowercase input characters to uppercase; default for channel 0</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NOCAPSLOCK</b></samp></span></p></td>
<td><p>Input characters are unchanged; default for channels 1-15</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UC</b></samp></span></p></td>
<td><p>Upshift lowercase output characters to uppercase</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>7B</b></samp></span></p></td>
<td><p>Output with high-order bit cleared; default for channels 1-15</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>7P</b></samp></span></p></td>
<td><p>Output with high-order bit cleared, non-printing suppressed; default for channel 0</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>8B</b></samp></span></p></td>
<td><p>Output characters without changing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>LOG=</b><var>filename</var></samp></span></p></td>
<td><p>Enable output logging</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NOLOG</b></samp></span></p></td>
<td><p>Disable output logging; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DISCONNECT</b></samp></span></p></td>
<td><p>Disconnect the channel</p></td>
</tr>
</tbody>
</table>
<p>Channels that are configured for MPE terminal type 10 expect HP terminals or terminal emulators to be connected and will handshake transfers by sending an <code class="docutils literal notranslate"><span class="pre">ENQ</span></code> and expecting an <code class="docutils literal notranslate"><span class="pre">ACK</span></code> in reply.
A device that does not provide <code class="docutils literal notranslate"><span class="pre">ENQ</span></code>/<code class="docutils literal notranslate"><span class="pre">ACK</span></code> hand-shaking will hang during output.
However,
if <span class="html"><samp><b>LOCALACK</b></samp></span> is specified,
the handshake will take place locally within the simulator.
The <code class="docutils literal notranslate"><span class="pre">ENQ</span></code> will be discarded,
and a locally-generated <code class="docutils literal notranslate"><span class="pre">ACK</span></code> will be returned to the caller.
In addition to enabling the use of non-HP terminals,
this option significantly improves the performance of common HP terminal emulators.
Specifying <span class="html"><samp><b>REMOTEACK</b></samp></span> will pass <code class="docutils literal notranslate"><span class="pre">ENQ</span></code> to the terminal for handling;
this is necessary to avoid output overruns if a real HP terminal is connected to a serial port.</p>
<p>Some HP 3000 programs,
e.g., <span class="html"><samp>SLEUTH</samp></span>,
require command input in uppercase,
although mixed-case output is supported.
As an aid to avoid toggling the host keyboard in and out of <span class="html"><samp>CAPS LOCK</samp></span> mode,
the multiplexer provides this function locally.
The default modes are <span class="html"><samp><b>CAPSLOCK</b></samp></span> for channel 0 (the system console) and <span class="html"><samp><b>NOCAPSLOCK</b></samp></span> for the other channels.</p>
<p>Each channel may be set to one of four output modes (<span class="html"><samp><b>UC</b></samp></span>, <span class="html"><samp><b>7B</b></samp></span>, <span class="html"><samp><b>7P</b></samp></span>, or <span class="html"><samp><b>8B</b></samp></span>).
The default mode is <span class="html"><samp><b>7P</b></samp></span> for channel 0 and <span class="html"><samp><b>7B</b></samp></span> for the other channels.
If the system console is set to MPE terminal type 10,
the mode must be changed to <span class="html"><samp><b>7B</b></samp></span> or <span class="html"><samp><b>8B</b></samp></span> to allow <code class="docutils literal notranslate"><span class="pre">ESC</span></code>, <code class="docutils literal notranslate"><span class="pre">DC1</span></code>, and <code class="docutils literal notranslate"><span class="pre">ENQ</span></code> characters to pass through to the terminal.
Alternatively,
the <span class="html"><samp><b>SET CONSOLE PCHAR</b></samp></span> command may be used to redefine the set of printable characters.
Modes <span class="html"><samp><b>UC</b></samp></span> and <span class="html"><samp><b>7P</b></samp></span> are compatible with terminal types 0-9.</p>
<p>File transfer using the Reflection terminal emulator requires an 8-bit data path.
To achieve this,
the session must use MPE terminal type 12
(this may be configured either during a system reload or by specifying the <span class="html"><samp><b>TERM=12</b></samp></span> parameter when logging on with <span class="html"><samp><b>:HELLO</b></samp></span>),
and the channel must be set to <span class="html"><samp><b>8B</b></samp></span>, <span class="html"><samp><b>REMOTEACK</b></samp></span>, and <span class="html"><samp><b>NOCAPSLOCK</b></samp></span> modes.</p>
<p>Each channel supports independent I/O logging to a file.
Disabling logging also closes the log file.</p>
<p>A channel may be manually disconnected from its associated Telnet session with the <span class="html"><samp><b>SET ATCD</b><var>n</var> <b>DISCONNECT</b></samp></span> command.
Otherwise,
the connection will remain open until disconnected either by the Telnet client or a <span class="html"><samp><b>DETACH ATCD</b></samp></span> command,
unless the channel is controlled by the <span class="html"><samp>TCI</samp></span>.
For a serial connection,
the command will drop and then raise the Data Terminal Ready line;
to disconnect the serial port,
include the <code class="docutils literal notranslate"><span class="pre">-C</span></code> switch in the command.</p>
<p><span class="html"><samp>TDI</samp></span> device configuration may be displayed with the following commands:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW ATCD</b></samp></span></p></td>
<td><p>Display the device and unit configuration</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW ATCD MODES</b></samp></span></p></td>
<td><p>Display the connection modes</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW ATCD CONNECTIONS</b></samp></span></p></td>
<td><p>Display the channel connections</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW ATCD STATISTICS</b></samp></span></p></td>
<td><p>Display the channel I/O statistics</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW ATCD DEVNO</b></samp></span></p></td>
<td><p>Display the device number assignment</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW ATCD INTMASK</b></samp></span></p></td>
<td><p>Display the interrupt mask setting</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW ATCD INTPRI</b></samp></span></p></td>
<td><p>Display the interrupt priority assignment</p></td>
</tr>
</tbody>
</table>
<p><span class="html"><samp>TDI</samp></span> unit configuration may be displayed with the following commands:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW ATCD</b><var>n</var></samp></span></p></td>
<td><p>Display the selected channel configuration</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW ATCD</b><var>n</var> <b>LOG</b></samp></span></p></td>
<td><p>Display the selected channel logging status</p></td>
</tr>
</tbody>
</table>
<p>In addition to the current configuration settings,
a channel controlled by the <span class="html"><samp>TCI</samp></span> will be marked <em>data set</em> in the listing;
a channel not controlled will be marked <em>direct</em>.</p>
<p>When debug output logging is enabled,
tracing may be configured by specifying one or more of the reporting level options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Reporting level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CSRW</b></samp></span></p></td>
<td><p>Interface control, status, read, and write actions</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SERV</b></samp></span></p></td>
<td><p>Line unit service events</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>PSERV</b></samp></span></p></td>
<td><p>Poll unit service events (periodic)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>XFER</b></samp></span></p></td>
<td><p>Data receptions and transmissions</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>IOBUS</b></samp></span></p></td>
<td><p>I/O bus signals and data words received and returned</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>CSRW</b></samp></span> option traces control, status, read, and write commands sent to the interface.
The <span class="html"><samp><b>SERV</b></samp></span> option traces line unit event service scheduling and entries.
The line service is entered to transmit or receive each character at the configured baud rate.
The <span class="html"><samp><b>PSERV</b></samp></span> option traces poll unit event service entries.
The poll service is entered once every 10 milliseconds to poll the Telnet port for connections and input characters to be received by the active channels.
The <span class="html"><samp><b>XFER</b></samp></span> option traces the characters received and transmitted by the active channels.
The <span class="html"><samp><b>IOBUS</b></samp></span> option traces the I/O backplane signals and data received and returned via the interface.</p>
<p>Examples of the trace formats follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="n">ATCD</span>  <span class="n">cmds</span><span class="p">:</span> <span class="n">Status</span> <span class="ow">is</span> <span class="n">DIO</span> <span class="n">OK</span> <span class="o">|</span> <span class="n">complete</span> <span class="o">|</span> <span class="n">send</span>
<span class="o">&gt;&gt;</span><span class="n">ATCD</span>  <span class="n">serv</span><span class="p">:</span> <span class="n">Channel</span> <span class="mi">0</span> <span class="n">delay</span> <span class="mi">1708</span> <span class="n">service</span> <span class="n">scheduled</span>
<span class="o">&gt;&gt;</span><span class="n">ATCD</span> <span class="n">pserv</span><span class="p">:</span> <span class="n">Poll</span> <span class="n">service</span> <span class="n">entered</span>
<span class="o">&gt;&gt;</span><span class="n">ATCD</span>  <span class="n">xfer</span><span class="p">:</span> <span class="n">Channel</span> <span class="mi">0</span> <span class="n">character</span> <span class="s1">&#39;G&#39;</span> <span class="n">sent</span>
<span class="o">&gt;&gt;</span><span class="n">ATCD</span> <span class="n">iobus</span><span class="p">:</span> <span class="n">Received</span> <span class="n">data</span> <span class="mi">000000</span> <span class="k">with</span> <span class="n">signals</span> <span class="n">DREADSTB</span>
</pre></div>
</div>
<p>The Terminal Data Interface state contains these registers:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Radix</p></th>
<th class="head"><p>Symbolic</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CNTL</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Control register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>STAT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Status register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>READ</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td><p>Read register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>WRITE</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td><p>Write register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>FLAG</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Data flag flip-flop</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>MASK</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Interrupt mask flip-flop</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>FTIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast receive/send time</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>RSTAT [0:20]</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Receive channel status, channels 0-20</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>RPARM [0:20]</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Receive channel parameters, channels 0-20</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>RBUFR [0:20]</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td><p>Receive channel buffers, channels 0-20</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SSTAT [0:15]</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Send channel status, channels 0-15</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SPARM [0:15]</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Send channel parameters, channels 0-15</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SBUFR [0:15]</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td><p>Send channel buffers, channels 0-15</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp>READ</samp></span>, <span class="html"><samp>WRITE</samp></span>, <span class="html"><samp>RBUFR</samp></span>, and <span class="html"><samp>SBUFR</samp></span> registers may be examined or deposited using any of the modes described in the <a class="reference internal" href="#symbolic-display-and-entry">Symbolic display and entry</a> section above.</p>
</section>
<section id="terminal-control-interface">
<h4><span class="sectnum">1.4.1.2. </span>Terminal control interface<a class="headerlink" href="#terminal-control-interface" title="Permalink to this heading">¶</a></h4>
<p>The <span class="html"><samp>TCI</samp></span> provides the Request to Send (CA) and Data Terminal Ready (CD) control lines,
and the Data Set Ready (CC) and Carrier Detect (CF) status lines for each of sixteen terminals or data sets.
The modem controls model the Bell 103A data set without ring detection.</p>
<p>Data Terminal Ready must be set to enable a channel to accept an incoming connection.
When a channel connects,
Data Set Ready and Carrier Detect will be set.
Configuring the terminal subtype to 1 in MPE will enable the TCI to establish these settings.
In addition,
aborting a session will drop Data Terminal Ready after the user is logged out,
which will drop the Telnet connection.
If the user drops the Telnet connection manually,
the session will be logged out.
These actions will not occur for channels configured for terminal subtype 0 in MPE,
which does not use the TCI.</p>
<p><span class="html"><samp><b>ATCC</b></samp></span> device options that may be specified are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>TERMINAL</b></samp></span></p></td>
<td><p>Connect using Telnet or serial ports; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DIAGNOSTIC</b></samp></span></p></td>
<td><p>Connect using diagnostic test cables</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVNO=</b><var>n</var></samp></span></p></td>
<td><p>Set the device number; default is 8</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INTMASK=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt mask; default is E</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INTPRI=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt priority; default is 8</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DEBUG=</b><var>option</var></samp></span></p></td>
<td><p>Enable tracing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>NODEBUG</b></samp></span></p></td>
<td><p>Disable tracing; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ENABLED</b></samp></span></p></td>
<td><p>Enable the device; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DISABLED</b></samp></span></p></td>
<td><p>Disable the device</p></td>
</tr>
</tbody>
</table>
<p>Enabling the diagnostic mode simulates the installation of eight HP 30062-60003 diagnostic test (loopback) cables between channels 0-1, 2-3, etc.,
as required by the multiplexer diagnostic.
Each cable connects the Data Terminal Ready and Request to Send lines,
respectively,
of one channel to the Data Set Ready and Carrier Detect lines of the other channel,
and vice versa.
Enabling terminal mode allows the multiplexer to respond to incoming connections again.</p>
<p>There are no TCI units or unit commands.</p>
<p>TCI device configuration may be displayed with the following commands:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW ATCC</b></samp></span></p></td>
<td><p>Display the device configuration</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW ATCC MODE</b></samp></span></p></td>
<td><p>Display the connection mode</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW ATCC DEVNO</b></samp></span></p></td>
<td><p>Display the device number assignment</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW ATCC INTMASK</b></samp></span></p></td>
<td><p>Display the interrupt mask setting</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW ATCC INTPRI</b></samp></span></p></td>
<td><p>Display the interrupt priority assignment</p></td>
</tr>
</tbody>
</table>
<p>When debug output logging is enabled,
tracing may be configured by specifying one or more of the reporting level options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Reporting level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CSRW</b></samp></span></p></td>
<td><p>Interface control, status, read, and write actions</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PSERV</b></samp></span></p></td>
<td><p>Poll unit service events (periodic)</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>XFER</b></samp></span></p></td>
<td><p>Control and status line changes</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>IOBUS</b></samp></span></p></td>
<td><p>I/O bus signals and data words received and returned</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>CSRW</b></samp></span> option traces control, status, read, and write commands sent to the interface.
The <span class="html"><samp><b>PSERV</b></samp></span> option traces poll unit event service entries.
The poll service is entered once every 10 milliseconds to poll the channels for changes in the control or status lines.
The <span class="html"><samp><b>XFER</b></samp></span> option traces the changes in control and status lines by the active channels.
The <span class="html"><samp><b>IOBUS</b></samp></span> option traces the I/O backplane signals and data received and returned via the interface.</p>
<p>Examples of the trace formats follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="n">ATCC</span>  <span class="n">csrw</span><span class="p">:</span> <span class="n">Channel</span> <span class="mi">2</span> <span class="n">control</span> <span class="ow">is</span> <span class="n">C2</span> <span class="o">|</span> <span class="n">C1</span> <span class="o">|</span> <span class="o">~</span><span class="n">S2</span> <span class="o">|</span> <span class="o">~</span><span class="n">S1</span>
<span class="o">&gt;&gt;</span><span class="n">ATCC</span> <span class="n">pserv</span><span class="p">:</span> <span class="n">Poll</span> <span class="n">service</span> <span class="n">entered</span>
<span class="o">&gt;&gt;</span><span class="n">ATCC</span>  <span class="n">xfer</span><span class="p">:</span> <span class="n">Channel</span> <span class="mi">2</span> <span class="n">line</span> <span class="n">status</span> <span class="ow">is</span> <span class="n">RTS</span> <span class="o">|</span> <span class="n">DTR</span>
<span class="o">&gt;&gt;</span><span class="n">ATCC</span> <span class="n">iobus</span><span class="p">:</span> <span class="n">Received</span> <span class="n">data</span> <span class="mi">031374</span> <span class="k">with</span> <span class="n">signals</span> <span class="n">DCONTSTB</span>
</pre></div>
</div>
<p>The Terminal Control Interface state contains these registers:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Radix</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CNTL</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Control register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>STAT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Status register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CNTR</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>10</p></td>
<td><p>Channel counter</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SCAN</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Scan flip-flop</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>MASK</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Interrupt mask flip-flop</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>C2 [0:15]</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Control line 2, channels 0-15</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>C1 [0:15]</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Control line 1, channels 0-15</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>S2 [0:15]</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Status line 2, channels 0-15</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>S1 [0:15]</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Status line 1, channels 0-15</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ES2 [0:15]</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Enable status line 2 interrupt, channels 0-15</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ES1 [0:15]</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Enable status line 1 interrupt, channels 0-15</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>MS2 [0:15]</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Status line 2 match, channels 0-15</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>MS1 [0:15]</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Status line 1 match, channels 0-15</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="a-selector-channel-maintenance-board">
<span id="scmb2"></span><span id="scmb1"></span><span id="scmb"></span><h3><span class="sectnum">1.4.2. </span>30033A selector channel maintenance board<a class="headerlink" href="#a-selector-channel-maintenance-board" title="Permalink to this heading">¶</a></h3>
<p>The HP 30033A selector channel maintenance board provides the circuitry necessary to test the I/O bus signals driven and received by the selector and multiplexer channels.
Used with the stand-alone selector channel and multiplexer channel diagnostics,
the SCMB is used to verify that the correct bus signals are driven in response to each of the programmed I/O orders,
and that the channel responds correctly to the signals returned to it.
The SCMB functions as a programmable interface that can log incoming signals and drive the outgoing signals,
as well as simulate a number of interface hardware faults.
Two SCMBs are provided;
they are named <span class="html"><samp><b>SCMB1</b></samp></span> and <span class="html"><samp><b>SCMB2</b></samp></span>.</p>
<p>Both SCMBs are normally disabled,
as they are used only with the standalone diagnostics.
The CPU and selector channel diagnostics both use one SCMB.
If <span class="html"><samp><b>SCMB1</b></samp></span> is used,
it may be referred to as SCMB if desired.
The multiplexer channel diagnostic uses both SCMBs.</p>
<p>Device options that may be specified for the two SCMBs are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SC</b></samp></span></p></td>
<td><p>Connect the SCMB to the Selector Channel bus</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>MX</b></samp></span></p></td>
<td><p>Connect the SCMB to the Multiplexer Channel bus; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVNO=</b><var>n</var></samp></span></p></td>
<td><p>Set the device number; defaults are 65 and 66</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INTPRI=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt priority; defaults are 10 and 11</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SRNO=</b><var>n</var></samp></span></p></td>
<td><p>Set the service request number; defaults are 0 and 1</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DEBUG=</b><var>option</var></samp></span></p></td>
<td><p>Enable tracing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>NODEBUG</b></samp></span></p></td>
<td><p>Disable tracing; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ENABLED</b></samp></span></p></td>
<td><p>Enable device</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DISABLED</b></samp></span></p></td>
<td><p>Disable device; default</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>SC</b></samp></span> option installs the SCMB on the selector channel bus and configures operation for the selector channel diagnostic.
The <span class="html"><samp><b>MX</b></samp></span> option installs the SCMB on the multiplexer channel bus and configures operation for the multiplexer channel and CPU diagnostics.
The <span class="html"><samp><b>SRNO</b></samp></span> value may be changed only when the SCMB is connected to the multiplexer channel bus.</p>
<p>When debug output logging is enabled,
tracing may be configured by specifying one or more of the reporting level options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Reporting level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CSRW</b></samp></span></p></td>
<td><p>Interface control, status, read, and write actions</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>XFER</b></samp></span></p></td>
<td><p>Data read and write transfers</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SERV</b></samp></span></p></td>
<td><p>SR delay service events</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>IOBUS</b></samp></span></p></td>
<td><p>I/O bus signals and data words received and returned</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>CSRW</b></samp></span> option traces control, status, read, and write commands sent to the interface.
The <span class="html"><samp><b>XFER</b></samp></span> option traces data words transferred to and from the interface by the channel.
The <span class="html"><samp><b>SERV</b></samp></span> option traces event service scheduling and entries used to schedule delays in the service requests to the channel.
The <span class="html"><samp><b>IOBUS</b></samp></span> option traces the I/O backplane signals and data received and returned via the interface.</p>
<p>Examples of the trace formats follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="n">SCMB1</span>  <span class="n">csrw</span><span class="p">:</span> <span class="n">Control</span> <span class="ow">is</span> <span class="n">device</span> <span class="n">end</span> <span class="o">|</span> <span class="n">load</span> <span class="n">control</span> <span class="n">IOAW</span> <span class="o">|</span> <span class="n">count</span> <span class="n">nothing</span>
<span class="o">&gt;&gt;</span><span class="n">SCMB1</span>  <span class="n">xfer</span><span class="p">:</span> <span class="n">Counter</span><span class="o">/</span><span class="n">buffer</span> <span class="n">value</span> <span class="mi">022222</span> <span class="n">read</span>
<span class="o">&gt;&gt;</span><span class="n">SCMB1</span>  <span class="n">serv</span><span class="p">:</span> <span class="n">Delay</span> <span class="mi">2</span> <span class="n">SR</span> <span class="n">service</span> <span class="n">scheduled</span>
<span class="o">&gt;&gt;</span><span class="n">SCMB1</span> <span class="n">iobus</span><span class="p">:</span> <span class="n">Received</span> <span class="n">data</span> <span class="mi">000000</span> <span class="k">with</span> <span class="n">signals</span> <span class="n">ACKSR</span> <span class="o">|</span> <span class="n">PCONTSTB</span> <span class="o">|</span> <span class="n">CHANSO</span>
</pre></div>
</div>
<p>The SCMB state contains these registers:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Radix</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CNTL</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Control register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>STAT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Status register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CNTR</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Counter/buffer register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SIOBSY</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>SIO is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CHANSR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Channel service request is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DEVSR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Device service request is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INXFR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Input transfer is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>OUTXFR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Output transfer is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>JMPMET</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Jump condition is met</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>XFRERR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Transfer error condition is present</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>EOT</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>End of transfer condition is present</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>TRMCNT</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Terminal count condition is present</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>MISCMP</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Miscompare condition is present</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DEVEND</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Device end condition is present</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>STOP</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Transfer has been stopped</p></td>
</tr>
</tbody>
</table>
</section>
<section id="a-system-clock">
<span id="clk"></span><h3><span class="sectnum">1.4.3. </span>30135A system clock<a class="headerlink" href="#a-system-clock" title="Permalink to this heading">¶</a></h3>
<p>The HP 30135A system clock is used with Series II and III systems and provides a programmable interval clock employed as the MPE time-of-day and process-switching clock.
The clock provides programmable periods of 10 microseconds to 10 seconds in decade increments.
Each “tick” of the clock increments a presettable counter that may be compared to a selected limit value.
The clock may request an interrupt when the values are equal,
and a status indication is provided if the counter reaches the limit a second time without acknowledgement.</p>
<p>CLK device options that may be specified are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CALTIME</b></samp></span></p></td>
<td><p>Use calibrated timing; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>REALTIME</b></samp></span></p></td>
<td><p>Use realistic timing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVNO=</b><var>n</var></samp></span></p></td>
<td><p>Set the device number; default is 3</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INTPRI=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt priority; default is 1</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEBUG=</b><var>option</var></samp></span></p></td>
<td><p>Enable tracing</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NODEBUG</b></samp></span></p></td>
<td><p>Disable tracing; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ENABLED</b></samp></span></p></td>
<td><p>Enable the device; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DISABLED</b></samp></span></p></td>
<td><p>Disable the device</p></td>
</tr>
</tbody>
</table>
<p>Calibrated timing aligns the simulated clock periods with the clock on the host system.
When calibrated,
each of the programmable periods will elapse after the corresponding amount of host-system time.</p>
<p>When realistic timing is enabled,
the simulation models the programmable periods in terms of machine instructions executed.
Calibrated timing is required to enable idling.
Realistic timing is necessary to pass the hardware diagnostics.</p>
<p>When debug output logging is enabled,
tracing may be configured by specifying one or more of the reporting level options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Reporting level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CSRW</b></samp></span></p></td>
<td><p>Interface control, status, read, and write actions</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PSERV</b></samp></span></p></td>
<td><p>Clock unit service events (periodic)</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>IOBUS</b></samp></span></p></td>
<td><p>I/O bus signals and data words received and returned</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>CSRW</b></samp></span> option traces control, status, read, and write commands sent to the interface.
The <span class="html"><samp><b>PSERV</b></samp></span> option traces event service scheduling and entries,
which occur at a periodic rate dependent on the programmable configuration.
The <span class="html"><samp><b>IOBUS</b></samp></span> option traces the I/O backplane signals and data received and returned via the interface.</p>
<p>Examples of the trace formats follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="n">CLK</span>  <span class="n">csrw</span><span class="p">:</span> <span class="n">Control</span> <span class="ow">is</span> <span class="n">load</span> <span class="n">rate</span> <span class="o">|</span> <span class="n">select</span> <span class="n">limit</span> <span class="o">|</span> <span class="mi">1</span> <span class="n">millisecond</span> <span class="n">rate</span>
<span class="o">&gt;&gt;</span><span class="n">CLK</span>  <span class="n">csrw</span><span class="p">:</span> <span class="n">Status</span> <span class="ow">is</span> <span class="n">DIO</span> <span class="n">OK</span> <span class="o">|</span> <span class="n">LR</span> <span class="o">=</span> <span class="n">CR</span> <span class="o">|</span> <span class="n">limit</span> <span class="n">selected</span> <span class="o">|</span> <span class="mi">1</span> <span class="n">millisecond</span> <span class="n">rate</span>
<span class="o">&gt;&gt;</span><span class="n">CLK</span> <span class="n">pserv</span><span class="p">:</span> <span class="n">Service</span> <span class="n">entered</span> <span class="k">with</span> <span class="n">counter</span> <span class="mi">0</span> <span class="n">increment</span> <span class="mi">1</span> <span class="n">limit</span> <span class="mi">1</span>
<span class="o">&gt;&gt;</span><span class="n">CLK</span> <span class="n">pserv</span><span class="p">:</span> <span class="n">Rate</span> <span class="mi">1</span> <span class="n">millisecond</span> <span class="n">delay</span> <span class="mi">389</span> <span class="n">service</span> <span class="n">rescheduled</span>
<span class="o">&gt;&gt;</span><span class="n">CLK</span> <span class="n">iobus</span><span class="p">:</span> <span class="n">Received</span> <span class="n">data</span> <span class="mi">000000</span> <span class="k">with</span> <span class="n">signals</span> <span class="n">DSETINT</span>
<span class="o">&gt;&gt;</span><span class="n">CLK</span> <span class="n">iobus</span><span class="p">:</span> <span class="n">Returned</span> <span class="n">data</span> <span class="mi">000000</span> <span class="k">with</span> <span class="n">signals</span> <span class="n">INTREQ</span>
</pre></div>
</div>
<p>The system clock state contains these registers:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Radix</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CNTL</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Control register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>STAT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Status register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>COUNT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Count register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>LIMIT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>Limit register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>RATE</b></samp></span></p></td>
<td><p>3</p></td>
<td><p>8</p></td>
<td><p>Clock rate register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SYSIRQ</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>System interrupt request flip-flop</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>LIMIRQ</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Count = Limit interrupt request flip-flop</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>OVFIRQ</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>Count = Limit overflow interrupt request flip-flop</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="selector-channel-i-o-device-simulations">
<h2><span class="sectnum">1.5. </span>Selector channel I/O device simulations<a class="headerlink" href="#selector-channel-i-o-device-simulations" title="Permalink to this heading">¶</a></h2>
<p>The Selector Channel controls these I/O device interfaces:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#b-disc-interface">30229B disc interface</a></p></li>
</ul>
<section id="b-disc-interface-with-eight-7905-7906-7920-7925-drives">
<span id="b-disc-interface"></span><span id="ds"></span><h3><span class="sectnum">1.5.1. </span>30229B disc interface with eight 7905/7906/7920/7925 drives<a class="headerlink" href="#b-disc-interface-with-eight-7905-7906-7920-7925-drives" title="Permalink to this heading">¶</a></h3>
<p>The HP 30129A cartridge disc subsystem connects the 7905A, 7906A, 7920A, and 7925A disc drives to the HP 3000.
The subsystem consists of a 30229B cartridge disc interface,
a 13037D multiple-access disc controller (“MAC”),
and from one to eight MAC drives.
The subsystem uses the selector channel to achieve a 937.5 KB/second transfer rate to the CPU.</p>
<p>The disc controller connects from one to eight HP 7905 (15 MB),
7906 (20 MB),
7920 (50 MB),
or 7925 (120 MB) disc drives to interfaces installed in from one to eight CPUs.
The drives use a common command set and present data to the controller synchronously at a 468.75 kiloword per second (2.133 microseconds per word)
data rate.</p>
<p>The disc interface is used to connect the HP 3000 CPU to the 13037’s device controller.
While the controller supports multiple-CPU systems,
the HP 3000 does not use this capability.</p>
<p>The simulation provides up to eight disc drives.
Drive types may be intermixed;
7905s are selected by default.
Attaching a disc image file to a unit simulates inserting a disc pack into a drive:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ATTACH</span> <span class="p">{</span><span class="o">-</span><span class="n">R</span><span class="p">}</span> <span class="n">DSn</span> <span class="o">&lt;</span><span class="n">image</span><span class="o">-</span><span class="n">filename</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Adding the <code class="docutils literal notranslate"><span class="pre">-R</span></code> (read-only) switch is equivalent to setting the drive’s disc protect switch on.</p>
<p>If the host operating system returns an error when seeking, reading, or writing a disc image file,
the simulator will report the error to the simulation console, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HP</span> <span class="mi">3000</span> <span class="n">simulator</span> <span class="n">disc</span> <span class="n">library</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">error</span><span class="p">:</span> <span class="n">No</span> <span class="n">space</span> <span class="n">left</span> <span class="n">on</span> <span class="n">device</span>
</pre></div>
</div>
<p>A simulated disc seek will fail with status 2 error (drive fault) status,
and the drive’s heads will unload.
Reloading the heads will clear the drive fault.
A simulated disc read or write will fail with uncorrectable data error status.
The target operating system will then react to this error as though a real drive had encountered a bad disc sector.</p>
<p>A drive’s unit number is not set explicitly.
Instead,
the drive unit number is derived from the simulation unit number.
For example,
unit <span class="html"><samp>DS0</samp></span> responds to disc unit select number 0.
Changing the unit select switch on a mounted drive is equivalent to detaching and reattaching the disc image file to the corresponding simulation unit.</p>
<p>Device and unit options include configuring the timing, drive type, protection and format status,
and the ability to set drives ready or not-ready.
The command forms are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SET</span> <span class="n">DS</span> <span class="o">&lt;</span><span class="n">device</span><span class="o">-</span><span class="n">option</span><span class="o">&gt;</span>
<span class="n">SET</span> <span class="n">DSn</span> <span class="o">&lt;</span><span class="n">unit</span><span class="o">-</span><span class="n">option</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="device-options">
<h4><span class="sectnum">1.5.1.1. </span>Device options<a class="headerlink" href="#device-options" title="Permalink to this heading">¶</a></h4>
<p>Device options that may be specified are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>FASTTIME</b></samp></span></p></td>
<td><p>Use optimized timing; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>REALTIME</b></samp></span></p></td>
<td><p>Use realistic timing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DIAGNOSTIC</b></samp></span></p></td>
<td><p>Reset the diagnostic override table</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DIAGNOSTIC=</b><var>params</var></samp></span></p></td>
<td><p>Add an entry to the diagnostic override table</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>NODIAGNOSTIC</b></samp></span></p></td>
<td><p>Clear the diagnostic override table; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DEVNO=</b><var>n</var></samp></span></p></td>
<td><p>Set the device number; default is 4</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INTMASK=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt mask; default is E</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INTPRI=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt priority; default is 4</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEBUG=</b><var>option</var></samp></span></p></td>
<td><p>Enable tracing</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NODEBUG</b></samp></span></p></td>
<td><p>Disable tracing; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ENABLED</b></samp></span></p></td>
<td><p>Enable the device; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DISABLED</b></samp></span></p></td>
<td><p>Disable the device</p></td>
</tr>
</tbody>
</table>
<p>Device configuration may be displayed with the following commands:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW DS</b></samp></span></p></td>
<td><p>Display the device and unit configuration</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW DS DIAGNOSTIC</b></samp></span></p></td>
<td><p>Display the diagnostic override table</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW DS TIMING</b></samp></span></p></td>
<td><p>Display the timing mode</p></td>
</tr>
</tbody>
</table>
<p>When realistic timing is enabled,
the simulation accurately models the disc movement times
(in machine instructions).
For example,
seeking takes longer if the positioner movement distance is farther.
Optimized timing reduces the timing to the minimum necessary to operate correctly;
this is much faster than a real disc drive would operate.</p>
<p>The delay times used by the simulation in <a class="reference internal" href="#fasttime"><span class="html"><samp>FASTTIME</samp></span></a> mode may be set via the register interface.
The values may be adjusted as necessary to work around any HP 3000 software problems that are triggered by the abnormally rapid disc operation.
Resetting the device with the <span class="html"><samp><b>RESET -P</b></samp></span> (power-on reset) command restores the original optimized times.</p>
<p>The <span class="html"><samp><b>SET DS DIAGNOSTIC</b></samp></span> and <span class="html"><samp><b>SET DS NODIAGNOSTIC</b></samp></span> commands provide diagnostic support.
See the <a class="reference internal" href="#diagnostic-support">Diagnostic support</a> section below for details.</p>
</section>
<section id="unit-options">
<h4><span class="sectnum">1.5.1.2. </span>Unit options<a class="headerlink" href="#unit-options" title="Permalink to this heading">¶</a></h4>
<p>Unit options that may be specified for individual disc drives are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>7905</b></samp></span></p></td>
<td><p>Set the drive type to 7905; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>7906</b></samp></span></p></td>
<td><p>Set the drive type to 7906</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>7920</b></samp></span></p></td>
<td><p>Set the drive type to 7920</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>7925</b></samp></span></p></td>
<td><p>Set the drive type to 7925</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UNLOAD</b></samp></span></p></td>
<td><p>Set the drive’s run/stop switch to <em>Stop</em>; default when detached</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>LOAD</b></samp></span></p></td>
<td><p>Set the drive’s run/stop switch to <em>Run</em>; default when attached</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>PROTECT</b></samp></span></p></td>
<td><p>Set the 7920’s or 7925’s read-only switch to <em>On</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PROTECT=UPPER</b></samp></span></p></td>
<td><p>Set the 7905’s or 7906’s protect upper disc switch to <em>On</em></p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>PROTECT=LOWER</b></samp></span></p></td>
<td><p>Set the 7905’s or 7906’s protect lower disc switch to <em>On</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>UNPROTECT</b></samp></span></p></td>
<td><p>Set the 7920’s or 7925’s read-only switch to <em>Off</em></p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UNPROTECT=UPPER</b></samp></span></p></td>
<td><p>Set the 7905’s or 7906’s protect upper disc switch to <em>Off</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>UNPROTECT=LOWER</b></samp></span></p></td>
<td><p>Set the 7905’s or 7906’s protect lower disc switch to <em>Off</em></p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>FORMAT</b></samp></span></p></td>
<td><p>Set the drive’s format switch to <em>Enabled</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NOFORMAT</b></samp></span></p></td>
<td><p>Set the drive’s format switch to <em>Disabled</em>; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ENABLED</b></samp></span></p></td>
<td><p>Enable the unit; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DISABLED</b></samp></span></p></td>
<td><p>Disable the unit</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>UNLOAD</b></samp></span> and <span class="html"><samp><b>LOAD</b></samp></span> options unload and load the drive’s heads from the disc pack,
setting the drive not-ready and ready,
respectively.
The former provides a convenient method of setting a drive “down” without detaching the associated disc image file.</p>
<p><span class="html"><samp><b>PROTECT=UPPER</b></samp></span> and <span class="html"><samp><b>PROTECT=LOWER</b></samp></span> protect the upper and lower platters,
respectively,
of 7905 and 7906 drives from writing;
<span class="html"><samp><b>PROTECT</b></samp></span> without a value protects both platters.
For the 7920 and 7925 drives,
<span class="html"><samp><b>PROTECT</b></samp></span> protects the entire drive.
The <span class="html"><samp><b>UNPROTECT</b></samp></span> options remove drive protection and enable writing.</p>
<p>The <span class="html"><samp><b>FORMAT</b></samp></span> option enables certain controller commands,
such as initialize,
that alter the sector address fields.
Typically,
this option is needed when reloading the operating system from tape to disc.
The <span class="html"><samp><b>NOFORMAT</b></samp></span> option inhibits these commands and permits only the standard write command,
subject to the appropriate drive protection status.</p>
<p>Drive configuration may be displayed with the following command:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW DS</b><var>n</var></samp></span></p></td>
<td><p>Display the selected drive’s configuration</p></td>
</tr>
</tbody>
</table>
</section>
<section id="diagnostic-support">
<h4><span class="sectnum">1.5.1.3. </span>Diagnostic support<a class="headerlink" href="#diagnostic-support" title="Permalink to this heading">¶</a></h4>
<p>The offline disc diagnostic (program D419A) tests features of the disc that are not supported in simulation,
e.g., the detection and correction of sector data errors.
However, the simulation does support recovery from host file system errors,
which are mapped to uncorrectable data errors.
Because file system errors cannot be generated intentionally,
a table of diagnostic overrides is provided to return specified error status values instead of otherwise normal completion status.
This allows the error recovery simulation code to be tested.</p>
<p>The initially empty diagnostic override table may be populated with one or more entries using this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SET</span> <span class="n">DS</span> <span class="n">DIAGNOSTIC</span><span class="o">=&lt;</span><span class="n">cylinder</span><span class="o">&gt;</span><span class="p">;</span><span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span><span class="p">;</span><span class="o">&lt;</span><span class="n">sector</span><span class="o">&gt;</span><span class="p">;</span><span class="o">&lt;</span><span class="n">opcode</span><span class="o">&gt;</span><span class="p">;</span><span class="o">&lt;</span><span class="n">SPD</span><span class="o">&gt;</span><span class="p">;</span><span class="o">&lt;</span><span class="n">status</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>… where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cylinder</span></code> is a decimal value from 0 to 822.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">head</span></code> is a decimal value from 0 to 8.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sector</span></code> is a decimal value from 0 to 63.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opcode</span></code> is an octal value from 0 to 26.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SPD</span></code> is any combination of the letters S, P, and D.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> is an octal value from 0 to 37.</p></li>
</ul>
<p>If a command specifies the opcode value as 15 (Request Syndrome) and the status value as 17 (Correctable Data Error),
then four additional values must be appended to the command-line above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">;</span><span class="o">&lt;</span><span class="n">displacement</span><span class="o">&gt;</span><span class="p">;</span><span class="o">&lt;</span><span class="n">syndrome</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">;</span><span class="o">&lt;</span><span class="n">syndrome</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">;</span><span class="o">&lt;</span><span class="n">syndrome</span> <span class="mi">3</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>… where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">displacement</span></code> is a decimal value from -5 to 135.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">syndrome</span></code> 1-3 are octal values from 0 to 177777.</p></li>
</ul>
<p>When the table is populated,
the first entry becomes the initial “current” entry.
As the diagnostic program issues each disc controller command,
the cylinder, head, sector, and command opcode values from the current override entry are checked against the corresponding current controller values.
If the values match,
then the controller status and Spare/Protected/Defective values are set from the entry rather than being generated by the command,
and the next entry becomes the current entry.
These values will then be returned to the program as the completion status of the current command.
This process continues until the table is exhausted or the program ends.
The current entry may be reset to the first entry by specifying the <span class="html"><samp><b>SET DS DIAGNOSTIC</b></samp></span> command with no parameters.
Entering the <span class="html"><samp><b>SET DS NODIAGNOSTIC</b></samp></span> command will clear the table.</p>
<p>If the disc controller command performs address verification,
then any SPD/status value(s) provided will be used as the result of the verification.
In particular,
setting the P bit for a Write command will cause a Protected Track error if the drive’s Format switch is set to <em>Disabled</em>,
and any status value other than Normal Completion,
Correctable Data Error,
or Uncorrectable Data Error will cause a verification abort.</p>
<p>In hardware,
the errors that may occur during verification are Cylinder Miscompare,
Head-Sector Miscompare,
Sync Timeout,
Illegal Spare Access,
and Defective Track;
any of these errors may be simulated.
In addition,
an Uncorrectable Data Error will occur in hardware if the controller is unable to verify any of the 16 sectors starting at the sector preceding the target sector,
but this error cannot be simulated.
Instead, specifying either a Correctable Data Error or an Uncorrectable Data Error will cause an abort at the end of the first sector of a Read, Write, or Verify command.</p>
<p>Correctable Data Error and Uncorrectable Data Error may also be specified for the Request Syndrome command.
The former requires the values to be returned for the displacement and three syndrome words;
the latter does not,
as the values are meaningless if the error cannot be corrected.</p>
</section>
<section id="boot-command">
<span id="boot"></span><h4><span class="sectnum">1.5.1.4. </span><span class="html"><samp><b>BOOT</b></samp></span> command<a class="headerlink" href="#boot-command" title="Permalink to this heading">¶</a></h4>
<p>The interface supports the <span class="html"><samp><b>BOOT</b></samp></span> command as an alternative to <span class="html"><samp><b>LOAD</b></samp></span>.
The <span class="html"><samp><b>BOOT DS0</b></samp></span> command is equivalent in hardware to setting the <span class="html"><samp class="register">SWCH</samp></span> register to configure the control byte and device number,
and pressing the <span class="html"><samp class="guilabel">LOAD</samp></span> and <span class="html"><samp class="guilabel">ENABLE</samp></span> buttons to begin the cold load process for unit 0.
The <span class="html"><samp class="register">SWCH</samp></span> register is set as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>0</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
<th class="head"><p>9</p></th>
<th class="head"><p>10</p></th>
<th class="head"><p>11</p></th>
<th class="head"><p>12</p></th>
<th class="head"><p>13</p></th>
<th class="head"><p>14</p></th>
<th class="head"><p>15</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td colspan="8"><p>DS device number</p></td>
</tr>
</tbody>
</table>
<p>The control byte defaults to the Cold Load Read disc command.</p>
</section>
<section id="tracing-and-registers">
<h4><span class="sectnum">1.5.1.5. </span>Tracing and registers<a class="headerlink" href="#tracing-and-registers" title="Permalink to this heading">¶</a></h4>
<p>When debug output logging is enabled,
tracing may be configured by specifying one or more of the reporting level options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Reporting level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CMD</b></samp></span></p></td>
<td><p>Controller commands executed</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INCO</b></samp></span></p></td>
<td><p>Controller command initiations and completions</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CSRW</b></samp></span></p></td>
<td><p>Interface control, status, read, and write actions</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>STATE</b></samp></span></p></td>
<td><p>Controller command state changes executed</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SERV</b></samp></span></p></td>
<td><p>Disc unit service events</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>XFER</b></samp></span></p></td>
<td><p>Data reads and writes</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>IOBUS</b></samp></span></p></td>
<td><p>I/O bus signals and data words received and returned</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>CMD</b></samp></span> option traces the commands executed by the disc controller.
The <span class="html"><samp><b>INCO</b></samp></span> option traces the beginning and ending of commands,
including command termination status.
The <span class="html"><samp><b>CSRW</b></samp></span> option traces control, status, read, and write commands sent to the interface.
The <span class="html"><samp><b>STATE</b></samp></span> option traces the entries into each of the internal controller execution states.
The <span class="html"><samp><b>SERV</b></samp></span> option traces disc unit event service scheduling and entries.
The <span class="html"><samp><b>XFER</b></samp></span> option traces the data words read from or written to the disc.
The <span class="html"><samp><b>IOBUS</b></samp></span> option traces the signals and data received and returned via the I/O backplane and interface and via the data, flag, and function buses between the interface and controller.</p>
<p>Examples of the trace formats follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="n">DS</span>    <span class="n">cmd</span><span class="p">:</span> <span class="n">Unit</span> <span class="mi">0</span> <span class="n">Seek</span> <span class="n">to</span> <span class="n">cylinder</span> <span class="mi">410</span> <span class="n">head</span> <span class="mi">2</span> <span class="n">sector</span> <span class="mi">47</span>
<span class="o">&gt;&gt;</span><span class="n">DS</span>   <span class="n">inco</span><span class="p">:</span> <span class="n">Unit</span> <span class="mi">0</span> <span class="n">Seek</span> <span class="n">command</span> <span class="n">completed</span> <span class="k">with</span> <span class="n">Normal</span> <span class="n">Completion</span> <span class="n">status</span>
<span class="o">&gt;&gt;</span><span class="n">DS</span>   <span class="n">csrw</span><span class="p">:</span> <span class="n">Control</span> <span class="ow">is</span> <span class="mi">004000</span> <span class="p">(</span><span class="n">Write</span><span class="p">)</span>
<span class="o">&gt;&gt;</span><span class="n">DS</span>  <span class="n">state</span><span class="p">:</span> <span class="n">Unit</span> <span class="mi">0</span> <span class="n">Write</span> <span class="n">data</span> <span class="n">phase</span> <span class="n">entered</span> <span class="kn">from</span> <span class="nn">service</span>
<span class="o">&gt;&gt;</span><span class="n">DS</span>   <span class="n">serv</span><span class="p">:</span> <span class="n">Unit</span> <span class="mi">0</span> <span class="n">Write</span> <span class="n">data</span> <span class="n">phase</span> <span class="n">delay</span> <span class="mi">1</span> <span class="n">service</span> <span class="n">scheduled</span>
<span class="o">&gt;&gt;</span><span class="n">DS</span>   <span class="n">xfer</span><span class="p">:</span> <span class="n">Unit</span> <span class="mi">0</span> <span class="n">Write</span> <span class="n">word</span> <span class="mi">3400</span> <span class="ow">is</span> <span class="mi">177777</span>
<span class="o">&gt;&gt;</span><span class="n">DS</span>  <span class="n">iobus</span><span class="p">:</span> <span class="n">Received</span> <span class="n">data</span> <span class="mi">005000</span> <span class="k">with</span> <span class="n">signals</span> <span class="n">PCONTSTB</span>
<span class="o">&gt;&gt;</span><span class="n">DS</span>  <span class="n">iobus</span><span class="p">:</span> <span class="n">Controller</span> <span class="p">(</span><span class="n">idle</span><span class="p">)</span> <span class="n">received</span> <span class="n">data</span> <span class="mi">005000</span> <span class="k">with</span> <span class="n">flags</span> <span class="n">CMRDY</span> <span class="o">|</span> <span class="n">EOD</span>
</pre></div>
</div>
<p>The Disc Interface state contains these registers:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Radix</p></th>
<th class="head"><p>Read-only</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SIOBSY</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>SIO is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DEVSR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Device service request is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INXFR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Input transfer is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>OUTXFR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Output transfer is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INTMSK</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Interrupt mask is enabled</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>JMPMET</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Jump condition is met</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVEND</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Device end is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DATOVR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Data overrun has occurred</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ENDDAT</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>End of data has occurred</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>TEST</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Test mode is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>WAIT</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Data wait is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>CLEAR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>A hardware clear is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CMRDY</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>A command word is ready</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DTRDY</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>A data word is ready</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>EOD</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>The last data word has been transferred</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INTOK</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>An interrupt is allowed</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>OVRUN</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>The current transfer has overrun</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>XFRNG</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>The current transfer is no good</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>BUFFER</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Data buffer register</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>STATUS</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Status register</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>RETRY</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Retry counter</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>OPCODE</b></samp></span></p></td>
<td><p>5</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td><p>Controller operation code</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CSTATS</b></samp></span></p></td>
<td><p>5</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td><p>Controller status</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>CSTATE</b></samp></span></p></td>
<td><p>2</p></td>
<td><p>10</p></td>
<td><p>✓</p></td>
<td><p>Controller state</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>EOC</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>End of cylinder has been seen</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>VERIFY</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Address verification is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SPDU</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Spare/protected/defective flags and unit number</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>FLMASK</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>8</p></td>
<td></td>
<td><p>File mask</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CYL</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Controller cylinder</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>HEAD</b></samp></span></p></td>
<td><p>6</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Controller head</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SECTOR</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Controller sector</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>COUNT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Word or sector counter</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SECBUF [0:137]</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Sector data buffer</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INDEX</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Sector buffer current index</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>LENGTH</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Sector buffer valid length</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>TTIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast one-track seek time</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>FTIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast full-stroke seek time</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>STIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast one-sector rotation time</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>XTIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast one-word transfer time</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>GTIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast intersector gap rotation time</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>OTIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast controller overhead time</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>UCYL [0:8]</b></samp></span></p></td>
<td><p>10</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Current cylinder, drives 0–7 and controller</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UOPCODE [0:8]</b></samp></span></p></td>
<td><p>6</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td><p>Current operation code, drives 0–7 and controller</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>USTATUS [0:8]</b></samp></span></p></td>
<td><p>32</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Unit status, drives 0–7 and controller</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>USTATE [0:8]</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>10</p></td>
<td><p>✓</p></td>
<td><p>Current command state, drives 0–7 and controller</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>UPOS [0:8]</b></samp></span></p></td>
<td><p>32</p></td>
<td><p>10</p></td>
<td><p>✓</p></td>
<td><p>Current byte position, drives 0–7 and controller</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UWAIT [0:8]</b></samp></span></p></td>
<td><p>32</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Scheduled wait delay, drives 0–7 and controller</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp>BUFFER</samp></span> and <span class="html"><samp>SECBUF</samp></span> registers may be examined or deposited using any of the modes described in the <a class="reference internal" href="#symbolic-display-and-entry">Symbolic display and entry</a> section above.</p>
</section>
</section>
</section>
<section id="multiplexer-channel-i-o-device-simulations">
<h2><span class="sectnum">1.6. </span>Multiplexer channel I/O device simulations<a class="headerlink" href="#multiplexer-channel-i-o-device-simulations" title="Permalink to this heading">¶</a></h2>
<p>The multiplexer channel controls these I/O device interfaces:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#a-line-printer-controller">30209A line printer controller</a></p></li>
<li><p><a class="reference internal" href="#a-tape-controller">30215A tape controller</a></p></li>
</ul>
<section id="a-line-printer-controller-with-one-2607-13-17-18-line-printer">
<span id="a-line-printer-controller"></span><span id="lp"></span><h3><span class="sectnum">1.6.1. </span>30209A line printer controller with one 2607/13/17/18 line printer<a class="headerlink" href="#a-line-printer-controller-with-one-2607-13-17-18-line-printer" title="Permalink to this heading">¶</a></h3>
<p>The HP 30118A, 30127A, 30128A, and 30133A line printer subsystems connect the 2607A, 2613A, 2618A, and 2617A printers,
respectively
to the HP 3000.
Each subsystem consists of a 30209A line printer controller,
employing a 30051A universal interface (differential) and an interconnecting cable,
and an HP 2607A (200 lines per minute),
HP 2613 (300 lpm),
HP 2617 (600 lpm),
or HP 2618 (1250 lpm) line printer.
These subsystems employ the multiplexer channel to achieve a 360 KB/second transfer rate from the CPU.</p>
<p>The simulation provides one printer unit.
The 2617 is selected by default.
Attaching a text file to the unit simulates loading paper into the printer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ATTACH</span> <span class="p">{</span><span class="o">-</span><span class="n">N</span><span class="p">}</span> <span class="n">LP</span> <span class="o">&lt;</span><span class="n">image</span><span class="o">-</span><span class="n">filename</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Adding the <code class="docutils literal notranslate"><span class="pre">-N</span></code> (new file) switch clears the contents of the image file if present.
Without the <code class="docutils literal notranslate"><span class="pre">-N</span></code> switch,
printer output will be appended to any preexisting image file content.</p>
<p>Printer output written to the image file is typically buffered by the host operating system’s underlying stream I/O routines.
While it is running,
the simulator flushes the file after each printer top-of-form request to permit convenient inspection of the image file.
Stopping the simulator also flushes the file.</p>
<p>If the host operating system returns an error when writing to the printer image file,
the simulator will report the error to the simulation console, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HP</span> <span class="mi">3000</span> <span class="n">simulator</span> <span class="n">printer</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">error</span><span class="p">:</span> <span class="n">No</span> <span class="n">space</span> <span class="n">left</span> <span class="n">on</span> <span class="n">device</span>
</pre></div>
</div>
<p>The printer goes offline with an alarm condition,
and the simulator stops.
Simulation may then be resumed,
either with the printer set back online if the problem is fixed,
or with the printer remaining offline if the problem is uncorrectable.</p>
<p>Detaching the text file from the unit with the <span class="html"><samp><b>DETACH LP</b></samp></span> command simulates running out of paper.
If the command is entered while there are characters in the print buffer or,
for the 2607 only,
the print location is not at the top of the form,
<strong>Command not completed</strong> is displayed on the simulation console,
and the file remains attached until the required conditions are true.
Once simulation is resumed and the print operations complete,
the printer is set offline and detached automatically.</p>
<p>Detaching may also be forced with the <span class="html"><samp><b>DETACH -F LP</b></samp></span> command.
This simulates physically removing the paper and takes effect immediately,
regardless of any printing operations in progress.</p>
<p>Device and unit options include configuring the printer type and timing,
output format,
vertical format unit (VFU),
and the ability to set the printer offline or online.
The command forms are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SET</span> <span class="n">LP</span> <span class="o">&lt;</span><span class="n">device</span><span class="o">-</span><span class="n">option</span><span class="o">&gt;</span>
<span class="n">SET</span> <span class="n">LP</span> <span class="o">&lt;</span><span class="n">unit</span><span class="o">-</span><span class="n">option</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id1">
<h4><span class="sectnum">1.6.1.1. </span>Device options<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h4>
<p>Device options that may be specified are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>FASTTIME</b></samp></span></p></td>
<td><p>Use optimized timing; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>REALTIME</b></samp></span></p></td>
<td><p>Use realistic timing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>PRINTER</b></samp></span></p></td>
<td><p>Connect using the printer interface cable; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DIAGNOSTIC</b></samp></span></p></td>
<td><p>Connect using the Diagnostic Hardware Assembly</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVNO=</b><var>n</var></samp></span></p></td>
<td><p>Set the device number; default is 14</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INTMASK=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt mask; default is E</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INTPRI=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt priority; default is 18</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SRNO=</b><var>n</var></samp></span></p></td>
<td><p>Set the service request number; default is 11</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEBUG=</b><var>option</var></samp></span></p></td>
<td><p>Enable tracing</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NODEBUG</b></samp></span></p></td>
<td><p>Disable tracing; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ENABLED</b></samp></span></p></td>
<td><p>Enable the device; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DISABLED</b></samp></span></p></td>
<td><p>Disable the device</p></td>
</tr>
</tbody>
</table>
<p>The printer supports realistic and optimized timing modes.
Realistic timing attempts to model the print buffer load and print-and-space operation delays inherent in the physical hardware.
For example,
output of lines with more characters takes longer than output of lines with fewer characters,
and spacing six lines takes approximately six times longer than spacing one line.</p>
<p>Optimized timing reduces operation delays to the minimums necessary to operate correctly;
this is much faster than a real line printer would operate.</p>
<p>The delays used by the simulation in <a class="reference internal" href="#fasttime"><span class="html"><samp>FASTTIME</samp></span></a> mode may be set via the register interface.
The values may be adjusted as necessary to work around any HP 3000 software problems that are triggered by the unusually rapid print operations.
Resetting the device with the <span class="html"><samp><b>RESET -P</b></samp></span> (power-on reset) command restores the original optimized times.</p>
<p>The <span class="html"><samp><b>DIAGNOSTIC</b></samp></span> option simulates the installation of the HP 30049C diagnostic hardware assembly in place of the printer interface cable.
This is needed to run the offline universal interface diagnostic (program D435A).
The <span class="html"><samp class="register">CNLED</samp></span> register provides the state of the <em>CONT 6</em> through <em>CONT 10</em> LEDs,
and the <span class="html"><samp class="register">J2WX</samp></span>,
<span class="html"><samp class="register">DATOUT</samp></span>,
<span class="html"><samp class="register">DCOUT</samp></span>,
<span class="html"><samp class="register">DFIN</samp></span>,
and <span class="html"><samp class="register">DENDIN</samp></span> registers provide the logic levels of the corresponding test pins on the DHA.</p>
<p>Setting the <span class="html"><samp><b>PRINTER</b></samp></span> option reconnects the cable between the line printer and the interface.</p>
<p>Device configuration may be displayed with the following commands:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW LP</b></samp></span></p></td>
<td><p>Display the device and unit configuration</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW LP MODES</b></samp></span></p></td>
<td><p>Display the timing and connection modes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id2">
<h4><span class="sectnum">1.6.1.2. </span>Unit options<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h4>
<p>Unit options that may be specified are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>2607</b></samp></span></p></td>
<td><p>Set the printer model to 2607</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>2613</b></samp></span></p></td>
<td><p>Set the printer model to 2613</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>2617</b></samp></span></p></td>
<td><p>Set the printer model to 2617; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>2618</b></samp></span></p></td>
<td><p>Set the printer model to 2618</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>VFU</b></samp></span></p></td>
<td><p>Install the HP standard 66-line VFU tape; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>VFU=</b><var>filename</var></samp></span></p></td>
<td><p>Install a custom VFU tape image</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>OFFLINE</b></samp></span></p></td>
<td><p>Set the printer offline; default when detached</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ONLINE</b></samp></span></p></td>
<td><p>Set the printer online; default when attached</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>EXPAND</b></samp></span></p></td>
<td><p>Write expanded output to the printer image file; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>COMPACT</b></samp></span></p></td>
<td><p>Write compact output to the printer image file</p></td>
</tr>
</tbody>
</table>
<p id="id6"><span id="id5"></span><span id="id4"></span><span id="id3"></span>The <span class="html"><samp><b>2607</b></samp></span>, <span class="html"><samp><b>2613</b></samp></span>, <span class="html"><samp><b>2617</b></samp></span>, and <span class="html"><samp><b>2618</b></samp></span> options select the printer model.
Each printer is configured with Option 001,
which provides a 128-character set for the HP 2607 and 96-character sets for the HP 2613, 2617, and 2618.
The 2607 and 2618 support 132-character print line lengths,
while the 2613 and 2617 support 136-character lines.
Exceeding the line length on the 2607 causes an automatic print-and-space operation.
Exceeding the line length on the 2613, 2617, or 2618 discards the excess characters.</p>
<p id="vfu">The <span class="html"><samp><b>VFU</b></samp></span> option configures the printer’s vertical format unit,
as described in the <a class="reference internal" href="#vertical-format-unit">Vertical format unit</a> section below.</p>
<p id="online"><span id="offline"></span>The <span class="html"><samp><b>OFFLINE</b></samp></span> and <span class="html"><samp><b>ONLINE</b></samp></span> options place the printer offline and online,
respectively.
The former provides a convenient method of setting the printer “down” without detaching the associated output file.</p>
<p>The printer will not go offline if there are characters in the print buffer.
Instead, the offline condition is held off until the line is printed and paper movement is complete.
The <span class="html"><samp><b>SET LP OFFLINE</b></samp></span> command checks for data in the print buffer or a print operation in progress.
If either condition is true,
the action is deferred,
and <em>Command not completed</em> is displayed on the simulation console.
A <span class="html"><samp><b>SHOW LP</b></samp></span> command will show that the device is still online.
Once simulation is resumed and the print operation completes,
the printer is set offline.
No console message reports this,
although a subsequent <span class="html"><samp><b>SHOW LP</b></samp></span> command will indicate the new status.</p>
<p>Entering a <span class="html"><samp><b>SET LP ONLINE</b></samp></span> command while an offline or detach action is deferred will cancel the action without triggering any programmed online-to-offline or offline-to-online status transition interrupt.
A :html:<span class="html"><samp><b>RESET LP</b></samp></span> command also cancels any deferred offline or detach action.
Additionally,
it clears the print buffer and terminates any print action in progress,
so a <span class="html"><samp><b>SET LP OFFLINE</b></samp></span> or <span class="html"><samp><b>DETACH LP</b></samp></span> will succeed if issued afterward.</p>
<p>The <span class="html"><samp><b>EXPAND</b></samp></span> and <span class="html"><samp><b>COMPACT</b></samp></span> options control the format of lines written to the printer image file.
In compact mode,
a carriage-return/line-feed character pair terminates a printed line,
but subsequent line spacing is performed by line-feed characters alone.
A top-of-form request will emit a form-feed character instead of the number of line-feeds required to reach the top of the next form.
This mode is suitable for sending the printer output to a physical printer connected to the host.</p>
<p>In expanded mode,
paper advance is handled by emitting the correct number of carriage-return/line-feed pairs.
This mode is suitable for retaining printer output as a text file.</p>
<p>The HP 2613, 2617, and 2618 printers are capable of overprinting.
If the printer is sent a format code to suppress spacing,
the characters in the buffer are printed and the buffer is emptied,
but the paper is not advanced.
The next print operation will print its characters over those already present on the paper.
In simulation,
overprinting is performed in one of two ways,
depending on the print mode.</p>
<p>In compact mode,
overprinting is simulated by emitting a carriage-return character at the end of the line.
In expanded mode,
overprinting is simulated by merging characters in the buffer before writing them as a single line in the printer image file.
As the second and subsequent lines are output,
each new character is compared with its corresponding character in the buffer.
If the character in the buffer is a space,
the new character replaces it.
If the new character is a space or is the same as the character in the buffer,
the character in the buffer is retained.
Otherwise,
the character in the buffer is replaced with a special character representing an overprinted combination.
This character defaults to <code class="docutils literal notranslate"><span class="pre">DEL</span></code> (octal 177) but may be changed by altering the <span class="html"><samp class="register">OVPCHR</samp></span> register value.</p>
<p>The HP 2607 printer cannot overprint.
A request to suppress spacing will result in a single-line paper advance after printing.</p>
</section>
<section id="vertical-format-unit">
<h4><span class="sectnum">1.6.1.3. </span>Vertical format unit<a class="headerlink" href="#vertical-format-unit" title="Permalink to this heading">¶</a></h4>
<p>The HP 2607 supports an 8-channel vertical format unit (VFU),
and the HP 2613, 2617, and 2618 printers support 12-channel VFUs.
A continuous punched paper tape that controls paper spacing is installed in the VFU reader.
The printer may be commanded to advance the paper until a punched hole is detected in a specified VFU channel.
The length of the tape establishes the length of the forms loaded into the printer.</p>
<p>Initially, the standard VFU tape
(part number 1535-2655 for the HP 2607 or 02613-80001 for the HP 2613, 2617, and 2618)
is installed.
This tape associates channels 1-8 with the following printer actions:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Channel</p></th>
<th class="head"><p>Printer advances to</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>1</strong></p></td>
<td><p>Top of form</p></td>
</tr>
<tr class="row-odd"><td><p><strong>2</strong></p></td>
<td><p>Bottom of form</p></td>
</tr>
<tr class="row-even"><td><p><strong>3</strong></p></td>
<td><p>Next single space</p></td>
</tr>
<tr class="row-odd"><td><p><strong>4</strong></p></td>
<td><p>Next double space</p></td>
</tr>
<tr class="row-even"><td><p><strong>5</strong></p></td>
<td><p>Next triple space</p></td>
</tr>
<tr class="row-odd"><td><p><strong>6</strong></p></td>
<td><p>Next half-page</p></td>
</tr>
<tr class="row-even"><td><p><strong>7</strong></p></td>
<td><p>Next quarter-page</p></td>
</tr>
<tr class="row-odd"><td><p><strong>8</strong></p></td>
<td><p>Next sixth-page</p></td>
</tr>
</tbody>
</table>
<p>For the 02613-80001 tape,
channel 9 is punched the same as channel 2,
and channels 10-12 are uncommitted.</p>
<p>The simulator supports the use of custom VFU tape images.
A custom tape may be installed in place of the standard tape by issuing the <span class="html"><samp><b>SET LP VFU=</b><var>filename</var></samp></span> command.
Custom tapes must reserve channel 1 for the top-of-form location,
but the other channels may be defined as desired.</p>
<p>A custom tape image is a plain-text file that starts with a VFU definition line and then contains one channel-definition line for each line of the form.
The number of channel-definition lines establishes the form length.</p>
<p>A semicolon appearing anywhere on a line begins a comment,
and the semicolon and all following characters are ignored.
Zero-length lines,
including lines beginning with a semicolon,
are ignored.
Note that a line containing one or more blanks is not a zero-length line,
so, for example,
the line <em>” ; a comment starting in column 2”</em> is not ignored.</p>
<p>The first (non-ignored) line in the file must be a VFU definition line of this exact form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VFU</span><span class="o">=&lt;</span><span class="n">punch</span> <span class="n">characters</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">no</span><span class="o">-</span><span class="n">punch</span> <span class="n">character</span><span class="o">&gt;</span><span class="p">{,</span><span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>… where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">punch</span> <span class="pre">characters</span></code> is a set of one or more characters used interchangeably to represent a punched location.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">no-punch</span> <span class="pre">character</span></code> is a single character representing a non-punched location.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">title</span></code> is an optional description that is printed by the <span class="html"><samp><b>SHOW LP VFU</b></samp></span> command;
the description “Custom VFU” is used if the title is omitted.</p></li>
</ul>
<p>If the <span class="html"><samp><b>VFU</b></samp></span> line is missing or not of the correct form,
then <strong>Format error</strong> is displayed on the simulation console,
and the VFU tape is not changed.</p>
<p>The remaining lines define the channels punched for each line of the printed form.
The line format consists of a sequence of punch, no-punch, and “other” characters,
in channel order.
Each punch or no-punch character defines a channel state,
starting with channel 1 and proceeding left-to-right until all channels for the VFU are defined;
any the extra channel states on the line are ignored.
If the line terminates before all channels are defined,
the remaining channels are set to the no-punch state.
Any “other” characters,
i.e., neither punch characters nor no-punch characters,
are ignored and may be used freely to delineate the tape channels.</p>
<p>For a standard 66-line form,
the first printable line (form line 1) is paper line 4,
and the last printable line (form line 60) is paper line 63.
The first channel-definition line in the file specifies form line 1,
i.e., the top of the form,
and must have a punch in channel 1.
Channel line 60 defines form line 60,
i.e., the bottom of the form.
Six more channel lines follow:
three for the bottom margin,
and three for the top margin of the next form.</p>
<p>An example custom VFU file using a 66-line tape definition for an 8-channel VFU is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">;</span> <span class="n">the</span> <span class="n">VFU</span> <span class="n">definition</span>
<span class="p">;</span>
<span class="p">;</span> <span class="n">the</span> <span class="nb">set</span> <span class="n">of</span> <span class="n">punch</span> <span class="n">characters</span> <span class="ow">is</span> <span class="s2">&quot;1&quot;</span> <span class="ow">and</span> <span class="s2">&quot;X&quot;</span>
<span class="p">;</span> <span class="n">the</span> <span class="n">no</span><span class="o">-</span><span class="n">punch</span> <span class="n">character</span> <span class="ow">is</span> <span class="s2">&quot;0&quot;</span>
<span class="p">;</span> <span class="nb">all</span> <span class="n">other</span> <span class="n">characters</span> <span class="n">are</span> <span class="n">ignored</span>

<span class="n">VFU</span><span class="o">=</span><span class="mi">1</span><span class="n">X</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">A</span> <span class="n">binary</span> <span class="n">tape</span> <span class="n">image</span>

<span class="p">;</span> <span class="n">the</span> <span class="n">channel</span> <span class="n">definitions</span>

<span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>   <span class="p">;</span> <span class="n">top</span> <span class="n">of</span> <span class="n">form</span> <span class="p">(</span><span class="n">line</span> <span class="mi">1</span><span class="p">;</span> <span class="n">must</span> <span class="n">have</span> <span class="n">a</span> <span class="n">punch</span> <span class="ow">in</span> <span class="n">channel</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">0</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="n">X</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">0</span>   <span class="p">;</span> <span class="n">single</span> <span class="n">space</span> <span class="p">(</span><span class="n">line</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">0011</span>              <span class="p">;</span> <span class="n">channels</span> <span class="mi">5</span><span class="o">-</span><span class="mi">8</span> <span class="n">default</span> <span class="n">to</span> <span class="n">no</span><span class="o">-</span><span class="n">punch</span> <span class="p">(</span><span class="n">line</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>   <span class="p">;</span> <span class="n">bottom</span> <span class="n">of</span> <span class="n">form</span> <span class="p">(</span><span class="n">line</span> <span class="mi">60</span><span class="p">)</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>   <span class="p">;</span> <span class="n">bottom</span> <span class="n">form</span> <span class="n">margin</span> <span class="p">(</span><span class="n">line</span> <span class="mi">61</span><span class="p">)</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>   <span class="p">;</span> <span class="n">bottom</span> <span class="n">form</span> <span class="n">margin</span> <span class="p">(</span><span class="n">line</span> <span class="mi">62</span><span class="p">)</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>   <span class="p">;</span> <span class="n">bottom</span> <span class="n">form</span> <span class="n">margin</span> <span class="p">(</span><span class="n">line</span> <span class="mi">63</span><span class="p">)</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>   <span class="p">;</span> <span class="n">top</span> <span class="n">of</span> <span class="n">form</span> <span class="n">margin</span> <span class="p">(</span><span class="n">line</span> <span class="mi">64</span><span class="p">)</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>   <span class="p">;</span> <span class="n">top</span> <span class="n">of</span> <span class="n">form</span> <span class="n">margin</span> <span class="p">(</span><span class="n">line</span> <span class="mi">65</span><span class="p">)</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>   <span class="p">;</span> <span class="n">top</span> <span class="n">of</span> <span class="n">form</span> <span class="n">margin</span> <span class="p">(</span><span class="n">line</span> <span class="mi">66</span><span class="p">)</span>
</pre></div>
</div>
<p>If a custom tape has been used,
the standard tape may be reinstalled by issuing the <span class="html"><samp><b>SET LP VFU</b></samp></span> command.</p>
<p>Attempting to command an advance to a channel that is not punched will cause a tape fault,
and the printer will go offline.
Setting the printer back online will clear the fault.</p>
<p>The current VFU definition may be displayed with the following command:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW LP VFU</b></samp></span></p></td>
<td><p>Display the currently loaded VFU tape definition</p></td>
</tr>
</tbody>
</table>
<p>This command displays the current VFU tape title and then the channel definitions for each form line.
By default,
a punched channel is indicated by an <code class="docutils literal notranslate"><span class="pre">O</span></code> character,
and an unpunched channel is indicated by a period (<code class="docutils literal notranslate"><span class="pre">.</span></code>).
These characters may be changed by depositing new values into the <span class="html"><samp class="register">PUNCHR</samp></span> and <span class="html"><samp class="register">UNPCHR</samp></span> registers,
respectively.</p>
</section>
<section id="id7">
<h4><span class="sectnum">1.6.1.4. </span>Tracing and registers<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h4>
<p>When debug output logging is enabled,
tracing may be configured by specifying one or more of the reporting level options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Reporting level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CMD</b></samp></span></p></td>
<td><p>Printer commands executed</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>CSRW</b></samp></span></p></td>
<td><p>Interface control, status, read, and write actions</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SERV</b></samp></span></p></td>
<td><p>Printer, pulse, and transfer timer unit service events</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>XFER</b></samp></span></p></td>
<td><p>Data transmissions</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>STATE</b></samp></span></p></td>
<td><p>Device handshake state changes executed</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>IOBUS</b></samp></span></p></td>
<td><p>I/O bus signals and data words received and returned</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>CMD</b></samp></span> option traces the commands executed by the printer.
The <span class="html"><samp><b>CSRW</b></samp></span> option traces control, status, read, and write commands sent to the interface.
The <span class="html"><samp><b>SERV</b></samp></span> option traces printer and interface unit event service entries.
The <span class="html"><samp><b>XFER</b></samp></span> option traces the data words and format commands written to the printer.
The <span class="html"><samp><b>STATE</b></samp></span> option traces the scheduling of and entries into each of the internal device handshake execution states.
The <span class="html"><samp><b>IOBUS</b></samp></span> option traces the signals and data received and returned via the I/O backplane.</p>
<p>Examples of the trace formats follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="n">LP</span>   <span class="n">cmd</span><span class="p">:</span> <span class="n">Printed</span> <span class="mi">132</span> <span class="n">characters</span> <span class="n">on</span> <span class="n">line</span> <span class="mi">8</span>
<span class="o">&gt;&gt;</span><span class="n">LP</span>   <span class="n">cmd</span><span class="p">:</span> <span class="n">Printer</span> <span class="n">commanded</span> <span class="n">to</span> <span class="n">slew</span> <span class="n">to</span> <span class="n">VFU</span> <span class="n">channel</span> <span class="mi">1</span> <span class="kn">from</span> <span class="nn">line</span> <span class="mi">9</span>
<span class="o">&gt;&gt;</span><span class="n">LP</span>   <span class="n">cmd</span><span class="p">:</span> <span class="n">Printer</span> <span class="n">advanced</span> <span class="mi">58</span> <span class="n">lines</span> <span class="n">to</span> <span class="n">line</span> <span class="mi">1</span>
<span class="o">&gt;&gt;</span><span class="n">LP</span>  <span class="n">csrw</span><span class="p">:</span> <span class="n">Control</span> <span class="ow">is</span> <span class="n">character</span> <span class="o">|</span> <span class="n">interrupt</span> <span class="n">status</span> <span class="o">|</span> <span class="n">word</span> <span class="n">xfer</span>
<span class="o">&gt;&gt;</span><span class="n">LP</span>  <span class="n">csrw</span><span class="p">:</span> <span class="n">Status</span> <span class="ow">is</span> <span class="n">DIO</span> <span class="n">OK</span> <span class="o">|</span> <span class="n">interrupt</span> <span class="o">|</span> <span class="n">interrupt</span> <span class="n">status</span> <span class="o">|</span> <span class="n">system</span>
<span class="o">&gt;&gt;</span><span class="n">LP</span>  <span class="n">serv</span><span class="p">:</span> <span class="n">Transfer</span> <span class="n">delay</span> <span class="mi">1491</span> <span class="n">service</span> <span class="n">scheduled</span>
<span class="o">&gt;&gt;</span><span class="n">LP</span>  <span class="n">serv</span><span class="p">:</span> <span class="n">Device</span> <span class="n">Command</span> <span class="mi">1</span> <span class="n">state</span> <span class="n">printer</span> <span class="n">service</span> <span class="n">entered</span>
<span class="o">&gt;&gt;</span><span class="n">LP</span>  <span class="n">xfer</span><span class="p">:</span> <span class="n">Character</span> <span class="s1">&#39;M&#39;</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">printer</span>
<span class="o">&gt;&gt;</span><span class="n">LP</span>  <span class="n">xfer</span><span class="p">:</span> <span class="n">Format</span> <span class="n">code</span> <span class="mi">001</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">printer</span>
<span class="o">&gt;&gt;</span><span class="n">LP</span> <span class="n">state</span><span class="p">:</span> <span class="n">Sequencer</span> <span class="n">transitioned</span> <span class="kn">from</span> <span class="nn">Idle</span> <span class="n">state</span> <span class="n">to</span> <span class="n">Device</span> <span class="n">Flag</span> <span class="mi">1</span> <span class="n">state</span>
<span class="o">&gt;&gt;</span><span class="n">LP</span> <span class="n">iobus</span><span class="p">:</span> <span class="n">Received</span> <span class="n">data</span> <span class="mi">046515</span> <span class="k">with</span> <span class="n">signals</span> <span class="n">ACKSR</span> <span class="o">|</span> <span class="n">PWRITESTB</span> <span class="o">|</span> <span class="n">CHANSO</span>
<span class="o">&gt;&gt;</span><span class="n">LP</span> <span class="n">iobus</span><span class="p">:</span> <span class="n">Returned</span> <span class="n">data</span> <span class="mi">060004</span> <span class="k">with</span> <span class="n">signals</span> <span class="n">INTREQ</span> <span class="o">|</span> <span class="n">JMPMET</span>
</pre></div>
</div>
<p>The Line Printer Controller state contains these registers:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Radix</p></th>
<th class="head"><p>Symbolic</p></th>
<th class="head"><p>Read-only</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SIOBSY</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>SIO is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>CHANSR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Channel service request is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVSR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Device service request is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INXFR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Input transfer is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>OUTXFR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Output transfer is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>RDXFR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Read transfer is in progress</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>WRXFR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Write transfer is in progress</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INTMSK</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Interrupt mask is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVCMD</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Device command</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DEVFLG</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Device flag</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVEND</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Device end is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SEQSTA</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>10</p></td>
<td></td>
<td></td>
<td><p>Sequencer state</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CNTL</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Control word</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ISTAT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Interrupt status</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DSTAT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>Device status</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>READ</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Read word</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>WRITE</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Write word</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>J2WX</b></samp></span></p></td>
<td><p>10</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Jumper J2W10-J2W1 configuration</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DATOUT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Data out word</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DATIN</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Data in word</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DCOUT</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Device command out</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DFIN</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Device flag in</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DENDIN</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Device end in</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DIAGCN</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td></td>
<td><p>DHA control word</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CNLED</b></samp></span></p></td>
<td><p>5</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Control bit LEDs CONT 6-CONT 10</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PFWARN</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Power-fail warning exists</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>PFAULT</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Paper fault exists</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>TFAULT</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Tape fault exists</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>OLPEND</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td></td>
<td><p>Offline transition is pending</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PRLINE</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>10</p></td>
<td></td>
<td></td>
<td><p>Current print line number</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>BUFIDX</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>10</p></td>
<td></td>
<td></td>
<td><p>Current print buffer index</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PRTBUF [0:423]</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Print buffer</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>OVPCHR</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Overprint character</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>FORMLN</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>10</p></td>
<td></td>
<td><p>✓</p></td>
<td><p>Form length in lines</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>VFU [0:144]</b></samp></span></p></td>
<td><p>12</p></td>
<td><p>2</p></td>
<td></td>
<td><p>✓</p></td>
<td><p>Vertical format unit channels</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>PUNCHR</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Punched channel character</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UNPCHR</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>Unpunched channel character</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>BTIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td></td>
<td><p>Fast printer buffer load delay time</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>PTIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td></td>
<td><p>Fast printing delay time</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>STIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td></td>
<td><p>Fast paper slew per-line delay time</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>POS</b></samp></span></p></td>
<td><p>32</p></td>
<td><p>10</p></td>
<td></td>
<td></td>
<td><p>Printer file current position</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp class="register">PRTBUF</samp></span>,
<span class="html"><samp class="register">OVPCHR</samp></span>,
<span class="html"><samp class="register">PUNCHR</samp></span>,
and <span class="html"><samp class="register">UNPCHR</samp></span> registers default to single-character format display and entry,
but may be overridden with numeric-format switches,
if desired.
The <span class="html"><samp class="register">READ</samp></span>,
<span class="html"><samp class="register">WRITE</samp></span>,
<span class="html"><samp class="register">DATOUT</samp></span>,
and <span class="html"><samp class="register">DATIN</samp></span> registers default to octal display,
but may be displayed in single-character format by specifying the <code class="docutils literal notranslate"><span class="pre">-A</span></code> switch.
Symbolic entry for these registers is also supported.</p>
<p>The <span class="html"><samp class="register">PFAULT</samp></span> and <span class="html"><samp class="register">TFAULT</samp></span> registers indicate a paper fault and a tape fault,
respectively,
when they contain the value 1.
Attaching the printer will clear a paper fault.
Setting the printer online will clear a tape fault.</p>
<p id="ovpchr">The character used to represent an overprinted position may be changed by depositing a new value into the <span class="html"><samp class="register">OVPCHR</samp></span> register.
For example,
the <span class="html"><samp><b>DEPOSIT LP OVPCHR @</b></samp></span> command will change the character from the default <code class="docutils literal notranslate"><span class="pre">DEL</span></code> (octal 177) to the commercial-at sign (octal 100).
Similarly,
the characters used to represent punched and unpunched VFU channels in the <span class="html"><samp><b>SHOW LP VFU</b></samp></span> display may be changed by depositing new values in the <span class="html"><samp class="register">PUNCHR</samp></span> and <span class="html"><samp class="register">UNPCHR</samp></span> registers,
respectively.</p>
<p>The <span class="html"><samp class="register">FORMLN</samp></span> register holds the current VFU form length,
and the VFU register array holds the content of the current VFU tape.
The register defaults to binary display,
with channel 1 in the most-significant bit and channel 8 or 12 in the least-significant bit,
depending on the VFU width.
Elements 1–<span class="html"><samp><var>n</var></samp></span> correspond to VFU form lines 1–<span class="html"><samp><var>n</var></samp></span>,
where a 1 value indicates a punch,
and a 0 value indicates a no-punch.
Element 0 is the logical OR of elements 1–<span class="html"><samp><var>n</var></samp></span>,
so a 1 value indicates that the channel is punched somewhere on the tape,
and a 0 value indicates that the channel is not punched.</p>
</section>
</section>
<section id="a-tape-controller-with-four-7970b-e-drives">
<span id="a-tape-controller"></span><span id="ms"></span><h3><span class="sectnum">1.6.2. </span>30215A tape controller with four 7970B/E drives<a class="headerlink" href="#a-tape-controller-with-four-7970b-e-drives" title="Permalink to this heading">¶</a></h3>
<p>The HP 30115A magnetic tape subsystem connects the 7970B/E ½-inch magnetic tape drives to the HP 3000.
The subsystem consists of a 30215A two-card tape controller processor and controller interface,
and from one to four HP 7970B 800-bpi NRZI or HP 7970E 1600-bpi PE drives.
The two drive types may be mixed on a single controller.
The subsystem uses the multiplexer channel to achieve a 36 KB/second (NRZI) or 72 KB/second (PE) transfer rate to the CPU.</p>
<p>The simulation provides up to four tape drives.
7970Es are selected by default.
Attaching a tape image file to a unit simulates mounting a tape reel on a drive:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ATTACH</span> <span class="p">{</span><span class="o">-</span><span class="n">R</span><span class="p">}</span> <span class="p">{</span><span class="o">-</span><span class="n">F</span><span class="p">}</span> <span class="n">MSn</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">format</span><span class="o">&gt;</span><span class="p">}</span> <span class="o">&lt;</span><span class="n">image</span><span class="o">-</span><span class="n">filename</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Adding the <code class="docutils literal notranslate"><span class="pre">-R</span></code> (read-only) switch is equivalent to mounting the tape without a write ring in place.
Adding the <code class="docutils literal notranslate"><span class="pre">-F</span></code> switch and a format identifier declares the tape image format to be used.
Supported formats are <code class="docutils literal notranslate"><span class="pre">SIMH</span></code>, <code class="docutils literal notranslate"><span class="pre">E11</span></code>, <code class="docutils literal notranslate"><span class="pre">TPC</span></code>, and <code class="docutils literal notranslate"><span class="pre">P7B</span></code>.
If the <code class="docutils literal notranslate"><span class="pre">-F</span></code> switch and a format identifier are not supplied,
then SIMH tape image format is used.
Note that erase gaps embedded in the tape image file are supported only in SIMH image format mode.</p>
<p>If the host operating system returns an error when reading or writing a tape image file,
the simulator will report the error to the simulation console, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HP</span> <span class="mi">3000</span> <span class="n">simulator</span> <span class="n">tape</span> <span class="n">library</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">error</span><span class="p">:</span> <span class="n">No</span> <span class="n">space</span> <span class="n">left</span> <span class="n">on</span> <span class="n">device</span>
</pre></div>
</div>
<p>If this or another tape library error occurs,
e.g., due to an illegal or damaged tape format,
the simulator stops with an appropriate error message.
Resuming the simulation will fail the tape operation with Tape Error status.
The target operating system will then react to this error as though a real drive had encountered a bad tape block (CRC or MTE).</p>
<p>A drive’s unit number is not set explicitly.
Instead, the drive unit number is derived from the simulation unit number.
For example,
unit MS0 responds to tape unit select number 0.
Pressing a different unit select button on a mounted drive is equivalent to detaching and reattaching the tape image file to the corresponding simulation unit.
Pressing the <span class="html"><samp class="guilabel">OFF</samp></span> button is equivalent to setting the drive offline.</p>
<p>Device and unit options include configuring the drive type and timing,
tape reel size,
tape image format,
and the ability to set drives offline or online.
The command forms are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SET</span> <span class="n">MS</span> <span class="o">&lt;</span><span class="n">device</span><span class="o">-</span><span class="n">option</span><span class="o">&gt;</span>
<span class="n">SET</span> <span class="n">MSn</span> <span class="o">&lt;</span><span class="n">unit</span><span class="o">-</span><span class="n">option</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id8">
<h4><span class="sectnum">1.6.2.1. </span>Device options<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h4>
<p>Device options that may be specified are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>FASTTIME</b></samp></span></p></td>
<td><p>Use optimized timing; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>REALTIME</b></samp></span></p></td>
<td><p>Use realistic timing</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVNO=</b><var>n</var></samp></span></p></td>
<td><p>Set the device number; default is 6</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INTMASK=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt mask; default is E</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INTPRI=</b><var>n</var></samp></span></p></td>
<td><p>Set the interrupt priority; default is 14</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SRNO=</b><var>n</var></samp></span></p></td>
<td><p>Set the service request number; default is 3</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEBUG=</b><var>option</var></samp></span></p></td>
<td><p>Enable tracing</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>NODEBUG</b></samp></span></p></td>
<td><p>Disable tracing; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ENABLED</b></samp></span></p></td>
<td><p>Enable the device; default</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DISABLED</b></samp></span></p></td>
<td><p>Disable the device</p></td>
</tr>
</tbody>
</table>
<p>When realistic timing is enabled,
the simulation accurately models the tape movement times
(in machine instructions).
For example,
rewinding takes longer if the tape is positioned farther from the load point.
Realistic timing is necessary to pass the magnetic tape diagnostic timing tests.</p>
<p>Optimized timing reduces the timing to the minimum necessary to operate correctly;
this is much faster than a real tape drive would operate.
In addition,
enabling optimized timing also omits the initial erase gap normally written after the BOT marker.
This does not affect gaps written with the Write Gap command.</p>
<p>The delay times used by the simulation in <a class="reference internal" href="#fasttime"><span class="html"><samp>FASTTIME</samp></span></a> mode may be set via the register interface.
The values may be adjusted as necessary to work around any HP 3000 software problems that are triggered by the unusually rapid tape operation.
Resetting the device with the <span class="html"><samp><b>RESET -P</b></samp></span> (power-on reset) command restores the original optimized times.</p>
<p>Device configuration may be displayed with the following commands:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW MS</b></samp></span></p></td>
<td><p>Display the device and unit configuration</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW MS TIMING</b></samp></span></p></td>
<td><p>Display the timing mode</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id9">
<h4><span class="sectnum">1.6.2.2. </span>Unit options<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h4>
<p>Unit options that may be specified for individual tape drives are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>7970B</b></samp></span></p></td>
<td><p>Set the drive type to 7970B</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>7970E</b></samp></span></p></td>
<td><p>Set the drive type to 7970E; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>REEL=</b><var>n</var></samp></span></p></td>
<td><p>Set the reel size in feet; default is unlimited</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>CAPACITY=</b><var>n</var></samp></span></p></td>
<td><p>Set the reel capacity in megabytes; default is unlimited</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>OFFLINE</b></samp></span></p></td>
<td><p>Set the unit offline; default when detached</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ONLINE</b></samp></span></p></td>
<td><p>Set the unit online; default when attached</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>FORMAT=</b><var>fmt</var></samp></span></p></td>
<td><p>Set the tape image format; default is SIMH format</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ENABLED</b></samp></span></p></td>
<td><p>Enable the unit; default</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DISABLED</b></samp></span></p></td>
<td><p>Disable the unit</p></td>
</tr>
</tbody>
</table>
<p>The reel size may be set to 600-, 1200-, or 2400-foot capacity.
Setting the capacity or reel size to 0 specifies unlimited capacity;
in this configuration,
the controller never returns an end-of-tape indication.</p>
<p>The <span class="html"><samp><b>OFFLINE</b></samp></span> and <span class="html"><samp><b>ONLINE</b></samp></span> options place a drive offline and online,
respectively.
The former provides a convenient method of setting a drive “down” without detaching the associated tape image file.</p>
<p>The tape image format for future <span class="html"><samp><b>ATTACH</b></samp></span> commands may be set to one of the format identifiers listed previously.
The unit must be detached when the format is set.</p>
<p>Drive configuration may be displayed with the following commands:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW MS</b><var>n</var></samp></span></p></td>
<td><p>Display the selected drive’s configuration</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW MS</b><var>n</var> <b>REEL</b></samp></span></p></td>
<td><p>Display the selected drive’s reel size or capacity</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SHOW MS</b><var>n</var> <b>CAPACITY</b></samp></span></p></td>
<td><p>Display the selected drive’s reel size or capacity</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>SHOW MS</b><var>n</var> <b>FORMAT</b></samp></span></p></td>
<td><p>Display the selected drive’s tape image format</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id10">
<h4><span class="sectnum">1.6.2.3. </span><span class="html"><samp><b>BOOT</b></samp></span> command<a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h4>
<p>The interface supports the <span class="html"><samp><b>BOOT</b></samp></span> command as an alternative to <span class="html"><samp><b>LOAD</b></samp></span>.
The <span class="html"><samp><b>BOOT MS0</b></samp></span> command is equivalent in hardware to setting the <span class="html"><samp class="register">SWCH</samp></span> register to configure the control byte and device number,
and pressing the <span class="html"><samp class="guilabel">LOAD</samp></span> and <span class="html"><samp class="guilabel">ENABLE</samp></span> buttons to begin the cold load process for unit 0.
The <span class="html"><samp class="register">SWCH</samp></span> register is set as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>0</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
<th class="head"><p>9</p></th>
<th class="head"><p>10</p></th>
<th class="head"><p>11</p></th>
<th class="head"><p>12</p></th>
<th class="head"><p>13</p></th>
<th class="head"><p>14</p></th>
<th class="head"><p>15</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td colspan="8"><p>MS device number</p></td>
</tr>
</tbody>
</table>
<p>The control byte defaults to the Read Record tape command.</p>
</section>
<section id="id11">
<h4><span class="sectnum">1.6.2.4. </span>Tracing and registers<a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h4>
<p>When debug output logging is enabled,
tracing may be configured by specifying one or more of the reporting level options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Reporting level</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>CMD</b></samp></span></p></td>
<td><p>Controller commands executed</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INCO</b></samp></span></p></td>
<td><p>Controller command initiations and completions</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>CSRW</b></samp></span></p></td>
<td><p>Interface control, status, read, and write actions</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>STATE</b></samp></span></p></td>
<td><p>Controller command state changes executed</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>SERV</b></samp></span></p></td>
<td><p>Tape unit service events</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>XFER</b></samp></span></p></td>
<td><p>Data reads and writes</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>IOBUS</b></samp></span></p></td>
<td><p>I/O bus signals and data words received and returned</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp><b>CMD</b></samp></span> option traces the commands executed by the tape controller.
The <span class="html"><samp><b>INCO</b></samp></span> option traces the beginning and ending of commands,
including the starting and ending tape position.
The <span class="html"><samp><b>CSRW</b></samp></span> option traces control, status, read, and write commands sent to the interface.
The <span class="html"><samp><b>STATE</b></samp></span> option traces the scheduling of and entries into each of the internal controller execution states.
The <span class="html"><samp><b>SERV</b></samp></span> option traces tape unit event service entries.
The <span class="html"><samp><b>XFER</b></samp></span> option traces the data words read from or written to the tape.
The <span class="html"><samp><b>IOBUS</b></samp></span> option traces the signals and data received and returned via the I/O backplane and interface and via the data, flag, and function buses between the interface and controller.</p>
<p>Examples of the trace formats follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="n">MS</span>    <span class="n">cmd</span><span class="p">:</span> <span class="n">Unit</span> <span class="mi">0</span> <span class="n">Write</span> <span class="n">Record</span> <span class="n">of</span> <span class="mi">20</span><span class="o">-</span><span class="n">byte</span> <span class="n">record</span> <span class="n">succeeded</span>
<span class="o">&gt;&gt;</span><span class="n">MS</span>   <span class="n">inco</span><span class="p">:</span> <span class="n">Unit</span> <span class="mi">0</span> <span class="n">Write</span> <span class="n">Record</span> <span class="n">started</span> <span class="n">at</span> <span class="n">position</span> <span class="mi">6120</span>
<span class="o">&gt;&gt;</span><span class="n">MS</span>   <span class="n">csrw</span><span class="p">:</span> <span class="n">Control</span> <span class="ow">is</span> <span class="mi">000005</span> <span class="p">(</span><span class="n">Write</span> <span class="n">Gap</span><span class="p">)</span>
<span class="o">&gt;&gt;</span><span class="n">MS</span>   <span class="n">csrw</span><span class="p">:</span> <span class="n">Status</span> <span class="ow">is</span> <span class="n">ready</span> <span class="o">|</span> <span class="n">load</span> <span class="n">point</span> <span class="o">|</span> <span class="mi">1600</span> <span class="n">bpi</span> <span class="o">|</span> <span class="n">no</span> <span class="n">error</span> <span class="o">|</span> <span class="n">unit</span> <span class="mi">0</span>
<span class="o">&gt;&gt;</span><span class="n">MS</span>  <span class="n">state</span><span class="p">:</span> <span class="n">Unit</span> <span class="mi">0</span> <span class="n">Write</span> <span class="n">Gap</span> <span class="n">start</span> <span class="n">phase</span> <span class="n">delay</span> <span class="mi">3794</span> <span class="n">service</span> <span class="n">scheduled</span>
<span class="o">&gt;&gt;</span><span class="n">MS</span>   <span class="n">serv</span><span class="p">:</span> <span class="n">Unit</span> <span class="mi">0</span> <span class="n">service</span> <span class="n">entered</span>
<span class="o">&gt;&gt;</span><span class="n">MS</span>   <span class="n">xfer</span><span class="p">:</span> <span class="n">Unit</span> <span class="mi">0</span> <span class="n">Write</span> <span class="n">Record</span> <span class="n">word</span> <span class="mi">1</span> <span class="ow">is</span> <span class="mi">052525</span>
<span class="o">&gt;&gt;</span><span class="n">MS</span>  <span class="n">iobus</span><span class="p">:</span> <span class="n">Controller</span> <span class="p">(</span><span class="n">idle</span><span class="p">)</span> <span class="n">returned</span> <span class="n">data</span> <span class="mi">000000</span> <span class="k">with</span> <span class="n">functions</span> <span class="n">RQSRV</span>
<span class="o">&gt;&gt;</span><span class="n">MS</span>  <span class="n">iobus</span><span class="p">:</span> <span class="n">Received</span> <span class="n">data</span> <span class="mi">125252</span> <span class="k">with</span> <span class="n">signals</span> <span class="n">ACKSR</span> <span class="o">|</span> <span class="n">PWRITESTB</span> <span class="o">|</span> <span class="n">CHANSO</span>
</pre></div>
</div>
<p>The Tape Controller state contains these registers:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Radix</p></th>
<th class="head"><p>Read-only</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="html"><samp><b>SIOBSY</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>SIO is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>CHANSR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Channel service request is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DEVSR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Device service request is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INXFR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Input transfer is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>OUTXFR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Output transfer is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>INTMSK</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Interrupt mask is active</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UINTRP</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Unit interrupt is active</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>DEVEND</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>A device end has occurred</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>XFRERR</b></samp></span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td></td>
<td><p>A transfer error has occurred</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>BUFWRD</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Buffer word</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>ATUNIT</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Unit number requesting attention</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>CLASS</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Current command classification</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>FLAGS</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Interface state flags</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>CSTATE</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>10</p></td>
<td><p>✓</p></td>
<td><p>Controller execution state</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>STATUS</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td><p>✓</p></td>
<td><p>Controller status</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>USEL</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>10</p></td>
<td><p>✓</p></td>
<td><p>Unit number currently selected</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UATTN</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Bitmap of units requesting attention</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>RECBUF [0:65537]</b></samp></span></p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Record buffer</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>LIBSTA</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Status from last tape support library call</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>LENGTH</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Data buffer valid length</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INDEX</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Data buffer current index</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>GAPLEN</b></samp></span></p></td>
<td><p>32</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Length of erase gap preceding the current record</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>INPOS</b></samp></span></p></td>
<td><p>32</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Initial tape position</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>RSTART</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast rewind start time</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>RRATE</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast rewind rate</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>RSTOP</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast rewind stop time</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>BTIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast start time if positioned at the BOT</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>ITIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast start time if positioned at an inter-record gap</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>DTIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast data transfer time per byte</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>OTIME</b></samp></span></p></td>
<td><p>24</p></td>
<td><p>10</p></td>
<td></td>
<td><p>Fast controller overhead time</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UPROP [0:3]</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>8</p></td>
<td></td>
<td><p>Drive properties, drives 0-3</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>USTATUS [0:3]</b></samp></span></p></td>
<td><p>16</p></td>
<td><p>2</p></td>
<td></td>
<td><p>Unit status, drives 0-3</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UOPCODE [0:3]</b></samp></span></p></td>
<td><p>6</p></td>
<td><p>10</p></td>
<td><p>✓</p></td>
<td><p>Current operation code, drives 0-3</p></td>
</tr>
<tr class="row-odd"><td><p><span class="html"><samp><b>USTATE [0:3]</b></samp></span></p></td>
<td><p>4</p></td>
<td><p>10</p></td>
<td><p>✓</p></td>
<td><p>Current command state, drives 0-3</p></td>
</tr>
<tr class="row-even"><td><p><span class="html"><samp><b>UPOS [0:3]</b></samp></span></p></td>
<td><p>32</p></td>
<td><p>10</p></td>
<td><p>✓</p></td>
<td><p>Current byte position, drives 0-3</p></td>
</tr>
</tbody>
</table>
<p>The <span class="html"><samp class="register">BUFWRD</samp></span> and <span class="html"><samp class="register">RECBUF</samp></span> registers may be examined or deposited using any of the modes described in the <a class="reference internal" href="#symbolic-display-and-entry">Symbolic display and entry</a> section above.</p>
</section>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Python</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="simh_doc.html">SimH Users' Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="simh_swre.html">SimH Sample Software Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="simh_faq.html">SimH FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="nova_doc.html">Data General Nova</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdp1_doc.html">Digital Equipment Corporation PDP-1</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdp18b_doc.html">Digital Equipment Corporation PDP-4, PDP-7, PDP-9, PDP-15</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdp8_doc.html">Digital Equipment Corporation PDP-8</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdp10_doc.html">Digital Equipment Corporation PDP-10</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdp11_doc.html">Digital Equipment Corporation PDP-11</a></li>
<li class="toctree-l1"><a class="reference internal" href="vax780_doc.html">Digital Equipment Corporation VAX-11/780</a></li>
<li class="toctree-l1"><a class="reference internal" href="vax_doc.html">Digital Equipment Corporation MicroVAX 3900</a></li>
<li class="toctree-l1"><a class="reference internal" href="gri_doc.html">GRI Computer Corporation GRI-909</a></li>
<li class="toctree-l1"><a class="reference internal" href="i1401_doc.html">IBM 1401</a></li>
<li class="toctree-l1"><a class="reference internal" href="i1620_doc.html">IBM 1620</a></li>
<li class="toctree-l1"><a class="reference internal" href="i7094_doc.html">IBM 7094</a></li>
<li class="toctree-l1"><a class="reference internal" href="id_doc.html">Interdata (Perkin Elmer) 16b and 32b systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="h316_doc.html">Honeywell H316/H516</a></li>
<li class="toctree-l1"><a class="reference internal" href="lgp_doc.html">Royal-Mcbee LGP-30 (and LGP-21)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sds_doc.html">Scientific Data Systems SDS-940</a></li>
<li class="toctree-l1"><a class="reference internal" href="sigma_doc.html">Xerox Data Systems Sigma 32b systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="tx0_doc.html">TX-0 simulator usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="simh_breakpoints.html">The SIMH breakpoint subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="simh_magtape.html">SIMH magtape representation and handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="simh_vmio.html">Adding an I/O device to a SIMH virtual machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulators_acm_queue_2004.html">Simulators: virtual machines of the past and future</a></li>
<li class="toctree-l1"><a class="reference internal" href="Summary%20of%20IMP%20IO%20Device%20Codes.html">Summary of I/O commands for the Arpanet IMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="ssem_doc.html">SSEM simulator usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="swtp6800_doc.html">SWTP 6800 simulator usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="simh.html">Writing a simulator for the SIMH system</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/hp3000_doc.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>